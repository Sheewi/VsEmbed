{"version":3,"file":"index.js","mappings":";;;;;;;;;;AAAY;;AAEZ;AACA,gBAAgB,mBAAO,CAAC,kDAAS;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;;AAElB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,4BAA4B;;AAE5B,kBAAkB;AAClB,qBAAqB;;AAErB;AACA;AACA,2CAA2C,gBAAgB;AAC3D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2CAA2C,gBAAgB;AAC3D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC7Ua;;AAEb,kBAAkB,mBAAO,CAAC,2DAAiB;;AAE3C,kCAAkC,mBAAO,CAAC,qDAAc;AACxD,mBAAmB,mBAAO,CAAC,yEAAwB;AACnD,qBAAqB,mBAAO,CAAC,yDAAgB;AAC7C,mBAAmB,mBAAO,CAAC,qDAAc;;AAEzC;AACA;;AAEA;;;;;;;;;;;;ACZa;;AAEb,QAAQ,eAAe,EAAE,mBAAO,CAAC,uDAAa;;AAE9C;;AAEA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,kBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA,kBAAkB,YAAY;AAC9B;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,GAAG;AACd,YAAY,QAAQ;AACpB,YAAY;AACZ;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,mBAAO,CAAC,yIAAY;;AAE3C,IAAI,mBAAmB;AACvB;AACA;AACA;;AAEA,IAAI,qBAAqB;AACzB;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;;;;;;;;;;;AClIa;;AAEb;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACjBa;;AAEb,QAAQ,kCAAkC,EAAE,mBAAO,CAAC,uDAAa;;AAEjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA,mDAAmD,kBAAkB;AACrE,iDAAiD,kBAAkB;;AAEnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA;AACA,gCAAgC;AAChC;;AAEA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA,sDAAsD,kBAAkB;AACxE,wDAAwD,kBAAkB;AAC1E,0DAA0D,kBAAkB;;AAE5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB;AACA,aAAa,GAAG;AAChB,aAAa,QAAQ;AACrB;AACA,gCAAgC;AAChC;;AAEA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA,uDAAuD,kBAAkB;AACzE,yDAAyD,kBAAkB;;AAE3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB;AACA,aAAa,GAAG;AAChB;AACA,gCAAgC;AAChC;;AAEA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA,wDAAwD,kBAAkB;;AAE1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,mBAAmB;AAChC,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,WAAW,GAAG;AACd,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;;;;;;;;;;;ACnSa;;AAEb,QAAQ,aAAa,EAAE,mBAAO,CAAC,yDAAc;;AAE7C;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,yBAAyB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,mBAAmB;AAC5B;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,QAAQ,4BAA4B;AACpC;AACA,iEAAiE,EAAE;AACnE;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,QAAQ;AACR,+DAA+D,EAAE;AACjE;AACA,MAAM;AACN;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,iEAAiE,EAAE;AACnE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR,+DAA+D,EAAE;AACjE;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,EAAE;AACnE;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,UAAU;AACV;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV,iEAAiE,EAAE;AACnE;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,iEAAiE,EAAE;AACnE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR,+DAA+D,EAAE;AACjE;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,EAAE,GAAG,EAAE;AAC1D,2BAA2B;AAC3B,eAAe;AACf;AACA,qBAAqB;AACrB,SAAS;AACT;AACA,KAAK;AACL;AACA;;AAEA,mBAAmB;;;;;;;;;;;;AC1MN;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACtDa;;AAEb,aAAa,mBAAO,CAAC,kBAAM;;AAE3B,mBAAmB,mBAAO,CAAC,2DAAe;AAC1C,gBAAgB,mBAAO,CAAC,mDAAW;AACnC,QAAQ,cAAc,EAAE,mBAAO,CAAC,uDAAa;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,kBAAkB;AAC/B;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,IAAI;AAC5C;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,gDAAgD,IAAI,KAAK,MAAM;AAC/D;AACA;AACA;AACA,YAAY;AACZ;AACA,8CAA8C,IAAI,KAAK,MAAM;AAC7D;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,8CAA8C,IAAI,KAAK,MAAM;AAC7D;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,8CAA8C,IAAI,KAAK,MAAM;AAC7D;AACA;AACA,UAAU;AACV,gDAAgD,IAAI;AACpD;;AAEA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA,aAAa,iBAAiB;AAC9B,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA,kCAAkC,SAAS;AAC3C;AACA;AACA;;AAEA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,aAAa,iBAAiB;AAC9B,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,gCAAgC,SAAS;AACzC;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;AC/gBa;;AAEb,QAAQ,WAAW,EAAE,mBAAO,CAAC,sBAAQ;;AAErC,0BAA0B,mBAAO,CAAC,yEAAsB;AACxD;AACA;AACA;AACA;AACA;AACA,EAAE,EAAE,mBAAO,CAAC,uDAAa;AACzB,QAAQ,gCAAgC,EAAE,mBAAO,CAAC,2DAAe;AACjE,QAAQ,iCAAiC,EAAE,mBAAO,CAAC,yDAAc;;AAEjE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA;AACA,0BAA0B;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;;AAEN;AACA;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA,4BAA4B,aAAa;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oBAAoB;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,0BAA0B,aAAa;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,cAAc,8BAA8B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;AACA;AACA,mCAAmC,KAAK;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,aAAa,gCAAgC;AAC7C,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,cAAc,oBAAoB;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA,2CAA2C,QAAQ;AACnD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACjsBA,sCAAsC,gCAAgC;;AAEzD;;AAEb,QAAQ,SAAS,EAAE,mBAAO,CAAC,sBAAQ;AACnC,QAAQ,iBAAiB,EAAE,mBAAO,CAAC,sBAAQ;;AAE3C,0BAA0B,mBAAO,CAAC,yEAAsB;AACxD,QAAQ,iCAAiC,EAAE,mBAAO,CAAC,uDAAa;AAChE,QAAQ,4BAA4B,EAAE,mBAAO,CAAC,yDAAc;AAC5D,QAAQ,4BAA4B,EAAE,mBAAO,CAAC,2DAAe;;AAE7D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,iBAAiB;AAC9B,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,cAAc,mBAAmB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,iBAAiB;AAC9B,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,GAAG;AAChB,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,GAAG;AAChB,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,GAAG;AAChB,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,MAAM;AACnB,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA,aAAa,iBAAiB;AAC9B,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,qBAAqB;AAClC,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,UAAU;AACrB;AACA;AACA;AACA;;AAEA,kBAAkB,0BAA0B;AAC5C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,UAAU;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzlBA,sCAAsC,oCAAoC;AAC7D;;AAEb,kBAAkB,mBAAO,CAAC,uDAAa;AACvC,QAAQ,SAAS,EAAE,mBAAO,CAAC,sBAAQ;;AAEnC;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AChKa;;AAEb,QAAQ,aAAa,EAAE,mBAAO,CAAC,yDAAc;;AAE7C;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,KAAK;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAU,mBAAmB;AAC7B;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,+DAA+D,EAAE;AACjE;;AAEA;;AAEA;;AAEA;AACA,sCAAsC,SAAS;AAC/C;;AAEA;AACA;AACA,MAAM;AACN,6DAA6D,EAAE;AAC/D;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,kCAAkC,SAAS;AAC3C;;AAEA;AACA;AACA;;AAEA,mBAAmB;;;;;;;;;;;;AC7DN;;AAEb,QAAQ,SAAS,EAAE,mBAAO,CAAC,sBAAQ;;AAEnC,QAAQ,UAAU,EAAE,mBAAO,CAAC,uDAAa;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,GAAG;AACd,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,0BAA0B;AAC5B;AACA;AACA,EAAE;AACF;AACA,wBAAwB,mBAAO,CAAC,6IAAgB;;AAEhD,IAAI,0BAA0B;AAC9B;AACA;AACA,IAAI;AACJ;AACA;AACA;;;;;;;;;;;;ACvJA,sCAAsC,yDAAyD;;AAElF;;AAEb,qBAAqB,mBAAO,CAAC,sBAAQ;AACrC,aAAa,mBAAO,CAAC,kBAAM;AAC3B,QAAQ,SAAS,EAAE,mBAAO,CAAC,sBAAQ;AACnC,QAAQ,aAAa,EAAE,mBAAO,CAAC,sBAAQ;;AAEvC,kBAAkB,mBAAO,CAAC,uDAAa;AACvC,0BAA0B,mBAAO,CAAC,yEAAsB;AACxD,oBAAoB,mBAAO,CAAC,2DAAe;AAC3C,kBAAkB,mBAAO,CAAC,uDAAa;AACvC,QAAQ,mBAAmB,EAAE,mBAAO,CAAC,uDAAa;;AAElD,iCAAiC,GAAG;;AAEpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA;AACA,aAAa,SAAS;AACtB;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB,aAAa,QAAQ;AACrB,aAAa,kBAAkB;AAC/B;AACA,aAAa,QAAQ;AACrB,aAAa,4BAA4B;AACzC;AACA,aAAa,SAAS;AACtB;AACA,aAAa,UAAU;AACvB,aAAa,UAAU;AACvB;AACA,aAAa,UAAU;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,sBAAsB;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,aAAa,sBAAsB;AACnC,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,sBAAsB;AACnC,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,UAAU;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,kDAAkD;AAC3E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,KAAK;AAClB,aAAa,sBAAsB;AACnC,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,UAAU;AACvB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+BAA+B,OAAO;AACtC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,gDAAgD,MAAM;AACtD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,2BAA2B;AACtC,YAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,gBAAgB,MAAM,EAAE,wBAAwB;AAChD;AACA,uBAAuB,EAAE,IAAI,WAAW;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,sBAAsB;AACjC,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA;;;;;;;;;;;;ACriBA,sCAAsC,kEAAkE;;AAE3F;;AAEb,qBAAqB,mBAAO,CAAC,sBAAQ;AACrC,cAAc,mBAAO,CAAC,oBAAO;AAC7B,aAAa,mBAAO,CAAC,kBAAM;AAC3B,YAAY,mBAAO,CAAC,gBAAK;AACzB,YAAY,mBAAO,CAAC,gBAAK;AACzB,QAAQ,0BAA0B,EAAE,mBAAO,CAAC,sBAAQ;AACpD,QAAQ,mBAAmB,EAAE,mBAAO,CAAC,sBAAQ;AAC7C,QAAQ,MAAM,EAAE,mBAAO,CAAC,gBAAK;;AAE7B,0BAA0B,mBAAO,CAAC,yEAAsB;AACxD,iBAAiB,mBAAO,CAAC,qDAAY;AACrC,eAAe,mBAAO,CAAC,iDAAU;AACjC,QAAQ,SAAS,EAAE,mBAAO,CAAC,yDAAc;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,EAAE,mBAAO,CAAC,uDAAa;AACzB;AACA,iBAAiB;AACjB,EAAE,EAAE,mBAAO,CAAC,6DAAgB;AAC5B,QAAQ,gBAAgB,EAAE,mBAAO,CAAC,uDAAa;AAC/C,QAAQ,WAAW,EAAE,mBAAO,CAAC,2DAAe;;AAE5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,cAAc;AAC3B,aAAa,mBAAmB;AAChC,aAAa,QAAQ;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA;AACA,aAAa,UAAU;AACvB;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,GAAG;AAChB,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,GAAG;AAChB,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,GAAG;AAChB,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,SAAS;AACtB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,kBAAkB;AAC3E,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,kDAAkD,OAAO;AACzD;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH,CAAC;;AAED;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB;AACA;AACA,WAAW,SAAS;AACpB;AACA,WAAW,UAAU;AACrB;AACA,WAAW,SAAS;AACpB;AACA,WAAW,UAAU;AACrB;AACA,WAAW,QAAQ;AACnB;AACA,WAAW,QAAQ;AACnB;AACA,WAAW,QAAQ;AACnB;AACA,WAAW,QAAQ;AACnB;AACA,WAAW,kBAAkB;AAC7B;AACA,WAAW,QAAQ;AACnB;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,uCAAuC,sBAAsB;AAC7D,gCAAgC,4BAA4B;AAC5D;AACA;;AAEA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA,MAAM;AACN,4CAA4C,QAAQ;AACpD;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mEAAmE;AACnE;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB,GAAG,mBAAmB;AAC5D;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB;;AAElB;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,QAAQ;AACR,oDAAoD,SAAS;AAC7D;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA,uCAAuC,eAAe;AACtD;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,YAAY;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,eAAe;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,4CAA4C;AACvD;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,GAAG;AACd,WAAW,UAAU;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2CAA2C,sBAAsB;AACjE,YAAY,kCAAkC;AAC9C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,oBAAoB;AAC/B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,8BAA8B;AACzC,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,UAAU;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC32CY;AACZ;AACA;AACA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;;;;;;;;;;;;ACPY;AACZ;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ,0CAA0C,OAAO;AACjD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,OAAO;AAC/C;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,OAAO;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sCAAsC,iBAAiB;AACvD;AACA;AACA;AACA;;AAEA;AACA;AACA,oDAAoD,iBAAiB;AACrE;AACA;AACA;AACA;;AAEA;AACA,sCAAsC,0BAA0B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sCAAsC,0BAA0B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+BAA+B,gBAAgB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+BAA+B,gBAAgB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;;AAEA,kBAAkB,iBAAiB;AACnC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;;AAEA,gCAAgC,iBAAiB;AACjD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sCAAsC,iBAAiB;AACvD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sCAAsC,iBAAiB;AACvD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,6BAA6B;AACnE;AACA;AACA,SAAS,2BAA2B;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","sources":["webpack://vsembed-ai-devtool/./node_modules/lru-cache/index.js","webpack://vsembed-ai-devtool/./node_modules/ws/index.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/buffer-util.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/constants.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/event-target.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/extension.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/limiter.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/permessage-deflate.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/receiver.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/sender.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/stream.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/subprotocol.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/validation.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/websocket-server.js","webpack://vsembed-ai-devtool/./node_modules/ws/lib/websocket.js","webpack://vsembed-ai-devtool/./node_modules/yallist/iterator.js","webpack://vsembed-ai-devtool/./node_modules/yallist/yallist.js","webpack://vsembed-ai-devtool/./src/ai/config.ts","webpack://vsembed-ai-devtool/./src/ai/streaming.ts","webpack://vsembed-ai-devtool/./src/ai/tool-executor.ts","webpack://vsembed-ai-devtool/./src/docker/sandbox.ts","webpack://vsembed-ai-devtool/./src/extensions/recommender.ts","webpack://vsembed-ai-devtool/./src/main/main.ts","webpack://vsembed-ai-devtool/./src/performance/ sync","webpack://vsembed-ai-devtool/./src/performance/optimizer.ts","webpack://vsembed-ai-devtool/./src/permissions/manager.ts","webpack://vsembed-ai-devtool/external node-commonjs \"buffer\"","webpack://vsembed-ai-devtool/external node-commonjs \"child_process\"","webpack://vsembed-ai-devtool/external node-commonjs \"crypto\"","webpack://vsembed-ai-devtool/external commonjs2 \"electron\"","webpack://vsembed-ai-devtool/external node-commonjs \"events\"","webpack://vsembed-ai-devtool/external node-commonjs \"fs/promises\"","webpack://vsembed-ai-devtool/external node-commonjs \"http\"","webpack://vsembed-ai-devtool/external node-commonjs \"https\"","webpack://vsembed-ai-devtool/external node-commonjs \"net\"","webpack://vsembed-ai-devtool/external node-commonjs \"path\"","webpack://vsembed-ai-devtool/external node-commonjs \"stream\"","webpack://vsembed-ai-devtool/external node-commonjs \"tls\"","webpack://vsembed-ai-devtool/external node-commonjs \"url\"","webpack://vsembed-ai-devtool/external commonjs2 \"vscode\"","webpack://vsembed-ai-devtool/external node-commonjs \"zlib\"","webpack://vsembed-ai-devtool/webpack/bootstrap","webpack://vsembed-ai-devtool/webpack/runtime/hasOwnProperty shorthand","webpack://vsembed-ai-devtool/webpack/before-startup","webpack://vsembed-ai-devtool/webpack/startup","webpack://vsembed-ai-devtool/webpack/after-startup"],"sourcesContent":["'use strict'\n\n// A linked list to keep track of recently-used-ness\nconst Yallist = require('yallist')\n\nconst MAX = Symbol('max')\nconst LENGTH = Symbol('length')\nconst LENGTH_CALCULATOR = Symbol('lengthCalculator')\nconst ALLOW_STALE = Symbol('allowStale')\nconst MAX_AGE = Symbol('maxAge')\nconst DISPOSE = Symbol('dispose')\nconst NO_DISPOSE_ON_SET = Symbol('noDisposeOnSet')\nconst LRU_LIST = Symbol('lruList')\nconst CACHE = Symbol('cache')\nconst UPDATE_AGE_ON_GET = Symbol('updateAgeOnGet')\n\nconst naiveLength = () => 1\n\n// lruList is a yallist where the head is the youngest\n// item, and the tail is the oldest.  the list contains the Hit\n// objects as the entries.\n// Each Hit object has a reference to its Yallist.Node.  This\n// never changes.\n//\n// cache is a Map (or PseudoMap) that matches the keys to\n// the Yallist.Node object.\nclass LRUCache {\n  constructor (options) {\n    if (typeof options === 'number')\n      options = { max: options }\n\n    if (!options)\n      options = {}\n\n    if (options.max && (typeof options.max !== 'number' || options.max < 0))\n      throw new TypeError('max must be a non-negative number')\n    // Kind of weird to have a default max of Infinity, but oh well.\n    const max = this[MAX] = options.max || Infinity\n\n    const lc = options.length || naiveLength\n    this[LENGTH_CALCULATOR] = (typeof lc !== 'function') ? naiveLength : lc\n    this[ALLOW_STALE] = options.stale || false\n    if (options.maxAge && typeof options.maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n    this[MAX_AGE] = options.maxAge || 0\n    this[DISPOSE] = options.dispose\n    this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false\n    this[UPDATE_AGE_ON_GET] = options.updateAgeOnGet || false\n    this.reset()\n  }\n\n  // resize the cache when the max changes.\n  set max (mL) {\n    if (typeof mL !== 'number' || mL < 0)\n      throw new TypeError('max must be a non-negative number')\n\n    this[MAX] = mL || Infinity\n    trim(this)\n  }\n  get max () {\n    return this[MAX]\n  }\n\n  set allowStale (allowStale) {\n    this[ALLOW_STALE] = !!allowStale\n  }\n  get allowStale () {\n    return this[ALLOW_STALE]\n  }\n\n  set maxAge (mA) {\n    if (typeof mA !== 'number')\n      throw new TypeError('maxAge must be a non-negative number')\n\n    this[MAX_AGE] = mA\n    trim(this)\n  }\n  get maxAge () {\n    return this[MAX_AGE]\n  }\n\n  // resize the cache when the lengthCalculator changes.\n  set lengthCalculator (lC) {\n    if (typeof lC !== 'function')\n      lC = naiveLength\n\n    if (lC !== this[LENGTH_CALCULATOR]) {\n      this[LENGTH_CALCULATOR] = lC\n      this[LENGTH] = 0\n      this[LRU_LIST].forEach(hit => {\n        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)\n        this[LENGTH] += hit.length\n      })\n    }\n    trim(this)\n  }\n  get lengthCalculator () { return this[LENGTH_CALCULATOR] }\n\n  get length () { return this[LENGTH] }\n  get itemCount () { return this[LRU_LIST].length }\n\n  rforEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].tail; walker !== null;) {\n      const prev = walker.prev\n      forEachStep(this, fn, walker, thisp)\n      walker = prev\n    }\n  }\n\n  forEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].head; walker !== null;) {\n      const next = walker.next\n      forEachStep(this, fn, walker, thisp)\n      walker = next\n    }\n  }\n\n  keys () {\n    return this[LRU_LIST].toArray().map(k => k.key)\n  }\n\n  values () {\n    return this[LRU_LIST].toArray().map(k => k.value)\n  }\n\n  reset () {\n    if (this[DISPOSE] &&\n        this[LRU_LIST] &&\n        this[LRU_LIST].length) {\n      this[LRU_LIST].forEach(hit => this[DISPOSE](hit.key, hit.value))\n    }\n\n    this[CACHE] = new Map() // hash of items by key\n    this[LRU_LIST] = new Yallist() // list of items in order of use recency\n    this[LENGTH] = 0 // length of items in the list\n  }\n\n  dump () {\n    return this[LRU_LIST].map(hit =>\n      isStale(this, hit) ? false : {\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      }).toArray().filter(h => h)\n  }\n\n  dumpLru () {\n    return this[LRU_LIST]\n  }\n\n  set (key, value, maxAge) {\n    maxAge = maxAge || this[MAX_AGE]\n\n    if (maxAge && typeof maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n\n    const now = maxAge ? Date.now() : 0\n    const len = this[LENGTH_CALCULATOR](value, key)\n\n    if (this[CACHE].has(key)) {\n      if (len > this[MAX]) {\n        del(this, this[CACHE].get(key))\n        return false\n      }\n\n      const node = this[CACHE].get(key)\n      const item = node.value\n\n      // dispose of the old one before overwriting\n      // split out into 2 ifs for better coverage tracking\n      if (this[DISPOSE]) {\n        if (!this[NO_DISPOSE_ON_SET])\n          this[DISPOSE](key, item.value)\n      }\n\n      item.now = now\n      item.maxAge = maxAge\n      item.value = value\n      this[LENGTH] += len - item.length\n      item.length = len\n      this.get(key)\n      trim(this)\n      return true\n    }\n\n    const hit = new Entry(key, value, len, now, maxAge)\n\n    // oversized objects fall out of cache automatically.\n    if (hit.length > this[MAX]) {\n      if (this[DISPOSE])\n        this[DISPOSE](key, value)\n\n      return false\n    }\n\n    this[LENGTH] += hit.length\n    this[LRU_LIST].unshift(hit)\n    this[CACHE].set(key, this[LRU_LIST].head)\n    trim(this)\n    return true\n  }\n\n  has (key) {\n    if (!this[CACHE].has(key)) return false\n    const hit = this[CACHE].get(key).value\n    return !isStale(this, hit)\n  }\n\n  get (key) {\n    return get(this, key, true)\n  }\n\n  peek (key) {\n    return get(this, key, false)\n  }\n\n  pop () {\n    const node = this[LRU_LIST].tail\n    if (!node)\n      return null\n\n    del(this, node)\n    return node.value\n  }\n\n  del (key) {\n    del(this, this[CACHE].get(key))\n  }\n\n  load (arr) {\n    // reset the cache\n    this.reset()\n\n    const now = Date.now()\n    // A previous serialized cache has the most recent items first\n    for (let l = arr.length - 1; l >= 0; l--) {\n      const hit = arr[l]\n      const expiresAt = hit.e || 0\n      if (expiresAt === 0)\n        // the item was created without expiration in a non aged cache\n        this.set(hit.k, hit.v)\n      else {\n        const maxAge = expiresAt - now\n        // dont add already expired items\n        if (maxAge > 0) {\n          this.set(hit.k, hit.v, maxAge)\n        }\n      }\n    }\n  }\n\n  prune () {\n    this[CACHE].forEach((value, key) => get(this, key, false))\n  }\n}\n\nconst get = (self, key, doUse) => {\n  const node = self[CACHE].get(key)\n  if (node) {\n    const hit = node.value\n    if (isStale(self, hit)) {\n      del(self, node)\n      if (!self[ALLOW_STALE])\n        return undefined\n    } else {\n      if (doUse) {\n        if (self[UPDATE_AGE_ON_GET])\n          node.value.now = Date.now()\n        self[LRU_LIST].unshiftNode(node)\n      }\n    }\n    return hit.value\n  }\n}\n\nconst isStale = (self, hit) => {\n  if (!hit || (!hit.maxAge && !self[MAX_AGE]))\n    return false\n\n  const diff = Date.now() - hit.now\n  return hit.maxAge ? diff > hit.maxAge\n    : self[MAX_AGE] && (diff > self[MAX_AGE])\n}\n\nconst trim = self => {\n  if (self[LENGTH] > self[MAX]) {\n    for (let walker = self[LRU_LIST].tail;\n      self[LENGTH] > self[MAX] && walker !== null;) {\n      // We know that we're about to delete this one, and also\n      // what the next least recently used key will be, so just\n      // go ahead and set it now.\n      const prev = walker.prev\n      del(self, walker)\n      walker = prev\n    }\n  }\n}\n\nconst del = (self, node) => {\n  if (node) {\n    const hit = node.value\n    if (self[DISPOSE])\n      self[DISPOSE](hit.key, hit.value)\n\n    self[LENGTH] -= hit.length\n    self[CACHE].delete(hit.key)\n    self[LRU_LIST].removeNode(node)\n  }\n}\n\nclass Entry {\n  constructor (key, value, length, now, maxAge) {\n    this.key = key\n    this.value = value\n    this.length = length\n    this.now = now\n    this.maxAge = maxAge || 0\n  }\n}\n\nconst forEachStep = (self, fn, node, thisp) => {\n  let hit = node.value\n  if (isStale(self, hit)) {\n    del(self, node)\n    if (!self[ALLOW_STALE])\n      hit = undefined\n  }\n  if (hit)\n    fn.call(thisp, hit.value, hit.key, self)\n}\n\nmodule.exports = LRUCache\n","'use strict';\n\nconst WebSocket = require('./lib/websocket');\n\nWebSocket.createWebSocketStream = require('./lib/stream');\nWebSocket.Server = require('./lib/websocket-server');\nWebSocket.Receiver = require('./lib/receiver');\nWebSocket.Sender = require('./lib/sender');\n\nWebSocket.WebSocket = WebSocket;\nWebSocket.WebSocketServer = WebSocket.Server;\n\nmodule.exports = WebSocket;\n","'use strict';\n\nconst { EMPTY_BUFFER } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\n\n/**\n * Merges an array of buffers into a new buffer.\n *\n * @param {Buffer[]} list The array of buffers to concat\n * @param {Number} totalLength The total length of buffers in the list\n * @return {Buffer} The resulting buffer\n * @public\n */\nfunction concat(list, totalLength) {\n  if (list.length === 0) return EMPTY_BUFFER;\n  if (list.length === 1) return list[0];\n\n  const target = Buffer.allocUnsafe(totalLength);\n  let offset = 0;\n\n  for (let i = 0; i < list.length; i++) {\n    const buf = list[i];\n    target.set(buf, offset);\n    offset += buf.length;\n  }\n\n  if (offset < totalLength) {\n    return new FastBuffer(target.buffer, target.byteOffset, offset);\n  }\n\n  return target;\n}\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nfunction _mask(source, mask, output, offset, length) {\n  for (let i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n}\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nfunction _unmask(buffer, mask) {\n  for (let i = 0; i < buffer.length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n}\n\n/**\n * Converts a buffer to an `ArrayBuffer`.\n *\n * @param {Buffer} buf The buffer to convert\n * @return {ArrayBuffer} Converted buffer\n * @public\n */\nfunction toArrayBuffer(buf) {\n  if (buf.length === buf.buffer.byteLength) {\n    return buf.buffer;\n  }\n\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.length);\n}\n\n/**\n * Converts `data` to a `Buffer`.\n *\n * @param {*} data The data to convert\n * @return {Buffer} The buffer\n * @throws {TypeError}\n * @public\n */\nfunction toBuffer(data) {\n  toBuffer.readOnly = true;\n\n  if (Buffer.isBuffer(data)) return data;\n\n  let buf;\n\n  if (data instanceof ArrayBuffer) {\n    buf = new FastBuffer(data);\n  } else if (ArrayBuffer.isView(data)) {\n    buf = new FastBuffer(data.buffer, data.byteOffset, data.byteLength);\n  } else {\n    buf = Buffer.from(data);\n    toBuffer.readOnly = false;\n  }\n\n  return buf;\n}\n\nmodule.exports = {\n  concat,\n  mask: _mask,\n  toArrayBuffer,\n  toBuffer,\n  unmask: _unmask\n};\n\n/* istanbul ignore else  */\nif (!process.env.WS_NO_BUFFER_UTIL) {\n  try {\n    const bufferUtil = require('bufferutil');\n\n    module.exports.mask = function (source, mask, output, offset, length) {\n      if (length < 48) _mask(source, mask, output, offset, length);\n      else bufferUtil.mask(source, mask, output, offset, length);\n    };\n\n    module.exports.unmask = function (buffer, mask) {\n      if (buffer.length < 32) _unmask(buffer, mask);\n      else bufferUtil.unmask(buffer, mask);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst BINARY_TYPES = ['nodebuffer', 'arraybuffer', 'fragments'];\nconst hasBlob = typeof Blob !== 'undefined';\n\nif (hasBlob) BINARY_TYPES.push('blob');\n\nmodule.exports = {\n  BINARY_TYPES,\n  EMPTY_BUFFER: Buffer.alloc(0),\n  GUID: '258EAFA5-E914-47DA-95CA-C5AB0DC85B11',\n  hasBlob,\n  kForOnEventAttribute: Symbol('kIsForOnEventAttribute'),\n  kListener: Symbol('kListener'),\n  kStatusCode: Symbol('status-code'),\n  kWebSocket: Symbol('websocket'),\n  NOOP: () => {}\n};\n","'use strict';\n\nconst { kForOnEventAttribute, kListener } = require('./constants');\n\nconst kCode = Symbol('kCode');\nconst kData = Symbol('kData');\nconst kError = Symbol('kError');\nconst kMessage = Symbol('kMessage');\nconst kReason = Symbol('kReason');\nconst kTarget = Symbol('kTarget');\nconst kType = Symbol('kType');\nconst kWasClean = Symbol('kWasClean');\n\n/**\n * Class representing an event.\n */\nclass Event {\n  /**\n   * Create a new `Event`.\n   *\n   * @param {String} type The name of the event\n   * @throws {TypeError} If the `type` argument is not specified\n   */\n  constructor(type) {\n    this[kTarget] = null;\n    this[kType] = type;\n  }\n\n  /**\n   * @type {*}\n   */\n  get target() {\n    return this[kTarget];\n  }\n\n  /**\n   * @type {String}\n   */\n  get type() {\n    return this[kType];\n  }\n}\n\nObject.defineProperty(Event.prototype, 'target', { enumerable: true });\nObject.defineProperty(Event.prototype, 'type', { enumerable: true });\n\n/**\n * Class representing a close event.\n *\n * @extends Event\n */\nclass CloseEvent extends Event {\n  /**\n   * Create a new `CloseEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {Number} [options.code=0] The status code explaining why the\n   *     connection was closed\n   * @param {String} [options.reason=''] A human-readable string explaining why\n   *     the connection was closed\n   * @param {Boolean} [options.wasClean=false] Indicates whether or not the\n   *     connection was cleanly closed\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kCode] = options.code === undefined ? 0 : options.code;\n    this[kReason] = options.reason === undefined ? '' : options.reason;\n    this[kWasClean] = options.wasClean === undefined ? false : options.wasClean;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get code() {\n    return this[kCode];\n  }\n\n  /**\n   * @type {String}\n   */\n  get reason() {\n    return this[kReason];\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get wasClean() {\n    return this[kWasClean];\n  }\n}\n\nObject.defineProperty(CloseEvent.prototype, 'code', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'reason', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'wasClean', { enumerable: true });\n\n/**\n * Class representing an error event.\n *\n * @extends Event\n */\nclass ErrorEvent extends Event {\n  /**\n   * Create a new `ErrorEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.error=null] The error that generated this event\n   * @param {String} [options.message=''] The error message\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kError] = options.error === undefined ? null : options.error;\n    this[kMessage] = options.message === undefined ? '' : options.message;\n  }\n\n  /**\n   * @type {*}\n   */\n  get error() {\n    return this[kError];\n  }\n\n  /**\n   * @type {String}\n   */\n  get message() {\n    return this[kMessage];\n  }\n}\n\nObject.defineProperty(ErrorEvent.prototype, 'error', { enumerable: true });\nObject.defineProperty(ErrorEvent.prototype, 'message', { enumerable: true });\n\n/**\n * Class representing a message event.\n *\n * @extends Event\n */\nclass MessageEvent extends Event {\n  /**\n   * Create a new `MessageEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.data=null] The message content\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kData] = options.data === undefined ? null : options.data;\n  }\n\n  /**\n   * @type {*}\n   */\n  get data() {\n    return this[kData];\n  }\n}\n\nObject.defineProperty(MessageEvent.prototype, 'data', { enumerable: true });\n\n/**\n * This provides methods for emulating the `EventTarget` interface. It's not\n * meant to be used directly.\n *\n * @mixin\n */\nconst EventTarget = {\n  /**\n   * Register an event listener.\n   *\n   * @param {String} type A string representing the event type to listen for\n   * @param {(Function|Object)} handler The listener to add\n   * @param {Object} [options] An options object specifies characteristics about\n   *     the event listener\n   * @param {Boolean} [options.once=false] A `Boolean` indicating that the\n   *     listener should be invoked at most once after being added. If `true`,\n   *     the listener would be automatically removed when invoked.\n   * @public\n   */\n  addEventListener(type, handler, options = {}) {\n    for (const listener of this.listeners(type)) {\n      if (\n        !options[kForOnEventAttribute] &&\n        listener[kListener] === handler &&\n        !listener[kForOnEventAttribute]\n      ) {\n        return;\n      }\n    }\n\n    let wrapper;\n\n    if (type === 'message') {\n      wrapper = function onMessage(data, isBinary) {\n        const event = new MessageEvent('message', {\n          data: isBinary ? data : data.toString()\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'close') {\n      wrapper = function onClose(code, message) {\n        const event = new CloseEvent('close', {\n          code,\n          reason: message.toString(),\n          wasClean: this._closeFrameReceived && this._closeFrameSent\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'error') {\n      wrapper = function onError(error) {\n        const event = new ErrorEvent('error', {\n          error,\n          message: error.message\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'open') {\n      wrapper = function onOpen() {\n        const event = new Event('open');\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else {\n      return;\n    }\n\n    wrapper[kForOnEventAttribute] = !!options[kForOnEventAttribute];\n    wrapper[kListener] = handler;\n\n    if (options.once) {\n      this.once(type, wrapper);\n    } else {\n      this.on(type, wrapper);\n    }\n  },\n\n  /**\n   * Remove an event listener.\n   *\n   * @param {String} type A string representing the event type to remove\n   * @param {(Function|Object)} handler The listener to remove\n   * @public\n   */\n  removeEventListener(type, handler) {\n    for (const listener of this.listeners(type)) {\n      if (listener[kListener] === handler && !listener[kForOnEventAttribute]) {\n        this.removeListener(type, listener);\n        break;\n      }\n    }\n  }\n};\n\nmodule.exports = {\n  CloseEvent,\n  ErrorEvent,\n  Event,\n  EventTarget,\n  MessageEvent\n};\n\n/**\n * Call an event listener\n *\n * @param {(Function|Object)} listener The listener to call\n * @param {*} thisArg The value to use as `this`` when calling the listener\n * @param {Event} event The event to pass to the listener\n * @private\n */\nfunction callListener(listener, thisArg, event) {\n  if (typeof listener === 'object' && listener.handleEvent) {\n    listener.handleEvent.call(listener, event);\n  } else {\n    listener.call(thisArg, event);\n  }\n}\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Adds an offer to the map of extension offers or a parameter to the map of\n * parameters.\n *\n * @param {Object} dest The map of extension offers or parameters\n * @param {String} name The extension or parameter name\n * @param {(Object|Boolean|String)} elem The extension parameters or the\n *     parameter value\n * @private\n */\nfunction push(dest, name, elem) {\n  if (dest[name] === undefined) dest[name] = [elem];\n  else dest[name].push(elem);\n}\n\n/**\n * Parses the `Sec-WebSocket-Extensions` header into an object.\n *\n * @param {String} header The field value of the header\n * @return {Object} The parsed object\n * @public\n */\nfunction parse(header) {\n  const offers = Object.create(null);\n  let params = Object.create(null);\n  let mustUnescape = false;\n  let isEscaping = false;\n  let inQuotes = false;\n  let extensionName;\n  let paramName;\n  let start = -1;\n  let code = -1;\n  let end = -1;\n  let i = 0;\n\n  for (; i < header.length; i++) {\n    code = header.charCodeAt(i);\n\n    if (extensionName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (\n        i !== 0 &&\n        (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n      ) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b /* ';' */ || code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        const name = header.slice(start, end);\n        if (code === 0x2c) {\n          push(offers, name, params);\n          params = Object.create(null);\n        } else {\n          extensionName = name;\n        }\n\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else if (paramName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (code === 0x20 || code === 0x09) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        push(params, header.slice(start, end), true);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        start = end = -1;\n      } else if (code === 0x3d /* '=' */ && start !== -1 && end === -1) {\n        paramName = header.slice(start, i);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else {\n      //\n      // The value of a quoted-string after unescaping must conform to the\n      // token ABNF, so only token characters are valid.\n      // Ref: https://tools.ietf.org/html/rfc6455#section-9.1\n      //\n      if (isEscaping) {\n        if (tokenChars[code] !== 1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (start === -1) start = i;\n        else if (!mustUnescape) mustUnescape = true;\n        isEscaping = false;\n      } else if (inQuotes) {\n        if (tokenChars[code] === 1) {\n          if (start === -1) start = i;\n        } else if (code === 0x22 /* '\"' */ && start !== -1) {\n          inQuotes = false;\n          end = i;\n        } else if (code === 0x5c /* '\\' */) {\n          isEscaping = true;\n        } else {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n      } else if (code === 0x22 && header.charCodeAt(i - 1) === 0x3d) {\n        inQuotes = true;\n      } else if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (start !== -1 && (code === 0x20 || code === 0x09)) {\n        if (end === -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        let value = header.slice(start, end);\n        if (mustUnescape) {\n          value = value.replace(/\\\\/g, '');\n          mustUnescape = false;\n        }\n        push(params, paramName, value);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        paramName = undefined;\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n  }\n\n  if (start === -1 || inQuotes || code === 0x20 || code === 0x09) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  if (end === -1) end = i;\n  const token = header.slice(start, end);\n  if (extensionName === undefined) {\n    push(offers, token, params);\n  } else {\n    if (paramName === undefined) {\n      push(params, token, true);\n    } else if (mustUnescape) {\n      push(params, paramName, token.replace(/\\\\/g, ''));\n    } else {\n      push(params, paramName, token);\n    }\n    push(offers, extensionName, params);\n  }\n\n  return offers;\n}\n\n/**\n * Builds the `Sec-WebSocket-Extensions` header field value.\n *\n * @param {Object} extensions The map of extensions and parameters to format\n * @return {String} A string representing the given object\n * @public\n */\nfunction format(extensions) {\n  return Object.keys(extensions)\n    .map((extension) => {\n      let configurations = extensions[extension];\n      if (!Array.isArray(configurations)) configurations = [configurations];\n      return configurations\n        .map((params) => {\n          return [extension]\n            .concat(\n              Object.keys(params).map((k) => {\n                let values = params[k];\n                if (!Array.isArray(values)) values = [values];\n                return values\n                  .map((v) => (v === true ? k : `${k}=${v}`))\n                  .join('; ');\n              })\n            )\n            .join('; ');\n        })\n        .join(', ');\n    })\n    .join(', ');\n}\n\nmodule.exports = { format, parse };\n","'use strict';\n\nconst kDone = Symbol('kDone');\nconst kRun = Symbol('kRun');\n\n/**\n * A very simple job queue with adjustable concurrency. Adapted from\n * https://github.com/STRML/async-limiter\n */\nclass Limiter {\n  /**\n   * Creates a new `Limiter`.\n   *\n   * @param {Number} [concurrency=Infinity] The maximum number of jobs allowed\n   *     to run concurrently\n   */\n  constructor(concurrency) {\n    this[kDone] = () => {\n      this.pending--;\n      this[kRun]();\n    };\n    this.concurrency = concurrency || Infinity;\n    this.jobs = [];\n    this.pending = 0;\n  }\n\n  /**\n   * Adds a job to the queue.\n   *\n   * @param {Function} job The job to run\n   * @public\n   */\n  add(job) {\n    this.jobs.push(job);\n    this[kRun]();\n  }\n\n  /**\n   * Removes a job from the queue and runs it if possible.\n   *\n   * @private\n   */\n  [kRun]() {\n    if (this.pending === this.concurrency) return;\n\n    if (this.jobs.length) {\n      const job = this.jobs.shift();\n\n      this.pending++;\n      job(this[kDone]);\n    }\n  }\n}\n\nmodule.exports = Limiter;\n","'use strict';\n\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./buffer-util');\nconst Limiter = require('./limiter');\nconst { kStatusCode } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst kPerMessageDeflate = Symbol('permessage-deflate');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} [options] Configuration options\n   * @param {(Boolean|Number)} [options.clientMaxWindowBits] Advertise support\n   *     for, or request, a custom client window size\n   * @param {Boolean} [options.clientNoContextTakeover=false] Advertise/\n   *     acknowledge disabling of client context takeover\n   * @param {Number} [options.concurrencyLimit=10] The number of concurrent\n   *     calls to zlib\n   * @param {(Boolean|Number)} [options.serverMaxWindowBits] Request/confirm the\n   *     use of a custom server window size\n   * @param {Boolean} [options.serverNoContextTakeover=false] Request/accept\n   *     disabling of server context takeover\n   * @param {Number} [options.threshold=1024] Size (in bytes) below which\n   *     messages should not be compressed if context takeover is disabled\n   * @param {Object} [options.zlibDeflateOptions] Options to pass to zlib on\n   *     deflate\n   * @param {Object} [options.zlibInflateOptions] Options to pass to zlib on\n   *     inflate\n   * @param {Boolean} [isServer=false] Create the instance in either server or\n   *     client mode\n   * @param {Number} [maxPayload=0] The maximum allowed message length\n   */\n  constructor(options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold =\n      this._options.threshold !== undefined ? this._options.threshold : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency =\n        this._options.concurrencyLimit !== undefined\n          ? this._options.concurrencyLimit\n          : 10;\n      zlibLimiter = new Limiter(concurrency);\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName() {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create an extension negotiation offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer() {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept an extension negotiation offer/response.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept(configurations) {\n    configurations = this.normalizeParams(configurations);\n\n    this.params = this._isServer\n      ? this.acceptAsServer(configurations)\n      : this.acceptAsClient(configurations);\n\n    return this.params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup() {\n    if (this._inflate) {\n      this._inflate.close();\n      this._inflate = null;\n    }\n\n    if (this._deflate) {\n      const callback = this._deflate[kCallback];\n\n      this._deflate.close();\n      this._deflate = null;\n\n      if (callback) {\n        callback(\n          new Error(\n            'The deflate stream was closed while data was being processed'\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   *  Accept an extension negotiation offer.\n   *\n   * @param {Array} offers The extension negotiation offers\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer(offers) {\n    const opts = this._options;\n    const accepted = offers.find((params) => {\n      if (\n        (opts.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (params.server_max_window_bits &&\n          (opts.serverMaxWindowBits === false ||\n            (typeof opts.serverMaxWindowBits === 'number' &&\n              opts.serverMaxWindowBits > params.server_max_window_bits))) ||\n        (typeof opts.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!accepted) {\n      throw new Error('None of the extension offers can be accepted');\n    }\n\n    if (opts.serverNoContextTakeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (opts.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof opts.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = opts.serverMaxWindowBits;\n    }\n    if (typeof opts.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = opts.clientMaxWindowBits;\n    } else if (\n      accepted.client_max_window_bits === true ||\n      opts.clientMaxWindowBits === false\n    ) {\n      delete accepted.client_max_window_bits;\n    }\n\n    return accepted;\n  }\n\n  /**\n   * Accept the extension negotiation response.\n   *\n   * @param {Array} response The extension negotiation response\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient(response) {\n    const params = response[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Unexpected parameter \"client_no_context_takeover\"');\n    }\n\n    if (!params.client_max_window_bits) {\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        params.client_max_window_bits = this._options.clientMaxWindowBits;\n      }\n    } else if (\n      this._options.clientMaxWindowBits === false ||\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        params.client_max_window_bits > this._options.clientMaxWindowBits)\n    ) {\n      throw new Error(\n        'Unexpected or invalid parameter \"client_max_window_bits\"'\n      );\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize parameters.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Array} The offers/response with normalized parameters\n   * @private\n   */\n  normalizeParams(configurations) {\n    configurations.forEach((params) => {\n      Object.keys(params).forEach((key) => {\n        let value = params[key];\n\n        if (value.length > 1) {\n          throw new Error(`Parameter \"${key}\" must have only a single value`);\n        }\n\n        value = value[0];\n\n        if (key === 'client_max_window_bits') {\n          if (value !== true) {\n            const num = +value;\n            if (!Number.isInteger(num) || num < 8 || num > 15) {\n              throw new TypeError(\n                `Invalid value for parameter \"${key}\": ${value}`\n              );\n            }\n            value = num;\n          } else if (!this._isServer) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else if (key === 'server_max_window_bits') {\n          const num = +value;\n          if (!Number.isInteger(num) || num < 8 || num > 15) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n          value = num;\n        } else if (\n          key === 'client_no_context_takeover' ||\n          key === 'server_no_context_takeover'\n        ) {\n          if (value !== true) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else {\n          throw new Error(`Unknown parameter \"${key}\"`);\n        }\n\n        params[key] = value;\n      });\n    });\n\n    return configurations;\n  }\n\n  /**\n   * Decompress data. Concurrency limited.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress(data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({\n        ...this._options.zlibInflateOptions,\n        windowBits\n      });\n      this._inflate[kPerMessageDeflate] = this;\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (this._inflate._readableState.endEmitted) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n\n        if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n          this._inflate.reset();\n        }\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress(data, fin, callback) {\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        ...this._options.zlibDeflateOptions,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kCallback] = callback;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      if (!this._deflate) {\n        //\n        // The deflate stream was closed while data was being processed.\n        //\n        return;\n      }\n\n      let data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) {\n        data = new FastBuffer(data.buffer, data.byteOffset, data.length - 4);\n      }\n\n      //\n      // Ensure that the callback will not be called again in\n      // `PerMessageDeflate#cleanup()`.\n      //\n      this._deflate[kCallback] = null;\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n        this._deflate.reset();\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData(chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData(chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kPerMessageDeflate]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kPerMessageDeflate]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new RangeError('Max payload size exceeded');\n  this[kError].code = 'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH';\n  this[kError][kStatusCode] = 1009;\n  this.removeListener('data', inflateOnData);\n\n  //\n  // The choice to employ `zlib.reset()` over `zlib.close()` is dictated by the\n  // fact that in Node.js versions prior to 13.10.0, the callback for\n  // `zlib.flush()` is not called if `zlib.close()` is used. Utilizing\n  // `zlib.reset()` ensures that either the callback is invoked or an error is\n  // emitted.\n  //\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError(err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kPerMessageDeflate]._inflate = null;\n\n  if (this[kError]) {\n    this[kCallback](this[kError]);\n    return;\n  }\n\n  err[kStatusCode] = 1007;\n  this[kCallback](err);\n}\n","'use strict';\n\nconst { Writable } = require('stream');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  kStatusCode,\n  kWebSocket\n} = require('./constants');\nconst { concat, toArrayBuffer, unmask } = require('./buffer-util');\nconst { isValidStatusCode, isValidUTF8 } = require('./validation');\n\nconst FastBuffer = Buffer[Symbol.species];\n\nconst GET_INFO = 0;\nconst GET_PAYLOAD_LENGTH_16 = 1;\nconst GET_PAYLOAD_LENGTH_64 = 2;\nconst GET_MASK = 3;\nconst GET_DATA = 4;\nconst INFLATING = 5;\nconst DEFER_EVENT = 6;\n\n/**\n * HyBi Receiver implementation.\n *\n * @extends Writable\n */\nclass Receiver extends Writable {\n  /**\n   * Creates a Receiver instance.\n   *\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {String} [options.binaryType=nodebuffer] The type for binary data\n   * @param {Object} [options.extensions] An object containing the negotiated\n   *     extensions\n   * @param {Boolean} [options.isServer=false] Specifies whether to operate in\n   *     client or server mode\n   * @param {Number} [options.maxPayload=0] The maximum allowed message length\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   */\n  constructor(options = {}) {\n    super();\n\n    this._allowSynchronousEvents =\n      options.allowSynchronousEvents !== undefined\n        ? options.allowSynchronousEvents\n        : true;\n    this._binaryType = options.binaryType || BINARY_TYPES[0];\n    this._extensions = options.extensions || {};\n    this._isServer = !!options.isServer;\n    this._maxPayload = options.maxPayload | 0;\n    this._skipUTF8Validation = !!options.skipUTF8Validation;\n    this[kWebSocket] = undefined;\n\n    this._bufferedBytes = 0;\n    this._buffers = [];\n\n    this._compressed = false;\n    this._payloadLength = 0;\n    this._mask = undefined;\n    this._fragmented = 0;\n    this._masked = false;\n    this._fin = false;\n    this._opcode = 0;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragments = [];\n\n    this._errored = false;\n    this._loop = false;\n    this._state = GET_INFO;\n  }\n\n  /**\n   * Implements `Writable.prototype._write()`.\n   *\n   * @param {Buffer} chunk The chunk of data to write\n   * @param {String} encoding The character encoding of `chunk`\n   * @param {Function} cb Callback\n   * @private\n   */\n  _write(chunk, encoding, cb) {\n    if (this._opcode === 0x08 && this._state == GET_INFO) return cb();\n\n    this._bufferedBytes += chunk.length;\n    this._buffers.push(chunk);\n    this.startLoop(cb);\n  }\n\n  /**\n   * Consumes `n` bytes from the buffered data.\n   *\n   * @param {Number} n The number of bytes to consume\n   * @return {Buffer} The consumed bytes\n   * @private\n   */\n  consume(n) {\n    this._bufferedBytes -= n;\n\n    if (n === this._buffers[0].length) return this._buffers.shift();\n\n    if (n < this._buffers[0].length) {\n      const buf = this._buffers[0];\n      this._buffers[0] = new FastBuffer(\n        buf.buffer,\n        buf.byteOffset + n,\n        buf.length - n\n      );\n\n      return new FastBuffer(buf.buffer, buf.byteOffset, n);\n    }\n\n    const dst = Buffer.allocUnsafe(n);\n\n    do {\n      const buf = this._buffers[0];\n      const offset = dst.length - n;\n\n      if (n >= buf.length) {\n        dst.set(this._buffers.shift(), offset);\n      } else {\n        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);\n        this._buffers[0] = new FastBuffer(\n          buf.buffer,\n          buf.byteOffset + n,\n          buf.length - n\n        );\n      }\n\n      n -= buf.length;\n    } while (n > 0);\n\n    return dst;\n  }\n\n  /**\n   * Starts the parsing loop.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  startLoop(cb) {\n    this._loop = true;\n\n    do {\n      switch (this._state) {\n        case GET_INFO:\n          this.getInfo(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_16:\n          this.getPayloadLength16(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_64:\n          this.getPayloadLength64(cb);\n          break;\n        case GET_MASK:\n          this.getMask();\n          break;\n        case GET_DATA:\n          this.getData(cb);\n          break;\n        case INFLATING:\n        case DEFER_EVENT:\n          this._loop = false;\n          return;\n      }\n    } while (this._loop);\n\n    if (!this._errored) cb();\n  }\n\n  /**\n   * Reads the first two bytes of a frame.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getInfo(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(2);\n\n    if ((buf[0] & 0x30) !== 0x00) {\n      const error = this.createError(\n        RangeError,\n        'RSV2 and RSV3 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_2_3'\n      );\n\n      cb(error);\n      return;\n    }\n\n    const compressed = (buf[0] & 0x40) === 0x40;\n\n    if (compressed && !this._extensions[PerMessageDeflate.extensionName]) {\n      const error = this.createError(\n        RangeError,\n        'RSV1 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_1'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._fin = (buf[0] & 0x80) === 0x80;\n    this._opcode = buf[0] & 0x0f;\n    this._payloadLength = buf[1] & 0x7f;\n\n    if (this._opcode === 0x00) {\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (!this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          'invalid opcode 0',\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._opcode = this._fragmented;\n    } else if (this._opcode === 0x01 || this._opcode === 0x02) {\n      if (this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          `invalid opcode ${this._opcode}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._compressed = compressed;\n    } else if (this._opcode > 0x07 && this._opcode < 0x0b) {\n      if (!this._fin) {\n        const error = this.createError(\n          RangeError,\n          'FIN must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_FIN'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (\n        this._payloadLength > 0x7d ||\n        (this._opcode === 0x08 && this._payloadLength === 1)\n      ) {\n        const error = this.createError(\n          RangeError,\n          `invalid payload length ${this._payloadLength}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    } else {\n      const error = this.createError(\n        RangeError,\n        `invalid opcode ${this._opcode}`,\n        true,\n        1002,\n        'WS_ERR_INVALID_OPCODE'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (!this._fin && !this._fragmented) this._fragmented = this._opcode;\n    this._masked = (buf[1] & 0x80) === 0x80;\n\n    if (this._isServer) {\n      if (!this._masked) {\n        const error = this.createError(\n          RangeError,\n          'MASK must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_MASK'\n        );\n\n        cb(error);\n        return;\n      }\n    } else if (this._masked) {\n      const error = this.createError(\n        RangeError,\n        'MASK must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_MASK'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;\n    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;\n    else this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+16).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength16(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    this._payloadLength = this.consume(2).readUInt16BE(0);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+64).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength64(cb) {\n    if (this._bufferedBytes < 8) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(8);\n    const num = buf.readUInt32BE(0);\n\n    //\n    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned\n    // if payload length is greater than this number.\n    //\n    if (num > Math.pow(2, 53 - 32) - 1) {\n      const error = this.createError(\n        RangeError,\n        'Unsupported WebSocket frame: payload length > 2^53 - 1',\n        false,\n        1009,\n        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Payload length has been read.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  haveLength(cb) {\n    if (this._payloadLength && this._opcode < 0x08) {\n      this._totalPayloadLength += this._payloadLength;\n      if (this._totalPayloadLength > this._maxPayload && this._maxPayload > 0) {\n        const error = this.createError(\n          RangeError,\n          'Max payload size exceeded',\n          false,\n          1009,\n          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    }\n\n    if (this._masked) this._state = GET_MASK;\n    else this._state = GET_DATA;\n  }\n\n  /**\n   * Reads mask bytes.\n   *\n   * @private\n   */\n  getMask() {\n    if (this._bufferedBytes < 4) {\n      this._loop = false;\n      return;\n    }\n\n    this._mask = this.consume(4);\n    this._state = GET_DATA;\n  }\n\n  /**\n   * Reads data bytes.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getData(cb) {\n    let data = EMPTY_BUFFER;\n\n    if (this._payloadLength) {\n      if (this._bufferedBytes < this._payloadLength) {\n        this._loop = false;\n        return;\n      }\n\n      data = this.consume(this._payloadLength);\n\n      if (\n        this._masked &&\n        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0\n      ) {\n        unmask(data, this._mask);\n      }\n    }\n\n    if (this._opcode > 0x07) {\n      this.controlMessage(data, cb);\n      return;\n    }\n\n    if (this._compressed) {\n      this._state = INFLATING;\n      this.decompress(data, cb);\n      return;\n    }\n\n    if (data.length) {\n      //\n      // This message is not compressed so its length is the sum of the payload\n      // length of all fragments.\n      //\n      this._messageLength = this._totalPayloadLength;\n      this._fragments.push(data);\n    }\n\n    this.dataMessage(cb);\n  }\n\n  /**\n   * Decompresses data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Function} cb Callback\n   * @private\n   */\n  decompress(data, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    perMessageDeflate.decompress(data, this._fin, (err, buf) => {\n      if (err) return cb(err);\n\n      if (buf.length) {\n        this._messageLength += buf.length;\n        if (this._messageLength > this._maxPayload && this._maxPayload > 0) {\n          const error = this.createError(\n            RangeError,\n            'Max payload size exceeded',\n            false,\n            1009,\n            'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._fragments.push(buf);\n      }\n\n      this.dataMessage(cb);\n      if (this._state === GET_INFO) this.startLoop(cb);\n    });\n  }\n\n  /**\n   * Handles a data message.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  dataMessage(cb) {\n    if (!this._fin) {\n      this._state = GET_INFO;\n      return;\n    }\n\n    const messageLength = this._messageLength;\n    const fragments = this._fragments;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragmented = 0;\n    this._fragments = [];\n\n    if (this._opcode === 2) {\n      let data;\n\n      if (this._binaryType === 'nodebuffer') {\n        data = concat(fragments, messageLength);\n      } else if (this._binaryType === 'arraybuffer') {\n        data = toArrayBuffer(concat(fragments, messageLength));\n      } else if (this._binaryType === 'blob') {\n        data = new Blob(fragments);\n      } else {\n        data = fragments;\n      }\n\n      if (this._allowSynchronousEvents) {\n        this.emit('message', data, true);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', data, true);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    } else {\n      const buf = concat(fragments, messageLength);\n\n      if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n        const error = this.createError(\n          Error,\n          'invalid UTF-8 sequence',\n          true,\n          1007,\n          'WS_ERR_INVALID_UTF8'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (this._state === INFLATING || this._allowSynchronousEvents) {\n        this.emit('message', buf, false);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', buf, false);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    }\n  }\n\n  /**\n   * Handles a control message.\n   *\n   * @param {Buffer} data Data to handle\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  controlMessage(data, cb) {\n    if (this._opcode === 0x08) {\n      if (data.length === 0) {\n        this._loop = false;\n        this.emit('conclude', 1005, EMPTY_BUFFER);\n        this.end();\n      } else {\n        const code = data.readUInt16BE(0);\n\n        if (!isValidStatusCode(code)) {\n          const error = this.createError(\n            RangeError,\n            `invalid status code ${code}`,\n            true,\n            1002,\n            'WS_ERR_INVALID_CLOSE_CODE'\n          );\n\n          cb(error);\n          return;\n        }\n\n        const buf = new FastBuffer(\n          data.buffer,\n          data.byteOffset + 2,\n          data.length - 2\n        );\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          const error = this.createError(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._loop = false;\n        this.emit('conclude', code, buf);\n        this.end();\n      }\n\n      this._state = GET_INFO;\n      return;\n    }\n\n    if (this._allowSynchronousEvents) {\n      this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n      this._state = GET_INFO;\n    } else {\n      this._state = DEFER_EVENT;\n      setImmediate(() => {\n        this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n        this._state = GET_INFO;\n        this.startLoop(cb);\n      });\n    }\n  }\n\n  /**\n   * Builds an error object.\n   *\n   * @param {function(new:Error|RangeError)} ErrorCtor The error constructor\n   * @param {String} message The error message\n   * @param {Boolean} prefix Specifies whether or not to add a default prefix to\n   *     `message`\n   * @param {Number} statusCode The status code\n   * @param {String} errorCode The exposed error code\n   * @return {(Error|RangeError)} The error\n   * @private\n   */\n  createError(ErrorCtor, message, prefix, statusCode, errorCode) {\n    this._loop = false;\n    this._errored = true;\n\n    const err = new ErrorCtor(\n      prefix ? `Invalid WebSocket frame: ${message}` : message\n    );\n\n    Error.captureStackTrace(err, this.createError);\n    err.code = errorCode;\n    err[kStatusCode] = statusCode;\n    return err;\n  }\n}\n\nmodule.exports = Receiver;\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex\" }] */\n\n'use strict';\n\nconst { Duplex } = require('stream');\nconst { randomFillSync } = require('crypto');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst { EMPTY_BUFFER, kWebSocket, NOOP } = require('./constants');\nconst { isBlob, isValidStatusCode } = require('./validation');\nconst { mask: applyMask, toBuffer } = require('./buffer-util');\n\nconst kByteLength = Symbol('kByteLength');\nconst maskBuffer = Buffer.alloc(4);\nconst RANDOM_POOL_SIZE = 8 * 1024;\nlet randomPool;\nlet randomPoolPointer = RANDOM_POOL_SIZE;\n\nconst DEFAULT = 0;\nconst DEFLATING = 1;\nconst GET_BLOB_DATA = 2;\n\n/**\n * HyBi Sender implementation.\n */\nclass Sender {\n  /**\n   * Creates a Sender instance.\n   *\n   * @param {Duplex} socket The connection socket\n   * @param {Object} [extensions] An object containing the negotiated extensions\n   * @param {Function} [generateMask] The function used to generate the masking\n   *     key\n   */\n  constructor(socket, extensions, generateMask) {\n    this._extensions = extensions || {};\n\n    if (generateMask) {\n      this._generateMask = generateMask;\n      this._maskBuffer = Buffer.alloc(4);\n    }\n\n    this._socket = socket;\n\n    this._firstFragment = true;\n    this._compress = false;\n\n    this._bufferedBytes = 0;\n    this._queue = [];\n    this._state = DEFAULT;\n    this.onerror = NOOP;\n    this[kWebSocket] = undefined;\n  }\n\n  /**\n   * Frames a piece of data according to the HyBi WebSocket protocol.\n   *\n   * @param {(Buffer|String)} data The data to frame\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @return {(Buffer|String)[]} The framed data\n   * @public\n   */\n  static frame(data, options) {\n    let mask;\n    let merge = false;\n    let offset = 2;\n    let skipMasking = false;\n\n    if (options.mask) {\n      mask = options.maskBuffer || maskBuffer;\n\n      if (options.generateMask) {\n        options.generateMask(mask);\n      } else {\n        if (randomPoolPointer === RANDOM_POOL_SIZE) {\n          /* istanbul ignore else  */\n          if (randomPool === undefined) {\n            //\n            // This is lazily initialized because server-sent frames must not\n            // be masked so it may never be used.\n            //\n            randomPool = Buffer.alloc(RANDOM_POOL_SIZE);\n          }\n\n          randomFillSync(randomPool, 0, RANDOM_POOL_SIZE);\n          randomPoolPointer = 0;\n        }\n\n        mask[0] = randomPool[randomPoolPointer++];\n        mask[1] = randomPool[randomPoolPointer++];\n        mask[2] = randomPool[randomPoolPointer++];\n        mask[3] = randomPool[randomPoolPointer++];\n      }\n\n      skipMasking = (mask[0] | mask[1] | mask[2] | mask[3]) === 0;\n      offset = 6;\n    }\n\n    let dataLength;\n\n    if (typeof data === 'string') {\n      if (\n        (!options.mask || skipMasking) &&\n        options[kByteLength] !== undefined\n      ) {\n        dataLength = options[kByteLength];\n      } else {\n        data = Buffer.from(data);\n        dataLength = data.length;\n      }\n    } else {\n      dataLength = data.length;\n      merge = options.mask && options.readOnly && !skipMasking;\n    }\n\n    let payloadLength = dataLength;\n\n    if (dataLength >= 65536) {\n      offset += 8;\n      payloadLength = 127;\n    } else if (dataLength > 125) {\n      offset += 2;\n      payloadLength = 126;\n    }\n\n    const target = Buffer.allocUnsafe(merge ? dataLength + offset : offset);\n\n    target[0] = options.fin ? options.opcode | 0x80 : options.opcode;\n    if (options.rsv1) target[0] |= 0x40;\n\n    target[1] = payloadLength;\n\n    if (payloadLength === 126) {\n      target.writeUInt16BE(dataLength, 2);\n    } else if (payloadLength === 127) {\n      target[2] = target[3] = 0;\n      target.writeUIntBE(dataLength, 4, 6);\n    }\n\n    if (!options.mask) return [target, data];\n\n    target[1] |= 0x80;\n    target[offset - 4] = mask[0];\n    target[offset - 3] = mask[1];\n    target[offset - 2] = mask[2];\n    target[offset - 1] = mask[3];\n\n    if (skipMasking) return [target, data];\n\n    if (merge) {\n      applyMask(data, mask, target, offset, dataLength);\n      return [target];\n    }\n\n    applyMask(data, mask, data, 0, dataLength);\n    return [target, data];\n  }\n\n  /**\n   * Sends a close message to the other peer.\n   *\n   * @param {Number} [code] The status code component of the body\n   * @param {(String|Buffer)} [data] The message component of the body\n   * @param {Boolean} [mask=false] Specifies whether or not to mask the message\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  close(code, data, mask, cb) {\n    let buf;\n\n    if (code === undefined) {\n      buf = EMPTY_BUFFER;\n    } else if (typeof code !== 'number' || !isValidStatusCode(code)) {\n      throw new TypeError('First argument must be a valid error code number');\n    } else if (data === undefined || !data.length) {\n      buf = Buffer.allocUnsafe(2);\n      buf.writeUInt16BE(code, 0);\n    } else {\n      const length = Buffer.byteLength(data);\n\n      if (length > 123) {\n        throw new RangeError('The message must not be greater than 123 bytes');\n      }\n\n      buf = Buffer.allocUnsafe(2 + length);\n      buf.writeUInt16BE(code, 0);\n\n      if (typeof data === 'string') {\n        buf.write(data, 2);\n      } else {\n        buf.set(data, 2);\n      }\n    }\n\n    const options = {\n      [kByteLength]: buf.length,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x08,\n      readOnly: false,\n      rsv1: false\n    };\n\n    if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, buf, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(buf, options), cb);\n    }\n  }\n\n  /**\n   * Sends a ping message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  ping(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x09,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a pong message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  pong(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x0a,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a data message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Object} options Options object\n   * @param {Boolean} [options.binary=false] Specifies whether `data` is binary\n   *     or text\n   * @param {Boolean} [options.compress=false] Specifies whether or not to\n   *     compress `data`\n   * @param {Boolean} [options.fin=false] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  send(data, options, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n    let opcode = options.binary ? 2 : 1;\n    let rsv1 = options.compress;\n\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (this._firstFragment) {\n      this._firstFragment = false;\n      if (\n        rsv1 &&\n        perMessageDeflate &&\n        perMessageDeflate.params[\n          perMessageDeflate._isServer\n            ? 'server_no_context_takeover'\n            : 'client_no_context_takeover'\n        ]\n      ) {\n        rsv1 = byteLength >= perMessageDeflate._threshold;\n      }\n      this._compress = rsv1;\n    } else {\n      rsv1 = false;\n      opcode = 0;\n    }\n\n    if (options.fin) this._firstFragment = true;\n\n    const opts = {\n      [kByteLength]: byteLength,\n      fin: options.fin,\n      generateMask: this._generateMask,\n      mask: options.mask,\n      maskBuffer: this._maskBuffer,\n      opcode,\n      readOnly,\n      rsv1\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, this._compress, opts, cb]);\n      } else {\n        this.getBlobData(data, this._compress, opts, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, this._compress, opts, cb]);\n    } else {\n      this.dispatch(data, this._compress, opts, cb);\n    }\n  }\n\n  /**\n   * Gets the contents of a blob as binary data.\n   *\n   * @param {Blob} blob The blob\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     the data\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  getBlobData(blob, compress, options, cb) {\n    this._bufferedBytes += options[kByteLength];\n    this._state = GET_BLOB_DATA;\n\n    blob\n      .arrayBuffer()\n      .then((arrayBuffer) => {\n        if (this._socket.destroyed) {\n          const err = new Error(\n            'The socket was closed while the blob was being read'\n          );\n\n          //\n          // `callCallbacks` is called in the next tick to ensure that errors\n          // that might be thrown in the callbacks behave like errors thrown\n          // outside the promise chain.\n          //\n          process.nextTick(callCallbacks, this, err, cb);\n          return;\n        }\n\n        this._bufferedBytes -= options[kByteLength];\n        const data = toBuffer(arrayBuffer);\n\n        if (!compress) {\n          this._state = DEFAULT;\n          this.sendFrame(Sender.frame(data, options), cb);\n          this.dequeue();\n        } else {\n          this.dispatch(data, compress, options, cb);\n        }\n      })\n      .catch((err) => {\n        //\n        // `onError` is called in the next tick for the same reason that\n        // `callCallbacks` above is.\n        //\n        process.nextTick(onError, this, err, cb);\n      });\n  }\n\n  /**\n   * Dispatches a message.\n   *\n   * @param {(Buffer|String)} data The message to send\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     `data`\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  dispatch(data, compress, options, cb) {\n    if (!compress) {\n      this.sendFrame(Sender.frame(data, options), cb);\n      return;\n    }\n\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    this._bufferedBytes += options[kByteLength];\n    this._state = DEFLATING;\n    perMessageDeflate.compress(data, options.fin, (_, buf) => {\n      if (this._socket.destroyed) {\n        const err = new Error(\n          'The socket was closed while data was being compressed'\n        );\n\n        callCallbacks(this, err, cb);\n        return;\n      }\n\n      this._bufferedBytes -= options[kByteLength];\n      this._state = DEFAULT;\n      options.readOnly = false;\n      this.sendFrame(Sender.frame(buf, options), cb);\n      this.dequeue();\n    });\n  }\n\n  /**\n   * Executes queued send operations.\n   *\n   * @private\n   */\n  dequeue() {\n    while (this._state === DEFAULT && this._queue.length) {\n      const params = this._queue.shift();\n\n      this._bufferedBytes -= params[3][kByteLength];\n      Reflect.apply(params[0], this, params.slice(1));\n    }\n  }\n\n  /**\n   * Enqueues a send operation.\n   *\n   * @param {Array} params Send operation parameters.\n   * @private\n   */\n  enqueue(params) {\n    this._bufferedBytes += params[3][kByteLength];\n    this._queue.push(params);\n  }\n\n  /**\n   * Sends a frame.\n   *\n   * @param {(Buffer | String)[]} list The frame to send\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  sendFrame(list, cb) {\n    if (list.length === 2) {\n      this._socket.cork();\n      this._socket.write(list[0]);\n      this._socket.write(list[1], cb);\n      this._socket.uncork();\n    } else {\n      this._socket.write(list[0], cb);\n    }\n  }\n}\n\nmodule.exports = Sender;\n\n/**\n * Calls queued callbacks with an error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error to call the callbacks with\n * @param {Function} [cb] The first callback\n * @private\n */\nfunction callCallbacks(sender, err, cb) {\n  if (typeof cb === 'function') cb(err);\n\n  for (let i = 0; i < sender._queue.length; i++) {\n    const params = sender._queue[i];\n    const callback = params[params.length - 1];\n\n    if (typeof callback === 'function') callback(err);\n  }\n}\n\n/**\n * Handles a `Sender` error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error\n * @param {Function} [cb] The first pending callback\n * @private\n */\nfunction onError(sender, err, cb) {\n  callCallbacks(sender, err, cb);\n  sender.onerror(err);\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^WebSocket$\" }] */\n'use strict';\n\nconst WebSocket = require('./websocket');\nconst { Duplex } = require('stream');\n\n/**\n * Emits the `'close'` event on a stream.\n *\n * @param {Duplex} stream The stream.\n * @private\n */\nfunction emitClose(stream) {\n  stream.emit('close');\n}\n\n/**\n * The listener of the `'end'` event.\n *\n * @private\n */\nfunction duplexOnEnd() {\n  if (!this.destroyed && this._writableState.finished) {\n    this.destroy();\n  }\n}\n\n/**\n * The listener of the `'error'` event.\n *\n * @param {Error} err The error\n * @private\n */\nfunction duplexOnError(err) {\n  this.removeListener('error', duplexOnError);\n  this.destroy();\n  if (this.listenerCount('error') === 0) {\n    // Do not suppress the throwing behavior.\n    this.emit('error', err);\n  }\n}\n\n/**\n * Wraps a `WebSocket` in a duplex stream.\n *\n * @param {WebSocket} ws The `WebSocket` to wrap\n * @param {Object} [options] The options for the `Duplex` constructor\n * @return {Duplex} The duplex stream\n * @public\n */\nfunction createWebSocketStream(ws, options) {\n  let terminateOnDestroy = true;\n\n  const duplex = new Duplex({\n    ...options,\n    autoDestroy: false,\n    emitClose: false,\n    objectMode: false,\n    writableObjectMode: false\n  });\n\n  ws.on('message', function message(msg, isBinary) {\n    const data =\n      !isBinary && duplex._readableState.objectMode ? msg.toString() : msg;\n\n    if (!duplex.push(data)) ws.pause();\n  });\n\n  ws.once('error', function error(err) {\n    if (duplex.destroyed) return;\n\n    // Prevent `ws.terminate()` from being called by `duplex._destroy()`.\n    //\n    // - If the `'error'` event is emitted before the `'open'` event, then\n    //   `ws.terminate()` is a noop as no socket is assigned.\n    // - Otherwise, the error is re-emitted by the listener of the `'error'`\n    //   event of the `Receiver` object. The listener already closes the\n    //   connection by calling `ws.close()`. This allows a close frame to be\n    //   sent to the other peer. If `ws.terminate()` is called right after this,\n    //   then the close frame might not be sent.\n    terminateOnDestroy = false;\n    duplex.destroy(err);\n  });\n\n  ws.once('close', function close() {\n    if (duplex.destroyed) return;\n\n    duplex.push(null);\n  });\n\n  duplex._destroy = function (err, callback) {\n    if (ws.readyState === ws.CLOSED) {\n      callback(err);\n      process.nextTick(emitClose, duplex);\n      return;\n    }\n\n    let called = false;\n\n    ws.once('error', function error(err) {\n      called = true;\n      callback(err);\n    });\n\n    ws.once('close', function close() {\n      if (!called) callback(err);\n      process.nextTick(emitClose, duplex);\n    });\n\n    if (terminateOnDestroy) ws.terminate();\n  };\n\n  duplex._final = function (callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._final(callback);\n      });\n      return;\n    }\n\n    // If the value of the `_socket` property is `null` it means that `ws` is a\n    // client websocket and the handshake failed. In fact, when this happens, a\n    // socket is never assigned to the websocket. Wait for the `'error'` event\n    // that will be emitted by the websocket.\n    if (ws._socket === null) return;\n\n    if (ws._socket._writableState.finished) {\n      callback();\n      if (duplex._readableState.endEmitted) duplex.destroy();\n    } else {\n      ws._socket.once('finish', function finish() {\n        // `duplex` is not destroyed here because the `'end'` event will be\n        // emitted on `duplex` after this `'finish'` event. The EOF signaling\n        // `null` chunk is, in fact, pushed when the websocket emits `'close'`.\n        callback();\n      });\n      ws.close();\n    }\n  };\n\n  duplex._read = function () {\n    if (ws.isPaused) ws.resume();\n  };\n\n  duplex._write = function (chunk, encoding, callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._write(chunk, encoding, callback);\n      });\n      return;\n    }\n\n    ws.send(chunk, callback);\n  };\n\n  duplex.on('end', duplexOnEnd);\n  duplex.on('error', duplexOnError);\n  return duplex;\n}\n\nmodule.exports = createWebSocketStream;\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n *\n * @param {String} header The field value of the header\n * @return {Set} The subprotocol names\n * @public\n */\nfunction parse(header) {\n  const protocols = new Set();\n  let start = -1;\n  let end = -1;\n  let i = 0;\n\n  for (i; i < header.length; i++) {\n    const code = header.charCodeAt(i);\n\n    if (end === -1 && tokenChars[code] === 1) {\n      if (start === -1) start = i;\n    } else if (\n      i !== 0 &&\n      (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n    ) {\n      if (end === -1 && start !== -1) end = i;\n    } else if (code === 0x2c /* ',' */) {\n      if (start === -1) {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n\n      if (end === -1) end = i;\n\n      const protocol = header.slice(start, end);\n\n      if (protocols.has(protocol)) {\n        throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n      }\n\n      protocols.add(protocol);\n      start = end = -1;\n    } else {\n      throw new SyntaxError(`Unexpected character at index ${i}`);\n    }\n  }\n\n  if (start === -1 || end !== -1) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  const protocol = header.slice(start, i);\n\n  if (protocols.has(protocol)) {\n    throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n  }\n\n  protocols.add(protocol);\n  return protocols;\n}\n\nmodule.exports = { parse };\n","'use strict';\n\nconst { isUtf8 } = require('buffer');\n\nconst { hasBlob } = require('./constants');\n\n//\n// Allowed token characters:\n//\n// '!', '#', '$', '%', '&', ''', '*', '+', '-',\n// '.', 0-9, A-Z, '^', '_', '`', a-z, '|', '~'\n//\n// tokenChars[32] === 0 // ' '\n// tokenChars[33] === 1 // '!'\n// tokenChars[34] === 0 // '\"'\n// ...\n//\n// prettier-ignore\nconst tokenChars = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0 - 15\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 16 - 31\n  0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, // 32 - 47\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, // 48 - 63\n  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 64 - 79\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, // 80 - 95\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 96 - 111\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0 // 112 - 127\n];\n\n/**\n * Checks if a status code is allowed in a close frame.\n *\n * @param {Number} code The status code\n * @return {Boolean} `true` if the status code is valid, else `false`\n * @public\n */\nfunction isValidStatusCode(code) {\n  return (\n    (code >= 1000 &&\n      code <= 1014 &&\n      code !== 1004 &&\n      code !== 1005 &&\n      code !== 1006) ||\n    (code >= 3000 && code <= 4999)\n  );\n}\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction _isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0) {\n      // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {\n      // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0 // Overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {\n      // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80) || // Overlong\n        (buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0) // Surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {\n      // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80) || // Overlong\n        (buf[i] === 0xf4 && buf[i + 1] > 0x8f) ||\n        buf[i] > 0xf4 // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Determines whether a value is a `Blob`.\n *\n * @param {*} value The value to be tested\n * @return {Boolean} `true` if `value` is a `Blob`, else `false`\n * @private\n */\nfunction isBlob(value) {\n  return (\n    hasBlob &&\n    typeof value === 'object' &&\n    typeof value.arrayBuffer === 'function' &&\n    typeof value.type === 'string' &&\n    typeof value.stream === 'function' &&\n    (value[Symbol.toStringTag] === 'Blob' ||\n      value[Symbol.toStringTag] === 'File')\n  );\n}\n\nmodule.exports = {\n  isBlob,\n  isValidStatusCode,\n  isValidUTF8: _isValidUTF8,\n  tokenChars\n};\n\nif (isUtf8) {\n  module.exports.isValidUTF8 = function (buf) {\n    return buf.length < 24 ? _isValidUTF8(buf) : isUtf8(buf);\n  };\n} /* istanbul ignore else  */ else if (!process.env.WS_NO_UTF_8_VALIDATE) {\n  try {\n    const isValidUTF8 = require('utf-8-validate');\n\n    module.exports.isValidUTF8 = function (buf) {\n      return buf.length < 32 ? _isValidUTF8(buf) : isValidUTF8(buf);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst http = require('http');\nconst { Duplex } = require('stream');\nconst { createHash } = require('crypto');\n\nconst extension = require('./extension');\nconst PerMessageDeflate = require('./permessage-deflate');\nconst subprotocol = require('./subprotocol');\nconst WebSocket = require('./websocket');\nconst { GUID, kWebSocket } = require('./constants');\n\nconst keyRegex = /^[+/0-9A-Za-z]{22}==$/;\n\nconst RUNNING = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\n/**\n * Class representing a WebSocket server.\n *\n * @extends EventEmitter\n */\nclass WebSocketServer extends EventEmitter {\n  /**\n   * Create a `WebSocketServer` instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n   *     automatically send a pong in response to a ping\n   * @param {Number} [options.backlog=511] The maximum length of the queue of\n   *     pending connections\n   * @param {Boolean} [options.clientTracking=true] Specifies whether or not to\n   *     track clients\n   * @param {Function} [options.handleProtocols] A hook to handle protocols\n   * @param {String} [options.host] The hostname where to bind the server\n   * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n   *     size\n   * @param {Boolean} [options.noServer=false] Enable no server mode\n   * @param {String} [options.path] Accept only connections matching this path\n   * @param {(Boolean|Object)} [options.perMessageDeflate=false] Enable/disable\n   *     permessage-deflate\n   * @param {Number} [options.port] The port where to bind the server\n   * @param {(http.Server|https.Server)} [options.server] A pre-created HTTP/S\n   *     server to use\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @param {Function} [options.verifyClient] A hook to reject connections\n   * @param {Function} [options.WebSocket=WebSocket] Specifies the `WebSocket`\n   *     class to use. It must be the `WebSocket` class or class that extends it\n   * @param {Function} [callback] A listener for the `listening` event\n   */\n  constructor(options, callback) {\n    super();\n\n    options = {\n      allowSynchronousEvents: true,\n      autoPong: true,\n      maxPayload: 100 * 1024 * 1024,\n      skipUTF8Validation: false,\n      perMessageDeflate: false,\n      handleProtocols: null,\n      clientTracking: true,\n      verifyClient: null,\n      noServer: false,\n      backlog: null, // use default (511 as implemented in net.js)\n      server: null,\n      host: null,\n      path: null,\n      port: null,\n      WebSocket,\n      ...options\n    };\n\n    if (\n      (options.port == null && !options.server && !options.noServer) ||\n      (options.port != null && (options.server || options.noServer)) ||\n      (options.server && options.noServer)\n    ) {\n      throw new TypeError(\n        'One and only one of the \"port\", \"server\", or \"noServer\" options ' +\n          'must be specified'\n      );\n    }\n\n    if (options.port != null) {\n      this._server = http.createServer((req, res) => {\n        const body = http.STATUS_CODES[426];\n\n        res.writeHead(426, {\n          'Content-Length': body.length,\n          'Content-Type': 'text/plain'\n        });\n        res.end(body);\n      });\n      this._server.listen(\n        options.port,\n        options.host,\n        options.backlog,\n        callback\n      );\n    } else if (options.server) {\n      this._server = options.server;\n    }\n\n    if (this._server) {\n      const emitConnection = this.emit.bind(this, 'connection');\n\n      this._removeListeners = addListeners(this._server, {\n        listening: this.emit.bind(this, 'listening'),\n        error: this.emit.bind(this, 'error'),\n        upgrade: (req, socket, head) => {\n          this.handleUpgrade(req, socket, head, emitConnection);\n        }\n      });\n    }\n\n    if (options.perMessageDeflate === true) options.perMessageDeflate = {};\n    if (options.clientTracking) {\n      this.clients = new Set();\n      this._shouldEmitClose = false;\n    }\n\n    this.options = options;\n    this._state = RUNNING;\n  }\n\n  /**\n   * Returns the bound address, the address family name, and port of the server\n   * as reported by the operating system if listening on an IP socket.\n   * If the server is listening on a pipe or UNIX domain socket, the name is\n   * returned as a string.\n   *\n   * @return {(Object|String|null)} The address of the server\n   * @public\n   */\n  address() {\n    if (this.options.noServer) {\n      throw new Error('The server is operating in \"noServer\" mode');\n    }\n\n    if (!this._server) return null;\n    return this._server.address();\n  }\n\n  /**\n   * Stop the server from accepting new connections and emit the `'close'` event\n   * when all existing connections are closed.\n   *\n   * @param {Function} [cb] A one-time listener for the `'close'` event\n   * @public\n   */\n  close(cb) {\n    if (this._state === CLOSED) {\n      if (cb) {\n        this.once('close', () => {\n          cb(new Error('The server is not running'));\n        });\n      }\n\n      process.nextTick(emitClose, this);\n      return;\n    }\n\n    if (cb) this.once('close', cb);\n\n    if (this._state === CLOSING) return;\n    this._state = CLOSING;\n\n    if (this.options.noServer || this.options.server) {\n      if (this._server) {\n        this._removeListeners();\n        this._removeListeners = this._server = null;\n      }\n\n      if (this.clients) {\n        if (!this.clients.size) {\n          process.nextTick(emitClose, this);\n        } else {\n          this._shouldEmitClose = true;\n        }\n      } else {\n        process.nextTick(emitClose, this);\n      }\n    } else {\n      const server = this._server;\n\n      this._removeListeners();\n      this._removeListeners = this._server = null;\n\n      //\n      // The HTTP/S server was created internally. Close it, and rely on its\n      // `'close'` event.\n      //\n      server.close(() => {\n        emitClose(this);\n      });\n    }\n  }\n\n  /**\n   * See if a given request should be handled by this server instance.\n   *\n   * @param {http.IncomingMessage} req Request object to inspect\n   * @return {Boolean} `true` if the request is valid, else `false`\n   * @public\n   */\n  shouldHandle(req) {\n    if (this.options.path) {\n      const index = req.url.indexOf('?');\n      const pathname = index !== -1 ? req.url.slice(0, index) : req.url;\n\n      if (pathname !== this.options.path) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Handle a HTTP Upgrade request.\n   *\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @public\n   */\n  handleUpgrade(req, socket, head, cb) {\n    socket.on('error', socketOnError);\n\n    const key = req.headers['sec-websocket-key'];\n    const upgrade = req.headers.upgrade;\n    const version = +req.headers['sec-websocket-version'];\n\n    if (req.method !== 'GET') {\n      const message = 'Invalid HTTP method';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 405, message);\n      return;\n    }\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      const message = 'Invalid Upgrade header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (key === undefined || !keyRegex.test(key)) {\n      const message = 'Missing or invalid Sec-WebSocket-Key header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (version !== 13 && version !== 8) {\n      const message = 'Missing or invalid Sec-WebSocket-Version header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message, {\n        'Sec-WebSocket-Version': '13, 8'\n      });\n      return;\n    }\n\n    if (!this.shouldHandle(req)) {\n      abortHandshake(socket, 400);\n      return;\n    }\n\n    const secWebSocketProtocol = req.headers['sec-websocket-protocol'];\n    let protocols = new Set();\n\n    if (secWebSocketProtocol !== undefined) {\n      try {\n        protocols = subprotocol.parse(secWebSocketProtocol);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Protocol header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    const secWebSocketExtensions = req.headers['sec-websocket-extensions'];\n    const extensions = {};\n\n    if (\n      this.options.perMessageDeflate &&\n      secWebSocketExtensions !== undefined\n    ) {\n      const perMessageDeflate = new PerMessageDeflate(\n        this.options.perMessageDeflate,\n        true,\n        this.options.maxPayload\n      );\n\n      try {\n        const offers = extension.parse(secWebSocketExtensions);\n\n        if (offers[PerMessageDeflate.extensionName]) {\n          perMessageDeflate.accept(offers[PerMessageDeflate.extensionName]);\n          extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n        }\n      } catch (err) {\n        const message =\n          'Invalid or unacceptable Sec-WebSocket-Extensions header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    //\n    // Optionally call external client verification handler.\n    //\n    if (this.options.verifyClient) {\n      const info = {\n        origin:\n          req.headers[`${version === 8 ? 'sec-websocket-origin' : 'origin'}`],\n        secure: !!(req.socket.authorized || req.socket.encrypted),\n        req\n      };\n\n      if (this.options.verifyClient.length === 2) {\n        this.options.verifyClient(info, (verified, code, message, headers) => {\n          if (!verified) {\n            return abortHandshake(socket, code || 401, message, headers);\n          }\n\n          this.completeUpgrade(\n            extensions,\n            key,\n            protocols,\n            req,\n            socket,\n            head,\n            cb\n          );\n        });\n        return;\n      }\n\n      if (!this.options.verifyClient(info)) return abortHandshake(socket, 401);\n    }\n\n    this.completeUpgrade(extensions, key, protocols, req, socket, head, cb);\n  }\n\n  /**\n   * Upgrade the connection to WebSocket.\n   *\n   * @param {Object} extensions The accepted extensions\n   * @param {String} key The value of the `Sec-WebSocket-Key` header\n   * @param {Set} protocols The subprotocols\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @throws {Error} If called more than once with the same socket\n   * @private\n   */\n  completeUpgrade(extensions, key, protocols, req, socket, head, cb) {\n    //\n    // Destroy the socket if the client has already sent a FIN packet.\n    //\n    if (!socket.readable || !socket.writable) return socket.destroy();\n\n    if (socket[kWebSocket]) {\n      throw new Error(\n        'server.handleUpgrade() was called more than once with the same ' +\n          'socket, possibly due to a misconfiguration'\n      );\n    }\n\n    if (this._state > RUNNING) return abortHandshake(socket, 503);\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    const headers = [\n      'HTTP/1.1 101 Switching Protocols',\n      'Upgrade: websocket',\n      'Connection: Upgrade',\n      `Sec-WebSocket-Accept: ${digest}`\n    ];\n\n    const ws = new this.options.WebSocket(null, undefined, this.options);\n\n    if (protocols.size) {\n      //\n      // Optionally call external protocol selection handler.\n      //\n      const protocol = this.options.handleProtocols\n        ? this.options.handleProtocols(protocols, req)\n        : protocols.values().next().value;\n\n      if (protocol) {\n        headers.push(`Sec-WebSocket-Protocol: ${protocol}`);\n        ws._protocol = protocol;\n      }\n    }\n\n    if (extensions[PerMessageDeflate.extensionName]) {\n      const params = extensions[PerMessageDeflate.extensionName].params;\n      const value = extension.format({\n        [PerMessageDeflate.extensionName]: [params]\n      });\n      headers.push(`Sec-WebSocket-Extensions: ${value}`);\n      ws._extensions = extensions;\n    }\n\n    //\n    // Allow external modification/inspection of handshake headers.\n    //\n    this.emit('headers', headers, req);\n\n    socket.write(headers.concat('\\r\\n').join('\\r\\n'));\n    socket.removeListener('error', socketOnError);\n\n    ws.setSocket(socket, head, {\n      allowSynchronousEvents: this.options.allowSynchronousEvents,\n      maxPayload: this.options.maxPayload,\n      skipUTF8Validation: this.options.skipUTF8Validation\n    });\n\n    if (this.clients) {\n      this.clients.add(ws);\n      ws.on('close', () => {\n        this.clients.delete(ws);\n\n        if (this._shouldEmitClose && !this.clients.size) {\n          process.nextTick(emitClose, this);\n        }\n      });\n    }\n\n    cb(ws, req);\n  }\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Add event listeners on an `EventEmitter` using a map of <event, listener>\n * pairs.\n *\n * @param {EventEmitter} server The event emitter\n * @param {Object.<String, Function>} map The listeners to add\n * @return {Function} A function that will remove the added listeners when\n *     called\n * @private\n */\nfunction addListeners(server, map) {\n  for (const event of Object.keys(map)) server.on(event, map[event]);\n\n  return function removeListeners() {\n    for (const event of Object.keys(map)) {\n      server.removeListener(event, map[event]);\n    }\n  };\n}\n\n/**\n * Emit a `'close'` event on an `EventEmitter`.\n *\n * @param {EventEmitter} server The event emitter\n * @private\n */\nfunction emitClose(server) {\n  server._state = CLOSED;\n  server.emit('close');\n}\n\n/**\n * Handle socket errors.\n *\n * @private\n */\nfunction socketOnError() {\n  this.destroy();\n}\n\n/**\n * Close the connection when preconditions are not fulfilled.\n *\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} [message] The HTTP response body\n * @param {Object} [headers] Additional HTTP response headers\n * @private\n */\nfunction abortHandshake(socket, code, message, headers) {\n  //\n  // The socket is writable unless the user destroyed or ended it before calling\n  // `server.handleUpgrade()` or in the `verifyClient` function, which is a user\n  // error. Handling this does not make much sense as the worst that can happen\n  // is that some of the data written by the user might be discarded due to the\n  // call to `socket.end()` below, which triggers an `'error'` event that in\n  // turn causes the socket to be destroyed.\n  //\n  message = message || http.STATUS_CODES[code];\n  headers = {\n    Connection: 'close',\n    'Content-Type': 'text/html',\n    'Content-Length': Buffer.byteLength(message),\n    ...headers\n  };\n\n  socket.once('finish', socket.destroy);\n\n  socket.end(\n    `HTTP/1.1 ${code} ${http.STATUS_CODES[code]}\\r\\n` +\n      Object.keys(headers)\n        .map((h) => `${h}: ${headers[h]}`)\n        .join('\\r\\n') +\n      '\\r\\n\\r\\n' +\n      message\n  );\n}\n\n/**\n * Emit a `'wsClientError'` event on a `WebSocketServer` if there is at least\n * one listener for it, otherwise call `abortHandshake()`.\n *\n * @param {WebSocketServer} server The WebSocket server\n * @param {http.IncomingMessage} req The request object\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} message The HTTP response body\n * @param {Object} [headers] The HTTP response headers\n * @private\n */\nfunction abortHandshakeOrEmitwsClientError(\n  server,\n  req,\n  socket,\n  code,\n  message,\n  headers\n) {\n  if (server.listenerCount('wsClientError')) {\n    const err = new Error(message);\n    Error.captureStackTrace(err, abortHandshakeOrEmitwsClientError);\n\n    server.emit('wsClientError', err, socket, req);\n  } else {\n    abortHandshake(socket, code, message, headers);\n  }\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex|Readable$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst https = require('https');\nconst http = require('http');\nconst net = require('net');\nconst tls = require('tls');\nconst { randomBytes, createHash } = require('crypto');\nconst { Duplex, Readable } = require('stream');\nconst { URL } = require('url');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst Receiver = require('./receiver');\nconst Sender = require('./sender');\nconst { isBlob } = require('./validation');\n\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  GUID,\n  kForOnEventAttribute,\n  kListener,\n  kStatusCode,\n  kWebSocket,\n  NOOP\n} = require('./constants');\nconst {\n  EventTarget: { addEventListener, removeEventListener }\n} = require('./event-target');\nconst { format, parse } = require('./extension');\nconst { toBuffer } = require('./buffer-util');\n\nconst closeTimeout = 30 * 1000;\nconst kAborted = Symbol('kAborted');\nconst protocolVersions = [8, 13];\nconst readyStates = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'];\nconst subprotocolRegex = /^[!#$%&'*+\\-.0-9A-Z^_`|a-z~]+$/;\n\n/**\n * Class representing a WebSocket.\n *\n * @extends EventEmitter\n */\nclass WebSocket extends EventEmitter {\n  /**\n   * Create a new `WebSocket`.\n   *\n   * @param {(String|URL)} address The URL to which to connect\n   * @param {(String|String[])} [protocols] The subprotocols\n   * @param {Object} [options] Connection options\n   */\n  constructor(address, protocols, options) {\n    super();\n\n    this._binaryType = BINARY_TYPES[0];\n    this._closeCode = 1006;\n    this._closeFrameReceived = false;\n    this._closeFrameSent = false;\n    this._closeMessage = EMPTY_BUFFER;\n    this._closeTimer = null;\n    this._errorEmitted = false;\n    this._extensions = {};\n    this._paused = false;\n    this._protocol = '';\n    this._readyState = WebSocket.CONNECTING;\n    this._receiver = null;\n    this._sender = null;\n    this._socket = null;\n\n    if (address !== null) {\n      this._bufferedAmount = 0;\n      this._isServer = false;\n      this._redirects = 0;\n\n      if (protocols === undefined) {\n        protocols = [];\n      } else if (!Array.isArray(protocols)) {\n        if (typeof protocols === 'object' && protocols !== null) {\n          options = protocols;\n          protocols = [];\n        } else {\n          protocols = [protocols];\n        }\n      }\n\n      initAsClient(this, address, protocols, options);\n    } else {\n      this._autoPong = options.autoPong;\n      this._isServer = true;\n    }\n  }\n\n  /**\n   * For historical reasons, the custom \"nodebuffer\" type is used by the default\n   * instead of \"blob\".\n   *\n   * @type {String}\n   */\n  get binaryType() {\n    return this._binaryType;\n  }\n\n  set binaryType(type) {\n    if (!BINARY_TYPES.includes(type)) return;\n\n    this._binaryType = type;\n\n    //\n    // Allow to change `binaryType` on the fly.\n    //\n    if (this._receiver) this._receiver._binaryType = type;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get bufferedAmount() {\n    if (!this._socket) return this._bufferedAmount;\n\n    return this._socket._writableState.length + this._sender._bufferedBytes;\n  }\n\n  /**\n   * @type {String}\n   */\n  get extensions() {\n    return Object.keys(this._extensions).join();\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get isPaused() {\n    return this._paused;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onclose() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onerror() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onopen() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onmessage() {\n    return null;\n  }\n\n  /**\n   * @type {String}\n   */\n  get protocol() {\n    return this._protocol;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get readyState() {\n    return this._readyState;\n  }\n\n  /**\n   * @type {String}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * Set up the socket and the internal resources.\n   *\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Object} options Options object\n   * @param {Boolean} [options.allowSynchronousEvents=false] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Number} [options.maxPayload=0] The maximum allowed message size\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @private\n   */\n  setSocket(socket, head, options) {\n    const receiver = new Receiver({\n      allowSynchronousEvents: options.allowSynchronousEvents,\n      binaryType: this.binaryType,\n      extensions: this._extensions,\n      isServer: this._isServer,\n      maxPayload: options.maxPayload,\n      skipUTF8Validation: options.skipUTF8Validation\n    });\n\n    const sender = new Sender(socket, this._extensions, options.generateMask);\n\n    this._receiver = receiver;\n    this._sender = sender;\n    this._socket = socket;\n\n    receiver[kWebSocket] = this;\n    sender[kWebSocket] = this;\n    socket[kWebSocket] = this;\n\n    receiver.on('conclude', receiverOnConclude);\n    receiver.on('drain', receiverOnDrain);\n    receiver.on('error', receiverOnError);\n    receiver.on('message', receiverOnMessage);\n    receiver.on('ping', receiverOnPing);\n    receiver.on('pong', receiverOnPong);\n\n    sender.onerror = senderOnError;\n\n    //\n    // These methods may not be available if `socket` is just a `Duplex`.\n    //\n    if (socket.setTimeout) socket.setTimeout(0);\n    if (socket.setNoDelay) socket.setNoDelay();\n\n    if (head.length > 0) socket.unshift(head);\n\n    socket.on('close', socketOnClose);\n    socket.on('data', socketOnData);\n    socket.on('end', socketOnEnd);\n    socket.on('error', socketOnError);\n\n    this._readyState = WebSocket.OPEN;\n    this.emit('open');\n  }\n\n  /**\n   * Emit the `'close'` event.\n   *\n   * @private\n   */\n  emitClose() {\n    if (!this._socket) {\n      this._readyState = WebSocket.CLOSED;\n      this.emit('close', this._closeCode, this._closeMessage);\n      return;\n    }\n\n    if (this._extensions[PerMessageDeflate.extensionName]) {\n      this._extensions[PerMessageDeflate.extensionName].cleanup();\n    }\n\n    this._receiver.removeAllListeners();\n    this._readyState = WebSocket.CLOSED;\n    this.emit('close', this._closeCode, this._closeMessage);\n  }\n\n  /**\n   * Start a closing handshake.\n   *\n   *          +----------+   +-----------+   +----------+\n   *     - - -|ws.close()|-->|close frame|-->|ws.close()|- - -\n   *    |     +----------+   +-----------+   +----------+     |\n   *          +----------+   +-----------+         |\n   * CLOSING  |ws.close()|<--|close frame|<--+-----+       CLOSING\n   *          +----------+   +-----------+   |\n   *    |           |                        |   +---+        |\n   *                +------------------------+-->|fin| - - - -\n   *    |         +---+                      |   +---+\n   *     - - - - -|fin|<---------------------+\n   *              +---+\n   *\n   * @param {Number} [code] Status code explaining why the connection is closing\n   * @param {(String|Buffer)} [data] The reason why the connection is\n   *     closing\n   * @public\n   */\n  close(code, data) {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this.readyState === WebSocket.CLOSING) {\n      if (\n        this._closeFrameSent &&\n        (this._closeFrameReceived || this._receiver._writableState.errorEmitted)\n      ) {\n        this._socket.end();\n      }\n\n      return;\n    }\n\n    this._readyState = WebSocket.CLOSING;\n    this._sender.close(code, data, !this._isServer, (err) => {\n      //\n      // This error is handled by the `'error'` listener on the socket. We only\n      // want to know if the close frame has been sent here.\n      //\n      if (err) return;\n\n      this._closeFrameSent = true;\n\n      if (\n        this._closeFrameReceived ||\n        this._receiver._writableState.errorEmitted\n      ) {\n        this._socket.end();\n      }\n    });\n\n    setCloseTimer(this);\n  }\n\n  /**\n   * Pause the socket.\n   *\n   * @public\n   */\n  pause() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = true;\n    this._socket.pause();\n  }\n\n  /**\n   * Send a ping.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the ping is sent\n   * @public\n   */\n  ping(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.ping(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Send a pong.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the pong is sent\n   * @public\n   */\n  pong(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.pong(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Resume the socket.\n   *\n   * @public\n   */\n  resume() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = false;\n    if (!this._receiver._writableState.needDrain) this._socket.resume();\n  }\n\n  /**\n   * Send a data message.\n   *\n   * @param {*} data The message to send\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.binary] Specifies whether `data` is binary or\n   *     text\n   * @param {Boolean} [options.compress] Specifies whether or not to compress\n   *     `data`\n   * @param {Boolean} [options.fin=true] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when data is written out\n   * @public\n   */\n  send(data, options, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = {};\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    const opts = {\n      binary: typeof data !== 'string',\n      mask: !this._isServer,\n      compress: true,\n      fin: true,\n      ...options\n    };\n\n    if (!this._extensions[PerMessageDeflate.extensionName]) {\n      opts.compress = false;\n    }\n\n    this._sender.send(data || EMPTY_BUFFER, opts, cb);\n  }\n\n  /**\n   * Forcibly close the connection.\n   *\n   * @public\n   */\n  terminate() {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this._socket) {\n      this._readyState = WebSocket.CLOSING;\n      this._socket.destroy();\n    }\n  }\n}\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n[\n  'binaryType',\n  'bufferedAmount',\n  'extensions',\n  'isPaused',\n  'protocol',\n  'readyState',\n  'url'\n].forEach((property) => {\n  Object.defineProperty(WebSocket.prototype, property, { enumerable: true });\n});\n\n//\n// Add the `onopen`, `onerror`, `onclose`, and `onmessage` attributes.\n// See https://html.spec.whatwg.org/multipage/comms.html#the-websocket-interface\n//\n['open', 'error', 'close', 'message'].forEach((method) => {\n  Object.defineProperty(WebSocket.prototype, `on${method}`, {\n    enumerable: true,\n    get() {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) return listener[kListener];\n      }\n\n      return null;\n    },\n    set(handler) {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) {\n          this.removeListener(method, listener);\n          break;\n        }\n      }\n\n      if (typeof handler !== 'function') return;\n\n      this.addEventListener(method, handler, {\n        [kForOnEventAttribute]: true\n      });\n    }\n  });\n});\n\nWebSocket.prototype.addEventListener = addEventListener;\nWebSocket.prototype.removeEventListener = removeEventListener;\n\nmodule.exports = WebSocket;\n\n/**\n * Initialize a WebSocket client.\n *\n * @param {WebSocket} websocket The client to initialize\n * @param {(String|URL)} address The URL to which to connect\n * @param {Array} protocols The subprotocols\n * @param {Object} [options] Connection options\n * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether any\n *     of the `'message'`, `'ping'`, and `'pong'` events can be emitted multiple\n *     times in the same tick\n * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n *     automatically send a pong in response to a ping\n * @param {Function} [options.finishRequest] A function which can be used to\n *     customize the headers of each http request before it is sent\n * @param {Boolean} [options.followRedirects=false] Whether or not to follow\n *     redirects\n * @param {Function} [options.generateMask] The function used to generate the\n *     masking key\n * @param {Number} [options.handshakeTimeout] Timeout in milliseconds for the\n *     handshake request\n * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n *     size\n * @param {Number} [options.maxRedirects=10] The maximum number of redirects\n *     allowed\n * @param {String} [options.origin] Value of the `Origin` or\n *     `Sec-WebSocket-Origin` header\n * @param {(Boolean|Object)} [options.perMessageDeflate=true] Enable/disable\n *     permessage-deflate\n * @param {Number} [options.protocolVersion=13] Value of the\n *     `Sec-WebSocket-Version` header\n * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n *     not to skip UTF-8 validation for text and close messages\n * @private\n */\nfunction initAsClient(websocket, address, protocols, options) {\n  const opts = {\n    allowSynchronousEvents: true,\n    autoPong: true,\n    protocolVersion: protocolVersions[1],\n    maxPayload: 100 * 1024 * 1024,\n    skipUTF8Validation: false,\n    perMessageDeflate: true,\n    followRedirects: false,\n    maxRedirects: 10,\n    ...options,\n    socketPath: undefined,\n    hostname: undefined,\n    protocol: undefined,\n    timeout: undefined,\n    method: 'GET',\n    host: undefined,\n    path: undefined,\n    port: undefined\n  };\n\n  websocket._autoPong = opts.autoPong;\n\n  if (!protocolVersions.includes(opts.protocolVersion)) {\n    throw new RangeError(\n      `Unsupported protocol version: ${opts.protocolVersion} ` +\n        `(supported versions: ${protocolVersions.join(', ')})`\n    );\n  }\n\n  let parsedUrl;\n\n  if (address instanceof URL) {\n    parsedUrl = address;\n  } else {\n    try {\n      parsedUrl = new URL(address);\n    } catch (e) {\n      throw new SyntaxError(`Invalid URL: ${address}`);\n    }\n  }\n\n  if (parsedUrl.protocol === 'http:') {\n    parsedUrl.protocol = 'ws:';\n  } else if (parsedUrl.protocol === 'https:') {\n    parsedUrl.protocol = 'wss:';\n  }\n\n  websocket._url = parsedUrl.href;\n\n  const isSecure = parsedUrl.protocol === 'wss:';\n  const isIpcUrl = parsedUrl.protocol === 'ws+unix:';\n  let invalidUrlMessage;\n\n  if (parsedUrl.protocol !== 'ws:' && !isSecure && !isIpcUrl) {\n    invalidUrlMessage =\n      'The URL\\'s protocol must be one of \"ws:\", \"wss:\", ' +\n      '\"http:\", \"https:\", or \"ws+unix:\"';\n  } else if (isIpcUrl && !parsedUrl.pathname) {\n    invalidUrlMessage = \"The URL's pathname is empty\";\n  } else if (parsedUrl.hash) {\n    invalidUrlMessage = 'The URL contains a fragment identifier';\n  }\n\n  if (invalidUrlMessage) {\n    const err = new SyntaxError(invalidUrlMessage);\n\n    if (websocket._redirects === 0) {\n      throw err;\n    } else {\n      emitErrorAndClose(websocket, err);\n      return;\n    }\n  }\n\n  const defaultPort = isSecure ? 443 : 80;\n  const key = randomBytes(16).toString('base64');\n  const request = isSecure ? https.request : http.request;\n  const protocolSet = new Set();\n  let perMessageDeflate;\n\n  opts.createConnection =\n    opts.createConnection || (isSecure ? tlsConnect : netConnect);\n  opts.defaultPort = opts.defaultPort || defaultPort;\n  opts.port = parsedUrl.port || defaultPort;\n  opts.host = parsedUrl.hostname.startsWith('[')\n    ? parsedUrl.hostname.slice(1, -1)\n    : parsedUrl.hostname;\n  opts.headers = {\n    ...opts.headers,\n    'Sec-WebSocket-Version': opts.protocolVersion,\n    'Sec-WebSocket-Key': key,\n    Connection: 'Upgrade',\n    Upgrade: 'websocket'\n  };\n  opts.path = parsedUrl.pathname + parsedUrl.search;\n  opts.timeout = opts.handshakeTimeout;\n\n  if (opts.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(\n      opts.perMessageDeflate !== true ? opts.perMessageDeflate : {},\n      false,\n      opts.maxPayload\n    );\n    opts.headers['Sec-WebSocket-Extensions'] = format({\n      [PerMessageDeflate.extensionName]: perMessageDeflate.offer()\n    });\n  }\n  if (protocols.length) {\n    for (const protocol of protocols) {\n      if (\n        typeof protocol !== 'string' ||\n        !subprotocolRegex.test(protocol) ||\n        protocolSet.has(protocol)\n      ) {\n        throw new SyntaxError(\n          'An invalid or duplicated subprotocol was specified'\n        );\n      }\n\n      protocolSet.add(protocol);\n    }\n\n    opts.headers['Sec-WebSocket-Protocol'] = protocols.join(',');\n  }\n  if (opts.origin) {\n    if (opts.protocolVersion < 13) {\n      opts.headers['Sec-WebSocket-Origin'] = opts.origin;\n    } else {\n      opts.headers.Origin = opts.origin;\n    }\n  }\n  if (parsedUrl.username || parsedUrl.password) {\n    opts.auth = `${parsedUrl.username}:${parsedUrl.password}`;\n  }\n\n  if (isIpcUrl) {\n    const parts = opts.path.split(':');\n\n    opts.socketPath = parts[0];\n    opts.path = parts[1];\n  }\n\n  let req;\n\n  if (opts.followRedirects) {\n    if (websocket._redirects === 0) {\n      websocket._originalIpc = isIpcUrl;\n      websocket._originalSecure = isSecure;\n      websocket._originalHostOrSocketPath = isIpcUrl\n        ? opts.socketPath\n        : parsedUrl.host;\n\n      const headers = options && options.headers;\n\n      //\n      // Shallow copy the user provided options so that headers can be changed\n      // without mutating the original object.\n      //\n      options = { ...options, headers: {} };\n\n      if (headers) {\n        for (const [key, value] of Object.entries(headers)) {\n          options.headers[key.toLowerCase()] = value;\n        }\n      }\n    } else if (websocket.listenerCount('redirect') === 0) {\n      const isSameHost = isIpcUrl\n        ? websocket._originalIpc\n          ? opts.socketPath === websocket._originalHostOrSocketPath\n          : false\n        : websocket._originalIpc\n          ? false\n          : parsedUrl.host === websocket._originalHostOrSocketPath;\n\n      if (!isSameHost || (websocket._originalSecure && !isSecure)) {\n        //\n        // Match curl 7.77.0 behavior and drop the following headers. These\n        // headers are also dropped when following a redirect to a subdomain.\n        //\n        delete opts.headers.authorization;\n        delete opts.headers.cookie;\n\n        if (!isSameHost) delete opts.headers.host;\n\n        opts.auth = undefined;\n      }\n    }\n\n    //\n    // Match curl 7.77.0 behavior and make the first `Authorization` header win.\n    // If the `Authorization` header is set, then there is nothing to do as it\n    // will take precedence.\n    //\n    if (opts.auth && !options.headers.authorization) {\n      options.headers.authorization =\n        'Basic ' + Buffer.from(opts.auth).toString('base64');\n    }\n\n    req = websocket._req = request(opts);\n\n    if (websocket._redirects) {\n      //\n      // Unlike what is done for the `'upgrade'` event, no early exit is\n      // triggered here if the user calls `websocket.close()` or\n      // `websocket.terminate()` from a listener of the `'redirect'` event. This\n      // is because the user can also call `request.destroy()` with an error\n      // before calling `websocket.close()` or `websocket.terminate()` and this\n      // would result in an error being emitted on the `request` object with no\n      // `'error'` event listeners attached.\n      //\n      websocket.emit('redirect', websocket.url, req);\n    }\n  } else {\n    req = websocket._req = request(opts);\n  }\n\n  if (opts.timeout) {\n    req.on('timeout', () => {\n      abortHandshake(websocket, req, 'Opening handshake has timed out');\n    });\n  }\n\n  req.on('error', (err) => {\n    if (req === null || req[kAborted]) return;\n\n    req = websocket._req = null;\n    emitErrorAndClose(websocket, err);\n  });\n\n  req.on('response', (res) => {\n    const location = res.headers.location;\n    const statusCode = res.statusCode;\n\n    if (\n      location &&\n      opts.followRedirects &&\n      statusCode >= 300 &&\n      statusCode < 400\n    ) {\n      if (++websocket._redirects > opts.maxRedirects) {\n        abortHandshake(websocket, req, 'Maximum redirects exceeded');\n        return;\n      }\n\n      req.abort();\n\n      let addr;\n\n      try {\n        addr = new URL(location, address);\n      } catch (e) {\n        const err = new SyntaxError(`Invalid URL: ${location}`);\n        emitErrorAndClose(websocket, err);\n        return;\n      }\n\n      initAsClient(websocket, addr, protocols, options);\n    } else if (!websocket.emit('unexpected-response', req, res)) {\n      abortHandshake(\n        websocket,\n        req,\n        `Unexpected server response: ${res.statusCode}`\n      );\n    }\n  });\n\n  req.on('upgrade', (res, socket, head) => {\n    websocket.emit('upgrade', res);\n\n    //\n    // The user may have closed the connection from a listener of the\n    // `'upgrade'` event.\n    //\n    if (websocket.readyState !== WebSocket.CONNECTING) return;\n\n    req = websocket._req = null;\n\n    const upgrade = res.headers.upgrade;\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      abortHandshake(websocket, socket, 'Invalid Upgrade header');\n      return;\n    }\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    if (res.headers['sec-websocket-accept'] !== digest) {\n      abortHandshake(websocket, socket, 'Invalid Sec-WebSocket-Accept header');\n      return;\n    }\n\n    const serverProt = res.headers['sec-websocket-protocol'];\n    let protError;\n\n    if (serverProt !== undefined) {\n      if (!protocolSet.size) {\n        protError = 'Server sent a subprotocol but none was requested';\n      } else if (!protocolSet.has(serverProt)) {\n        protError = 'Server sent an invalid subprotocol';\n      }\n    } else if (protocolSet.size) {\n      protError = 'Server sent no subprotocol';\n    }\n\n    if (protError) {\n      abortHandshake(websocket, socket, protError);\n      return;\n    }\n\n    if (serverProt) websocket._protocol = serverProt;\n\n    const secWebSocketExtensions = res.headers['sec-websocket-extensions'];\n\n    if (secWebSocketExtensions !== undefined) {\n      if (!perMessageDeflate) {\n        const message =\n          'Server sent a Sec-WebSocket-Extensions header but no extension ' +\n          'was requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      let extensions;\n\n      try {\n        extensions = parse(secWebSocketExtensions);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      const extensionNames = Object.keys(extensions);\n\n      if (\n        extensionNames.length !== 1 ||\n        extensionNames[0] !== PerMessageDeflate.extensionName\n      ) {\n        const message = 'Server indicated an extension that was not requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      try {\n        perMessageDeflate.accept(extensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      websocket._extensions[PerMessageDeflate.extensionName] =\n        perMessageDeflate;\n    }\n\n    websocket.setSocket(socket, head, {\n      allowSynchronousEvents: opts.allowSynchronousEvents,\n      generateMask: opts.generateMask,\n      maxPayload: opts.maxPayload,\n      skipUTF8Validation: opts.skipUTF8Validation\n    });\n  });\n\n  if (opts.finishRequest) {\n    opts.finishRequest(req, websocket);\n  } else {\n    req.end();\n  }\n}\n\n/**\n * Emit the `'error'` and `'close'` events.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {Error} The error to emit\n * @private\n */\nfunction emitErrorAndClose(websocket, err) {\n  websocket._readyState = WebSocket.CLOSING;\n  //\n  // The following assignment is practically useless and is done only for\n  // consistency.\n  //\n  websocket._errorEmitted = true;\n  websocket.emit('error', err);\n  websocket.emitClose();\n}\n\n/**\n * Create a `net.Socket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {net.Socket} The newly created socket used to start the connection\n * @private\n */\nfunction netConnect(options) {\n  options.path = options.socketPath;\n  return net.connect(options);\n}\n\n/**\n * Create a `tls.TLSSocket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {tls.TLSSocket} The newly created socket used to start the connection\n * @private\n */\nfunction tlsConnect(options) {\n  options.path = undefined;\n\n  if (!options.servername && options.servername !== '') {\n    options.servername = net.isIP(options.host) ? '' : options.host;\n  }\n\n  return tls.connect(options);\n}\n\n/**\n * Abort the handshake and emit an error.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {(http.ClientRequest|net.Socket|tls.Socket)} stream The request to\n *     abort or the socket to destroy\n * @param {String} message The error message\n * @private\n */\nfunction abortHandshake(websocket, stream, message) {\n  websocket._readyState = WebSocket.CLOSING;\n\n  const err = new Error(message);\n  Error.captureStackTrace(err, abortHandshake);\n\n  if (stream.setHeader) {\n    stream[kAborted] = true;\n    stream.abort();\n\n    if (stream.socket && !stream.socket.destroyed) {\n      //\n      // On Node.js >= 14.3.0 `request.abort()` does not destroy the socket if\n      // called after the request completed. See\n      // https://github.com/websockets/ws/issues/1869.\n      //\n      stream.socket.destroy();\n    }\n\n    process.nextTick(emitErrorAndClose, websocket, err);\n  } else {\n    stream.destroy(err);\n    stream.once('error', websocket.emit.bind(websocket, 'error'));\n    stream.once('close', websocket.emitClose.bind(websocket));\n  }\n}\n\n/**\n * Handle cases where the `ping()`, `pong()`, or `send()` methods are called\n * when the `readyState` attribute is `CLOSING` or `CLOSED`.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {*} [data] The data to send\n * @param {Function} [cb] Callback\n * @private\n */\nfunction sendAfterClose(websocket, data, cb) {\n  if (data) {\n    const length = isBlob(data) ? data.size : toBuffer(data).length;\n\n    //\n    // The `_bufferedAmount` property is used only when the peer is a client and\n    // the opening handshake fails. Under these circumstances, in fact, the\n    // `setSocket()` method is not called, so the `_socket` and `_sender`\n    // properties are set to `null`.\n    //\n    if (websocket._socket) websocket._sender._bufferedBytes += length;\n    else websocket._bufferedAmount += length;\n  }\n\n  if (cb) {\n    const err = new Error(\n      `WebSocket is not open: readyState ${websocket.readyState} ` +\n        `(${readyStates[websocket.readyState]})`\n    );\n    process.nextTick(cb, err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'conclude'` event.\n *\n * @param {Number} code The status code\n * @param {Buffer} reason The reason for closing\n * @private\n */\nfunction receiverOnConclude(code, reason) {\n  const websocket = this[kWebSocket];\n\n  websocket._closeFrameReceived = true;\n  websocket._closeMessage = reason;\n  websocket._closeCode = code;\n\n  if (websocket._socket[kWebSocket] === undefined) return;\n\n  websocket._socket.removeListener('data', socketOnData);\n  process.nextTick(resume, websocket._socket);\n\n  if (code === 1005) websocket.close();\n  else websocket.close(code, reason);\n}\n\n/**\n * The listener of the `Receiver` `'drain'` event.\n *\n * @private\n */\nfunction receiverOnDrain() {\n  const websocket = this[kWebSocket];\n\n  if (!websocket.isPaused) websocket._socket.resume();\n}\n\n/**\n * The listener of the `Receiver` `'error'` event.\n *\n * @param {(RangeError|Error)} err The emitted error\n * @private\n */\nfunction receiverOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._socket[kWebSocket] !== undefined) {\n    websocket._socket.removeListener('data', socketOnData);\n\n    //\n    // On Node.js < 14.0.0 the `'error'` event is emitted synchronously. See\n    // https://github.com/websockets/ws/issues/1940.\n    //\n    process.nextTick(resume, websocket._socket);\n\n    websocket.close(err[kStatusCode]);\n  }\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'finish'` event.\n *\n * @private\n */\nfunction receiverOnFinish() {\n  this[kWebSocket].emitClose();\n}\n\n/**\n * The listener of the `Receiver` `'message'` event.\n *\n * @param {Buffer|ArrayBuffer|Buffer[])} data The message\n * @param {Boolean} isBinary Specifies whether the message is binary or not\n * @private\n */\nfunction receiverOnMessage(data, isBinary) {\n  this[kWebSocket].emit('message', data, isBinary);\n}\n\n/**\n * The listener of the `Receiver` `'ping'` event.\n *\n * @param {Buffer} data The data included in the ping frame\n * @private\n */\nfunction receiverOnPing(data) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._autoPong) websocket.pong(data, !this._isServer, NOOP);\n  websocket.emit('ping', data);\n}\n\n/**\n * The listener of the `Receiver` `'pong'` event.\n *\n * @param {Buffer} data The data included in the pong frame\n * @private\n */\nfunction receiverOnPong(data) {\n  this[kWebSocket].emit('pong', data);\n}\n\n/**\n * Resume a readable stream\n *\n * @param {Readable} stream The readable stream\n * @private\n */\nfunction resume(stream) {\n  stream.resume();\n}\n\n/**\n * The `Sender` error event handler.\n *\n * @param {Error} The error\n * @private\n */\nfunction senderOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket.readyState === WebSocket.CLOSED) return;\n  if (websocket.readyState === WebSocket.OPEN) {\n    websocket._readyState = WebSocket.CLOSING;\n    setCloseTimer(websocket);\n  }\n\n  //\n  // `socket.end()` is used instead of `socket.destroy()` to allow the other\n  // peer to finish sending queued data. There is no need to set a timer here\n  // because `CLOSING` means that it is already set or not needed.\n  //\n  this._socket.end();\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * Set a timer to destroy the underlying raw socket of a WebSocket.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @private\n */\nfunction setCloseTimer(websocket) {\n  websocket._closeTimer = setTimeout(\n    websocket._socket.destroy.bind(websocket._socket),\n    closeTimeout\n  );\n}\n\n/**\n * The listener of the socket `'close'` event.\n *\n * @private\n */\nfunction socketOnClose() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('close', socketOnClose);\n  this.removeListener('data', socketOnData);\n  this.removeListener('end', socketOnEnd);\n\n  websocket._readyState = WebSocket.CLOSING;\n\n  let chunk;\n\n  //\n  // The close frame might not have been received or the `'end'` event emitted,\n  // for example, if the socket was destroyed due to an error. Ensure that the\n  // `receiver` stream is closed after writing any remaining buffered data to\n  // it. If the readable side of the socket is in flowing mode then there is no\n  // buffered data as everything has been already written and `readable.read()`\n  // will return `null`. If instead, the socket is paused, any possible buffered\n  // data will be read as a single chunk.\n  //\n  if (\n    !this._readableState.endEmitted &&\n    !websocket._closeFrameReceived &&\n    !websocket._receiver._writableState.errorEmitted &&\n    (chunk = websocket._socket.read()) !== null\n  ) {\n    websocket._receiver.write(chunk);\n  }\n\n  websocket._receiver.end();\n\n  this[kWebSocket] = undefined;\n\n  clearTimeout(websocket._closeTimer);\n\n  if (\n    websocket._receiver._writableState.finished ||\n    websocket._receiver._writableState.errorEmitted\n  ) {\n    websocket.emitClose();\n  } else {\n    websocket._receiver.on('error', receiverOnFinish);\n    websocket._receiver.on('finish', receiverOnFinish);\n  }\n}\n\n/**\n * The listener of the socket `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction socketOnData(chunk) {\n  if (!this[kWebSocket]._receiver.write(chunk)) {\n    this.pause();\n  }\n}\n\n/**\n * The listener of the socket `'end'` event.\n *\n * @private\n */\nfunction socketOnEnd() {\n  const websocket = this[kWebSocket];\n\n  websocket._readyState = WebSocket.CLOSING;\n  websocket._receiver.end();\n  this.end();\n}\n\n/**\n * The listener of the socket `'error'` event.\n *\n * @private\n */\nfunction socketOnError() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('error', socketOnError);\n  this.on('error', NOOP);\n\n  if (websocket) {\n    websocket._readyState = WebSocket.CLOSING;\n    this.destroy();\n  }\n}\n","'use strict'\nmodule.exports = function (Yallist) {\n  Yallist.prototype[Symbol.iterator] = function* () {\n    for (let walker = this.head; walker; walker = walker.next) {\n      yield walker.value\n    }\n  }\n}\n","'use strict'\nmodule.exports = Yallist\n\nYallist.Node = Node\nYallist.create = Yallist\n\nfunction Yallist (list) {\n  var self = this\n  if (!(self instanceof Yallist)) {\n    self = new Yallist()\n  }\n\n  self.tail = null\n  self.head = null\n  self.length = 0\n\n  if (list && typeof list.forEach === 'function') {\n    list.forEach(function (item) {\n      self.push(item)\n    })\n  } else if (arguments.length > 0) {\n    for (var i = 0, l = arguments.length; i < l; i++) {\n      self.push(arguments[i])\n    }\n  }\n\n  return self\n}\n\nYallist.prototype.removeNode = function (node) {\n  if (node.list !== this) {\n    throw new Error('removing node which does not belong to this list')\n  }\n\n  var next = node.next\n  var prev = node.prev\n\n  if (next) {\n    next.prev = prev\n  }\n\n  if (prev) {\n    prev.next = next\n  }\n\n  if (node === this.head) {\n    this.head = next\n  }\n  if (node === this.tail) {\n    this.tail = prev\n  }\n\n  node.list.length--\n  node.next = null\n  node.prev = null\n  node.list = null\n\n  return next\n}\n\nYallist.prototype.unshiftNode = function (node) {\n  if (node === this.head) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var head = this.head\n  node.list = this\n  node.next = head\n  if (head) {\n    head.prev = node\n  }\n\n  this.head = node\n  if (!this.tail) {\n    this.tail = node\n  }\n  this.length++\n}\n\nYallist.prototype.pushNode = function (node) {\n  if (node === this.tail) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var tail = this.tail\n  node.list = this\n  node.prev = tail\n  if (tail) {\n    tail.next = node\n  }\n\n  this.tail = node\n  if (!this.head) {\n    this.head = node\n  }\n  this.length++\n}\n\nYallist.prototype.push = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    push(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.unshift = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    unshift(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.pop = function () {\n  if (!this.tail) {\n    return undefined\n  }\n\n  var res = this.tail.value\n  this.tail = this.tail.prev\n  if (this.tail) {\n    this.tail.next = null\n  } else {\n    this.head = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.shift = function () {\n  if (!this.head) {\n    return undefined\n  }\n\n  var res = this.head.value\n  this.head = this.head.next\n  if (this.head) {\n    this.head.prev = null\n  } else {\n    this.tail = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.head, i = 0; walker !== null; i++) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.next\n  }\n}\n\nYallist.prototype.forEachReverse = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.prev\n  }\n}\n\nYallist.prototype.get = function (n) {\n  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.next\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.getReverse = function (n) {\n  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.prev\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.map = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.head; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.next\n  }\n  return res\n}\n\nYallist.prototype.mapReverse = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.tail; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.prev\n  }\n  return res\n}\n\nYallist.prototype.reduce = function (fn, initial) {\n  var acc\n  var walker = this.head\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.head) {\n    walker = this.head.next\n    acc = this.head.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = 0; walker !== null; i++) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.next\n  }\n\n  return acc\n}\n\nYallist.prototype.reduceReverse = function (fn, initial) {\n  var acc\n  var walker = this.tail\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.tail) {\n    walker = this.tail.prev\n    acc = this.tail.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = this.length - 1; walker !== null; i--) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.prev\n  }\n\n  return acc\n}\n\nYallist.prototype.toArray = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.head; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.next\n  }\n  return arr\n}\n\nYallist.prototype.toArrayReverse = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.tail; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.prev\n  }\n  return arr\n}\n\nYallist.prototype.slice = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {\n    walker = walker.next\n  }\n  for (; walker !== null && i < to; i++, walker = walker.next) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.sliceReverse = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {\n    walker = walker.prev\n  }\n  for (; walker !== null && i > from; i--, walker = walker.prev) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.splice = function (start, deleteCount, ...nodes) {\n  if (start > this.length) {\n    start = this.length - 1\n  }\n  if (start < 0) {\n    start = this.length + start;\n  }\n\n  for (var i = 0, walker = this.head; walker !== null && i < start; i++) {\n    walker = walker.next\n  }\n\n  var ret = []\n  for (var i = 0; walker && i < deleteCount; i++) {\n    ret.push(walker.value)\n    walker = this.removeNode(walker)\n  }\n  if (walker === null) {\n    walker = this.tail\n  }\n\n  if (walker !== this.head && walker !== this.tail) {\n    walker = walker.prev\n  }\n\n  for (var i = 0; i < nodes.length; i++) {\n    walker = insert(this, walker, nodes[i])\n  }\n  return ret;\n}\n\nYallist.prototype.reverse = function () {\n  var head = this.head\n  var tail = this.tail\n  for (var walker = head; walker !== null; walker = walker.prev) {\n    var p = walker.prev\n    walker.prev = walker.next\n    walker.next = p\n  }\n  this.head = tail\n  this.tail = head\n  return this\n}\n\nfunction insert (self, node, value) {\n  var inserted = node === self.head ?\n    new Node(value, null, node, self) :\n    new Node(value, node, node.next, self)\n\n  if (inserted.next === null) {\n    self.tail = inserted\n  }\n  if (inserted.prev === null) {\n    self.head = inserted\n  }\n\n  self.length++\n\n  return inserted\n}\n\nfunction push (self, item) {\n  self.tail = new Node(item, self.tail, null, self)\n  if (!self.head) {\n    self.head = self.tail\n  }\n  self.length++\n}\n\nfunction unshift (self, item) {\n  self.head = new Node(item, null, self.head, self)\n  if (!self.tail) {\n    self.tail = self.head\n  }\n  self.length++\n}\n\nfunction Node (value, prev, next, list) {\n  if (!(this instanceof Node)) {\n    return new Node(value, prev, next, list)\n  }\n\n  this.list = list\n  this.value = value\n\n  if (prev) {\n    prev.next = this\n    this.prev = prev\n  } else {\n    this.prev = null\n  }\n\n  if (next) {\n    next.prev = this\n    this.next = next\n  } else {\n    this.next = null\n  }\n}\n\ntry {\n  // add if support for Symbol.iterator is present\n  require('./iterator.js')(Yallist)\n} catch (er) {}\n","// Model Configuration System\nexport interface ModelConfig {\n\tprovider: 'openai' | 'anthropic' | 'azure' | 'local';\n\tmodel: string;\n\ttemperature: number;\n\tmaxTokens: number;\n\tapiKey?: string;\n\tendpoint?: string;\n\ttools: {\n\t\tkali: boolean;\n\t\tgcp: boolean;\n\t\tdocker: boolean;\n\t\tvscode: {\n\t\t\tfileAccess: boolean;\n\t\t\tterminal: boolean;\n\t\t\textensions: boolean;\n\t\t\tdebugger: boolean;\n\t\t};\n\t};\n\tpermissions: {\n\t\tdangerousOperations: boolean;\n\t\tnetworkAccess: boolean;\n\t\tfileSystemWrite: boolean;\n\t};\n}\n\nexport interface ExtensionRecommendation {\n\textensionId: string;\n\treason: string;\n\turgency: 'low' | 'medium' | 'high';\n\tcategory: string;\n\trequiredForTask?: string;\n}\n\nexport interface PermissionRequest {\n\tid: string;\n\textensionId: string;\n\tcommand: string;\n\tpurpose: string;\n\triskLevel: 'low' | 'medium' | 'high';\n\ttimestamp: number;\n\tapproved?: boolean;\n}\n\nexport class ModelConfiguration {\n\tprivate static readonly CONFIG_KEY = 'ai-model-config';\n\tprivate static readonly PERMISSIONS_KEY = 'ai-permissions';\n\tprivate config: ModelConfig;\n\tprivate permissions: Record<string, boolean> = {};\n\n\tconstructor() {\n\t\tthis.config = this.loadConfig();\n\t\tthis.permissions = this.loadPermissions();\n\t}\n\n\tprivate loadConfig(): ModelConfig {\n\t\tconst saved = localStorage.getItem(ModelConfiguration.CONFIG_KEY);\n\t\tif (saved) {\n\t\t\treturn JSON.parse(saved);\n\t\t}\n\n\t\treturn {\n\t\t\tprovider: 'openai',\n\t\t\tmodel: 'gpt-4-1106-preview',\n\t\t\ttemperature: 0.7,\n\t\t\tmaxTokens: 4096,\n\t\t\ttools: {\n\t\t\t\tkali: false, // Default disabled for security\n\t\t\t\tgcp: true,\n\t\t\t\tdocker: true,\n\t\t\t\tvscode: {\n\t\t\t\t\tfileAccess: true,\n\t\t\t\t\tterminal: false, // Requires explicit user approval\n\t\t\t\t\textensions: true,\n\t\t\t\t\tdebugger: false\n\t\t\t\t}\n\t\t\t},\n\t\t\tpermissions: {\n\t\t\t\tdangerousOperations: false,\n\t\t\t\tnetworkAccess: true,\n\t\t\t\tfileSystemWrite: false\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate loadPermissions(): Record<string, boolean> {\n\t\tconst saved = localStorage.getItem(ModelConfiguration.PERMISSIONS_KEY);\n\t\treturn saved ? JSON.parse(saved) : {};\n\t}\n\n\tasync updateConfig(updates: Partial<ModelConfig>): Promise<void> {\n\t\tthis.config = { ...this.config, ...updates };\n\t\tlocalStorage.setItem(\n\t\t\tModelConfiguration.CONFIG_KEY,\n\t\t\tJSON.stringify(this.config)\n\t\t);\n\n\t\t// Notify about configuration update\n\t\twindow.electronAPI?.notifyConfigUpdate?.(this.config);\n\t}\n\n\tasync updatePermission(extensionId: string, granted: boolean): Promise<void> {\n\t\tthis.permissions[extensionId] = granted;\n\t\tlocalStorage.setItem(\n\t\t\tModelConfiguration.PERMISSIONS_KEY,\n\t\t\tJSON.stringify(this.permissions)\n\t\t);\n\t}\n\n\tgetConfig(): ModelConfig {\n\t\treturn { ...this.config };\n\t}\n\n\thasPermission(extensionId: string): boolean {\n\t\treturn this.permissions[extensionId] === true;\n\t}\n\n\tgetPermissions(): Record<string, boolean> {\n\t\treturn { ...this.permissions };\n\t}\n\n\tvalidateConfig(): string[] {\n\t\tconst errors: string[] = [];\n\n\t\tif (!this.config.apiKey && this.config.provider !== 'local') {\n\t\t\terrors.push(`API key required for ${this.config.provider}`);\n\t\t}\n\n\t\tif (this.config.temperature < 0 || this.config.temperature > 2) {\n\t\t\terrors.push('Temperature must be between 0 and 2');\n\t\t}\n\n\t\tif (this.config.maxTokens < 1 || this.config.maxTokens > 8192) {\n\t\t\terrors.push('Max tokens must be between 1 and 8192');\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\texportConfig(): string {\n\t\treturn JSON.stringify({\n\t\t\tconfig: this.config,\n\t\t\tpermissions: this.permissions,\n\t\t\texportedAt: new Date().toISOString()\n\t\t}, null, 2);\n\t}\n\n\timportConfig(configString: string): void {\n\t\ttry {\n\t\t\tconst imported = JSON.parse(configString);\n\t\t\tif (imported.config) {\n\t\t\t\tthis.config = imported.config;\n\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\tModelConfiguration.CONFIG_KEY,\n\t\t\t\t\tJSON.stringify(this.config)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (imported.permissions) {\n\t\t\t\tthis.permissions = imported.permissions;\n\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\tModelConfiguration.PERMISSIONS_KEY,\n\t\t\t\t\tJSON.stringify(this.permissions)\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthrow new Error('Invalid configuration format');\n\t\t}\n\t}\n}\n","import { WebSocket, WebSocketServer } from 'ws';\nimport { EventEmitter } from 'events';\nimport { ToolExecutor } from '../ai/tool-executor';\nimport { ModelConfiguration } from '../ai/config';\n\nexport interface StreamToken {\n\ttype: 'token' | 'tool_call' | 'tool_result' | 'error' | 'complete' | 'status';\n\tcontent: string;\n\tdata?: any;\n\tmetadata?: {\n\t\ttimestamp: number;\n\t\ttokenCount?: number;\n\t\tmodel?: string;\n\t\tusage?: {\n\t\t\tpromptTokens: number;\n\t\t\tcompletionTokens: number;\n\t\t\ttotalTokens: number;\n\t\t};\n\t};\n}\n\nexport interface AIRequest {\n\tid: string;\n\tprompt: string;\n\tcontext?: any;\n\toptions?: {\n\t\tmodel?: string;\n\t\ttemperature?: number;\n\t\tmaxTokens?: number;\n\t\tstream?: boolean;\n\t};\n\ttools?: any[];\n}\n\nexport interface AIResponse {\n\tid: string;\n\tcontent: string;\n\tusage?: {\n\t\tpromptTokens: number;\n\t\tcompletionTokens: number;\n\t\ttotalTokens: number;\n\t};\n\ttoolCalls?: any[];\n\terror?: string;\n}\n\nexport class AIStream extends EventEmitter {\n\tprivate wsServer: WebSocketServer;\n\tprivate connections: Map<string, WebSocket> = new Map();\n\tprivate toolExecutor: ToolExecutor;\n\tprivate modelConfig: ModelConfiguration;\n\tprivate activeStreams: Map<string, AbortController> = new Map();\n\n\tconstructor(private port: number) {\n\t\tsuper();\n\t\tthis.toolExecutor = new ToolExecutor();\n\t\tthis.modelConfig = new ModelConfiguration();\n\t\tthis.initializeWebSocketServer();\n\t}\n\n\tprivate initializeWebSocketServer(): void {\n\t\tthis.wsServer = new WebSocketServer({\n\t\t\tport: this.port,\n\t\t\tperMessageDeflate: false // Disable compression for real-time streaming\n\t\t});\n\n\t\tthis.wsServer.on('connection', (ws: WebSocket, request) => {\n\t\t\tconst connectionId = this.generateConnectionId();\n\t\t\tthis.connections.set(connectionId, ws);\n\n\t\t\tconsole.log(`AI Stream connection established: ${connectionId}`);\n\n\t\t\tws.on('message', async (data) => {\n\t\t\t\ttry {\n\t\t\t\t\tconst request: AIRequest = JSON.parse(data.toString());\n\t\t\t\t\tawait this.handleRequest(connectionId, request);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.sendError(connectionId, 'Invalid request format');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tws.on('close', () => {\n\t\t\t\tthis.connections.delete(connectionId);\n\t\t\t\t// Cancel any active streams for this connection\n\t\t\t\tconst streamController = this.activeStreams.get(connectionId);\n\t\t\t\tif (streamController) {\n\t\t\t\t\tstreamController.abort();\n\t\t\t\t\tthis.activeStreams.delete(connectionId);\n\t\t\t\t}\n\t\t\t\tconsole.log(`AI Stream connection closed: ${connectionId}`);\n\t\t\t});\n\n\t\t\tws.on('error', (error) => {\n\t\t\t\tconsole.error(`WebSocket error for ${connectionId}:`, error);\n\t\t\t\tthis.connections.delete(connectionId);\n\t\t\t});\n\n\t\t\t// Send welcome message\n\t\t\tthis.sendToken(connectionId, {\n\t\t\t\ttype: 'status',\n\t\t\t\tcontent: 'Connected to AI Stream',\n\t\t\t\tdata: { connectionId }\n\t\t\t});\n\t\t});\n\n\t\tthis.wsServer.on('listening', () => {\n\t\t\tconsole.log(`AI Stream server listening on port ${this.port}`);\n\t\t});\n\t}\n\n\tprivate async handleRequest(connectionId: string, request: AIRequest): Promise<void> {\n\t\ttry {\n\t\t\t// Validate request\n\t\t\tif (!request.prompt) {\n\t\t\t\tthis.sendError(connectionId, 'Prompt is required');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Create abort controller for this request\n\t\t\tconst abortController = new AbortController();\n\t\t\tthis.activeStreams.set(connectionId, abortController);\n\n\t\t\t// Send status update\n\t\t\tthis.sendToken(connectionId, {\n\t\t\t\ttype: 'status',\n\t\t\t\tcontent: 'Processing request...',\n\t\t\t\tdata: { requestId: request.id }\n\t\t\t});\n\n\t\t\t// Get configuration\n\t\t\tconst config = this.modelConfig.getConfig();\n\n\t\t\t// Merge request options with config\n\t\t\tconst effectiveOptions = {\n\t\t\t\tmodel: request.options?.model || config.model,\n\t\t\t\ttemperature: request.options?.temperature || config.temperature,\n\t\t\t\tmaxTokens: request.options?.maxTokens || config.maxTokens,\n\t\t\t\tstream: request.options?.stream !== false // Default to streaming\n\t\t\t};\n\n\t\t\t// Stream the response\n\t\t\tawait this.streamResponse(connectionId, request, effectiveOptions, abortController.signal);\n\n\t\t} catch (error) {\n\t\t\tthis.sendError(connectionId, error instanceof Error ? error.message : 'Unknown error');\n\t\t} finally {\n\t\t\tthis.activeStreams.delete(connectionId);\n\t\t}\n\t}\n\n\tprivate async streamResponse(\n\t\tconnectionId: string,\n\t\trequest: AIRequest,\n\t\toptions: any,\n\t\tabortSignal: AbortSignal\n\t): Promise<void> {\n\t\tlet totalTokens = 0;\n\t\tlet completionTokens = 0;\n\t\tconst promptTokens = this.estimateTokenCount(request.prompt);\n\n\t\ttry {\n\t\t\t// Get available tools\n\t\t\tconst availableTools = this.toolExecutor.getAvailableTools();\n\n\t\t\t// Prepare messages for AI model\n\t\t\tconst messages = [\n\t\t\t\t{\n\t\t\t\t\trole: 'system',\n\t\t\t\t\tcontent: this.buildSystemPrompt(request.context, availableTools)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trole: 'user',\n\t\t\t\t\tcontent: request.prompt\n\t\t\t\t}\n\t\t\t];\n\n\t\t\t// Call AI model with streaming\n\t\t\tconst stream = await this.callAIModel({\n\t\t\t\tmessages,\n\t\t\t\ttools: availableTools,\n\t\t\t\tmodel: options.model,\n\t\t\t\ttemperature: options.temperature,\n\t\t\t\tmaxTokens: options.maxTokens,\n\t\t\t\tstream: true\n\t\t\t}, abortSignal);\n\n\t\t\tlet assistantMessage = '';\n\t\t\tlet currentToolCalls: any[] = [];\n\n\t\t\t// Process stream\n\t\t\tfor await (const chunk of stream) {\n\t\t\t\tif (abortSignal.aborted) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Handle content tokens\n\t\t\t\tif (chunk.choices?.[0]?.delta?.content) {\n\t\t\t\t\tconst content = chunk.choices[0].delta.content;\n\t\t\t\t\tassistantMessage += content;\n\t\t\t\t\tcompletionTokens += this.estimateTokenCount(content);\n\t\t\t\t\ttotalTokens = promptTokens + completionTokens;\n\n\t\t\t\t\tthis.sendToken(connectionId, {\n\t\t\t\t\t\ttype: 'token',\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tmetadata: {\n\t\t\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\t\t\ttokenCount: completionTokens,\n\t\t\t\t\t\t\tmodel: options.model\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Handle tool calls\n\t\t\t\tif (chunk.choices?.[0]?.delta?.tool_calls) {\n\t\t\t\t\tconst toolCall = chunk.choices[0].delta.tool_calls[0];\n\n\t\t\t\t\tif (toolCall.function) {\n\t\t\t\t\t\tcurrentToolCalls.push(toolCall);\n\n\t\t\t\t\t\tthis.sendToken(connectionId, {\n\t\t\t\t\t\t\ttype: 'tool_call',\n\t\t\t\t\t\t\tcontent: `\\n🔧 Executing: ${toolCall.function.name}\\n`,\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\ttoolName: toolCall.function.name,\n\t\t\t\t\t\t\t\targuments: toolCall.function.arguments\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// Execute the tool\n\t\t\t\t\t\t\tconst result = await this.toolExecutor.executeTool({\n\t\t\t\t\t\t\t\tname: toolCall.function.name,\n\t\t\t\t\t\t\t\tfunction: toolCall.function.name,\n\t\t\t\t\t\t\t\targuments: JSON.parse(toolCall.function.arguments || '{}')\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\tthis.sendToken(connectionId, {\n\t\t\t\t\t\t\t\t\ttype: 'tool_result',\n\t\t\t\t\t\t\t\t\tcontent: `✅ Result: ${result.output}\\n`,\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tsuccess: true,\n\t\t\t\t\t\t\t\t\t\toutput: result.output,\n\t\t\t\t\t\t\t\t\t\ttoolName: toolCall.function.name\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.sendToken(connectionId, {\n\t\t\t\t\t\t\t\t\ttype: 'tool_result',\n\t\t\t\t\t\t\t\t\tcontent: `❌ Error: ${result.error}\\n`,\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tsuccess: false,\n\t\t\t\t\t\t\t\t\t\terror: result.error,\n\t\t\t\t\t\t\t\t\t\ttoolName: toolCall.function.name,\n\t\t\t\t\t\t\t\t\t\trecommendedExtensions: result.recommendedExtensions\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// Handle extension recommendations\n\t\t\t\t\t\t\t\tif (result.recommendedExtensions) {\n\t\t\t\t\t\t\t\t\tthis.sendToken(connectionId, {\n\t\t\t\t\t\t\t\t\t\ttype: 'status',\n\t\t\t\t\t\t\t\t\t\tcontent: `💡 Suggested extensions: ${result.recommendedExtensions.join(', ')}`,\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\ttype: 'extension_recommendation',\n\t\t\t\t\t\t\t\t\t\t\textensions: result.recommendedExtensions\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tthis.sendToken(connectionId, {\n\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\tcontent: `🚫 Tool execution failed: ${error instanceof Error ? error.message : 'Unknown error'}\\n`,\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\ttoolName: toolCall.function.name,\n\t\t\t\t\t\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Handle finish reason\n\t\t\t\tif (chunk.choices?.[0]?.finish_reason) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Send completion message\n\t\t\tthis.sendToken(connectionId, {\n\t\t\t\ttype: 'complete',\n\t\t\t\tcontent: '',\n\t\t\t\tdata: {\n\t\t\t\t\trequestId: request.id,\n\t\t\t\t\ttotalTokens,\n\t\t\t\t\tusage: {\n\t\t\t\t\t\tpromptTokens,\n\t\t\t\t\t\tcompletionTokens,\n\t\t\t\t\t\ttotalTokens\n\t\t\t\t\t},\n\t\t\t\t\ttoolCalls: currentToolCalls\n\t\t\t\t},\n\t\t\t\tmetadata: {\n\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\tmodel: options.model,\n\t\t\t\t\tusage: {\n\t\t\t\t\t\tpromptTokens,\n\t\t\t\t\t\tcompletionTokens,\n\t\t\t\t\t\ttotalTokens\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t} catch (error) {\n\t\t\tif (!abortSignal.aborted) {\n\t\t\t\tthis.sendError(connectionId, error instanceof Error ? error.message : 'Streaming failed');\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async callAIModel(params: any, abortSignal: AbortSignal): Promise<AsyncIterable<any>> {\n\t\tconst config = this.modelConfig.getConfig();\n\n\t\t// For demonstration, create a mock streaming response\n\t\t// In production, this would call the actual AI service\n\t\treturn this.createMockStream(params, abortSignal);\n\t}\n\n\tprivate async *createMockStream(params: any, abortSignal: AbortSignal): AsyncIterable<any> {\n\t\tconst responses = [\n\t\t\t\"I'll help you with your development task. Let me analyze your request and available tools.\",\n\t\t\t\"\\n\\nBased on your workspace, I can see several opportunities for improvement. \",\n\t\t\t\"Let me start by examining your project structure and dependencies.\",\n\t\t\t\"\\n\\nI notice you have some files that could benefit from formatting. \",\n\t\t\t\"Would you like me to run prettier on your TypeScript files?\"\n\t\t];\n\n\t\tfor (let i = 0; i < responses.length; i++) {\n\t\t\tif (abortSignal.aborted) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tyield {\n\t\t\t\tchoices: [{\n\t\t\t\t\tdelta: {\n\t\t\t\t\t\tcontent: responses[i]\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\t// Simulate streaming delay\n\t\t\tawait new Promise(resolve => setTimeout(resolve, 150));\n\t\t}\n\n\t\t// Simulate tool call\n\t\tif (!abortSignal.aborted && params.tools && params.tools.length > 0) {\n\t\t\tyield {\n\t\t\t\tchoices: [{\n\t\t\t\t\tdelta: {\n\t\t\t\t\t\ttool_calls: [{\n\t\t\t\t\t\t\tfunction: {\n\t\t\t\t\t\t\t\tname: 'vscode_esbenp_prettier_vscode_format',\n\t\t\t\t\t\t\t\targuments: JSON.stringify({ files: ['src/index.ts'] })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}]\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tawait new Promise(resolve => setTimeout(resolve, 1000));\n\t\t}\n\n\t\t// Completion\n\t\tyield {\n\t\t\tchoices: [{\n\t\t\t\tfinish_reason: 'stop'\n\t\t\t}]\n\t\t};\n\t}\n\n\tprivate buildSystemPrompt(context: any, tools: any[]): string {\n\t\tconst config = this.modelConfig.getConfig();\n\n\t\treturn `You are VSEmbed AI DevTool, an advanced AI assistant integrated into a VS Code-like development environment.\n\nCONTEXT:\n${context ? JSON.stringify(context, null, 2) : 'No additional context provided'}\n\nAVAILABLE TOOLS:\n${tools.map(tool => `- ${tool.name}: ${tool.description}`).join('\\n')}\n\nCAPABILITIES:\n- VS Code extension access: ${config.tools.vscode.extensions ? 'ENABLED' : 'DISABLED'}\n- Terminal operations: ${config.tools.vscode.terminal ? 'ENABLED' : 'DISABLED'}\n- File system access: ${config.tools.vscode.fileAccess ? 'ENABLED' : 'DISABLED'}\n- Docker operations: ${config.tools.docker ? 'ENABLED' : 'DISABLED'}\n- GCP integration: ${config.tools.gcp ? 'ENABLED' : 'DISABLED'}\n- Security tools: ${config.tools.kali ? 'ENABLED' : 'DISABLED'}\n\nINSTRUCTIONS:\n1. Always explain what you're going to do before using tools\n2. Request permissions clearly when needed\n3. Recommend extensions when they would be helpful\n4. Provide clear, actionable advice\n5. Respect security settings and user permissions\n6. Use tools efficiently and explain their purpose\n\nRespond in a helpful, professional manner and use tools when appropriate to assist with development tasks.`;\n\t}\n\n\tprivate sendToken(connectionId: string, token: StreamToken): void {\n\t\tconst ws = this.connections.get(connectionId);\n\t\tif (ws && ws.readyState === WebSocket.OPEN) {\n\t\t\ttry {\n\t\t\t\tws.send(JSON.stringify(token));\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(`Failed to send token to ${connectionId}:`, error);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate sendError(connectionId: string, message: string): void {\n\t\tthis.sendToken(connectionId, {\n\t\t\ttype: 'error',\n\t\t\tcontent: message,\n\t\t\tmetadata: {\n\t\t\t\ttimestamp: Date.now()\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate generateConnectionId(): string {\n\t\treturn `conn_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n\t}\n\n\tprivate estimateTokenCount(text: string): number {\n\t\t// Simple token estimation (roughly 4 characters per token)\n\t\treturn Math.ceil(text.length / 4);\n\t}\n\n\t// Public API methods\n\tpublic async broadcast(token: StreamToken): Promise<void> {\n\t\tconst message = JSON.stringify(token);\n\t\tconst promises: Promise<void>[] = [];\n\n\t\tthis.connections.forEach((ws, connectionId) => {\n\t\t\tif (ws.readyState === WebSocket.OPEN) {\n\t\t\t\tpromises.push(\n\t\t\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\t\t\tws.send(message, (error) => {\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\tconsole.error(`Broadcast failed for ${connectionId}:`, error);\n\t\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\tawait Promise.allSettled(promises);\n\t}\n\n\tpublic getActiveConnections(): number {\n\t\treturn this.connections.size;\n\t}\n\n\tpublic getActiveStreams(): number {\n\t\treturn this.activeStreams.size;\n\t}\n\n\tpublic async shutdown(): Promise<void> {\n\t\tconsole.log('Shutting down AI Stream server...');\n\n\t\t// Cancel all active streams\n\t\tthis.activeStreams.forEach(controller => {\n\t\t\tcontroller.abort();\n\t\t});\n\t\tthis.activeStreams.clear();\n\n\t\t// Close all connections\n\t\tconst closePromises: Promise<void>[] = [];\n\t\tthis.connections.forEach((ws, connectionId) => {\n\t\t\tclosePromises.push(\n\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\tws.close(1000, 'Server shutdown');\n\t\t\t\t\tws.on('close', resolve);\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\n\t\tawait Promise.all(closePromises);\n\t\tthis.connections.clear();\n\n\t\t// Close WebSocket server\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.wsServer.close((error) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('AI Stream server shut down successfully');\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n\n// Client-side streaming interface\nexport class AIStreamClient extends EventEmitter {\n\tprivate ws: WebSocket | null = null;\n\tprivate connectionId: string | null = null;\n\tprivate reconnectAttempts = 0;\n\tprivate maxReconnectAttempts = 5;\n\tprivate reconnectDelay = 1000;\n\n\tconstructor(private url: string) {\n\t\tsuper();\n\t}\n\n\tasync connect(): Promise<void> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tthis.ws = new WebSocket(this.url);\n\n\t\t\t\tthis.ws.onopen = () => {\n\t\t\t\t\tconsole.log('Connected to AI Stream');\n\t\t\t\t\tthis.reconnectAttempts = 0;\n\t\t\t\t\tresolve();\n\t\t\t\t};\n\n\t\t\t\tthis.ws.onmessage = (event) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst token: StreamToken = JSON.parse(event.data);\n\n\t\t\t\t\t\tif (token.type === 'status' && token.data?.connectionId) {\n\t\t\t\t\t\t\tthis.connectionId = token.data.connectionId;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.emit('token', token);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.error('Failed to parse stream message:', error);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.ws.onclose = (event) => {\n\t\t\t\t\tconsole.log('AI Stream connection closed:', event.code, event.reason);\n\t\t\t\t\tthis.emit('disconnect');\n\n\t\t\t\t\tif (event.code !== 1000 && this.reconnectAttempts < this.maxReconnectAttempts) {\n\t\t\t\t\t\tthis.attemptReconnect();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.ws.onerror = (error) => {\n\t\t\t\t\tconsole.error('AI Stream error:', error);\n\t\t\t\t\tthis.emit('error', error);\n\t\t\t\t\treject(error);\n\t\t\t\t};\n\n\t\t\t} catch (error) {\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async attemptReconnect(): Promise<void> {\n\t\tthis.reconnectAttempts++;\n\t\tconst delay = this.reconnectDelay * Math.pow(2, this.reconnectAttempts - 1);\n\n\t\tconsole.log(`Attempting to reconnect (${this.reconnectAttempts}/${this.maxReconnectAttempts}) in ${delay}ms...`);\n\n\t\tsetTimeout(async () => {\n\t\t\ttry {\n\t\t\t\tawait this.connect();\n\t\t\t\tthis.emit('reconnect');\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Reconnection failed:', error);\n\t\t\t}\n\t\t}, delay);\n\t}\n\n\tasync sendRequest(request: AIRequest): Promise<void> {\n\t\tif (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n\t\t\tthrow new Error('WebSocket not connected');\n\t\t}\n\n\t\tthis.ws.send(JSON.stringify(request));\n\t}\n\n\tdisconnect(): void {\n\t\tif (this.ws) {\n\t\t\tthis.ws.close(1000, 'Client disconnect');\n\t\t\tthis.ws = null;\n\t\t}\n\t}\n\n\tisConnected(): boolean {\n\t\treturn this.ws?.readyState === WebSocket.OPEN;\n\t}\n\n\tgetConnectionId(): string | null {\n\t\treturn this.connectionId;\n\t}\n}\n","import { ExtensionRecommender } from '../extensions/recommender';\nimport { PermissionManager } from '../permissions/manager';\nimport { ModelConfiguration } from '../ai/config';\n\ninterface ToolCall {\n\tname: string;\n\tfunction: string;\n\targuments: any;\n}\n\ninterface ExecutionResult {\n\tsuccess: boolean;\n\toutput: string;\n\terror?: string;\n\trequiresPermission?: boolean;\n\trecommendedExtensions?: string[];\n}\n\ninterface ExtensionAPI {\n\tid: string;\n\tisActive: boolean;\n\tcommands: string[];\n\tapi?: any;\n}\n\nexport class ToolExecutor {\n\tprivate permissionManager: PermissionManager;\n\tprivate extensionRecommender: ExtensionRecommender;\n\tprivate modelConfig: ModelConfiguration;\n\tprivate availableExtensions: Map<string, ExtensionAPI> = new Map();\n\n\tconstructor() {\n\t\tthis.permissionManager = new PermissionManager();\n\t\tthis.extensionRecommender = new ExtensionRecommender();\n\t\tthis.modelConfig = new ModelConfiguration();\n\t\tthis.initializeExtensionTracking();\n\t}\n\n\tprivate async initializeExtensionTracking(): Promise<void> {\n\t\t// In a real VS Code environment, this would query actual extensions\n\t\t// For now, simulate some common extensions\n\t\tconst commonExtensions = [\n\t\t\t{ id: 'esbenp.prettier-vscode', commands: ['prettier.format'] },\n\t\t\t{ id: 'dbaeumer.vscode-eslint', commands: ['eslint.fix'] },\n\t\t\t{ id: 'ms-python.python', commands: ['python.run', 'python.debug'] },\n\t\t\t{ id: 'ms-azuretools.vscode-docker', commands: ['docker.build', 'docker.run'] }\n\t\t];\n\n\t\tcommonExtensions.forEach(ext => {\n\t\t\tthis.availableExtensions.set(ext.id, {\n\t\t\t\tid: ext.id,\n\t\t\t\tisActive: true,\n\t\t\t\tcommands: ext.commands\n\t\t\t});\n\t\t});\n\t}\n\n\tasync executeTool(toolCall: ToolCall): Promise<ExecutionResult> {\n\t\ttry {\n\t\t\t// Handle VS Code extension tools\n\t\t\tif (toolCall.name.startsWith('vscode_')) {\n\t\t\t\treturn await this.executeVSCodeTool(toolCall);\n\t\t\t}\n\n\t\t\t// Handle Kali tools\n\t\t\tif (toolCall.name.startsWith('kali_')) {\n\t\t\t\treturn await this.executeKaliTool(toolCall);\n\t\t\t}\n\n\t\t\t// Handle Docker tools\n\t\t\tif (toolCall.name.startsWith('docker_')) {\n\t\t\t\treturn await this.executeDockerTool(toolCall);\n\t\t\t}\n\n\t\t\t// Handle GCP tools\n\t\t\tif (toolCall.name.startsWith('gcp_')) {\n\t\t\t\treturn await this.executeGCPTool(toolCall);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: `Unknown tool type: ${toolCall.name}`\n\t\t\t};\n\n\t\t} catch (error) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate async executeVSCodeTool(toolCall: ToolCall): Promise<ExecutionResult> {\n\t\tconst { name, function: command, arguments: args } = toolCall;\n\t\tconst extId = this.parseExtensionId(name);\n\n\t\t// Check if extension is available\n\t\tconst extension = this.availableExtensions.get(extId);\n\t\tif (!extension) {\n\t\t\t// Recommend extension installation\n\t\t\tconst recommendations = this.extensionRecommender.recommendExtensions({\n\t\t\t\tfiles: [],\n\t\t\t\tinstalledExtensions: Array.from(this.availableExtensions.keys()),\n\t\t\t\tactiveExtensions: Array.from(this.availableExtensions.keys()),\n\t\t\t\tdependencies: {}\n\t\t\t});\n\n\t\t\tconst recommendation = recommendations.find(r => r.extensionId === extId);\n\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: `Extension ${extId} not available`,\n\t\t\t\trecommendedExtensions: [extId],\n\t\t\t\trequiresPermission: false\n\t\t\t};\n\t\t}\n\n\t\t// Check permissions\n\t\tconst hasPermission = await this.permissionManager.requestExtensionPermission(\n\t\t\textId,\n\t\t\tcommand,\n\t\t\t`Execute ${command} with arguments: ${JSON.stringify(args)}`\n\t\t);\n\n\t\tif (!hasPermission) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: `Permission denied for ${extId}:${command}`,\n\t\t\t\trequiresPermission: true\n\t\t\t};\n\t\t}\n\n\t\t// Execute the command\n\t\ttry {\n\t\t\tconst result = await this.callExtensionCommand(extId, command, args);\n\t\t\treturn {\n\t\t\t\tsuccess: true,\n\t\t\t\toutput: JSON.stringify(result),\n\t\t\t\terror: undefined\n\t\t\t};\n\t\t} catch (error) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: `Extension execution failed: ${error instanceof Error ? error.message : 'Unknown error'}`\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate async executeKaliTool(toolCall: ToolCall): Promise<ExecutionResult> {\n\t\tconst config = this.modelConfig.getConfig();\n\n\t\tif (!config.tools.kali) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: 'Kali tools are disabled in configuration'\n\t\t\t};\n\t\t}\n\n\t\tconst hasPermission = await this.permissionManager.requestExtensionPermission(\n\t\t\t'kali-tools',\n\t\t\ttoolCall.function,\n\t\t\t`Execute Kali security tool: ${toolCall.function}`\n\t\t);\n\n\t\tif (!hasPermission) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: 'Permission denied for Kali tools',\n\t\t\t\trequiresPermission: true\n\t\t\t};\n\t\t}\n\n\t\t// Simulate Kali tool execution\n\t\tconst { function: tool, arguments: args } = toolCall;\n\n\t\tswitch (tool) {\n\t\t\tcase 'nmap_scan':\n\t\t\t\treturn this.simulateNmapScan(args);\n\t\t\tcase 'vulnerability_scan':\n\t\t\t\treturn this.simulateVulnerabilityScan(args);\n\t\t\tdefault:\n\t\t\t\treturn {\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\toutput: '',\n\t\t\t\t\terror: `Unknown Kali tool: ${tool}`\n\t\t\t\t};\n\t\t}\n\t}\n\n\tprivate async executeDockerTool(toolCall: ToolCall): Promise<ExecutionResult> {\n\t\tconst config = this.modelConfig.getConfig();\n\n\t\tif (!config.tools.docker) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: 'Docker tools are disabled in configuration'\n\t\t\t};\n\t\t}\n\n\t\tconst hasPermission = await this.permissionManager.requestExtensionPermission(\n\t\t\t'docker',\n\t\t\ttoolCall.function,\n\t\t\t`Execute Docker command: ${toolCall.function}`\n\t\t);\n\n\t\tif (!hasPermission) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: 'Permission denied for Docker operations',\n\t\t\t\trequiresPermission: true\n\t\t\t};\n\t\t}\n\n\t\t// Simulate Docker command execution\n\t\tconst result = await this.executeDockerCommand(toolCall.function, toolCall.arguments);\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\toutput: result,\n\t\t\terror: undefined\n\t\t};\n\t}\n\n\tprivate async executeGCPTool(toolCall: ToolCall): Promise<ExecutionResult> {\n\t\tconst config = this.modelConfig.getConfig();\n\n\t\tif (!config.tools.gcp) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\toutput: '',\n\t\t\t\terror: 'GCP tools are disabled in configuration'\n\t\t\t};\n\t\t}\n\n\t\t// Simulate GCP API call\n\t\tconst result = await this.callGCPAPI(toolCall.function, toolCall.arguments);\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\toutput: JSON.stringify(result),\n\t\t\terror: undefined\n\t\t};\n\t}\n\n\tprivate parseExtensionId(toolName: string): string {\n\t\t// Convert vscode_extension_name_command to extension.name\n\t\tconst parts = toolName.split('_').slice(1); // Remove 'vscode' prefix\n\t\tconst commandIndex = parts.findIndex(part => part === 'command' || part === 'cmd');\n\n\t\tif (commandIndex > 0) {\n\t\t\treturn parts.slice(0, commandIndex).join('.');\n\t\t}\n\n\t\treturn parts.join('.');\n\t}\n\n\tprivate async callExtensionCommand(\n\t\textensionId: string,\n\t\tcommand: string,\n\t\targs: any[]\n\t): Promise<any> {\n\t\t// In a real implementation, this would call the actual VS Code API\n\t\t// For simulation, return mock results\n\n\t\tif (command === 'prettier.format') {\n\t\t\treturn { formatted: true, changes: 5 };\n\t\t}\n\n\t\tif (command === 'eslint.fix') {\n\t\t\treturn { fixes: 3, errors: 0, warnings: 1 };\n\t\t}\n\n\t\tif (command === 'python.run') {\n\t\t\treturn { exitCode: 0, output: 'Hello, World!' };\n\t\t}\n\n\t\treturn { executed: true, command, args };\n\t}\n\n\tprivate async simulateNmapScan(args: any): Promise<ExecutionResult> {\n\t\t// Simulate nmap scan results\n\t\tconst mockResults = {\n\t\t\ttarget: args.target || '127.0.0.1',\n\t\t\topen_ports: [22, 80, 443],\n\t\t\tclosed_ports: [21, 25, 53],\n\t\t\tscan_time: '2.5s'\n\t\t};\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\toutput: JSON.stringify(mockResults, null, 2),\n\t\t\terror: undefined\n\t\t};\n\t}\n\n\tprivate async simulateVulnerabilityScan(args: any): Promise<ExecutionResult> {\n\t\tconst mockResults = {\n\t\t\tvulnerabilities: [\n\t\t\t\t{ id: 'CVE-2023-1234', severity: 'medium', description: 'Sample vulnerability' }\n\t\t\t],\n\t\t\tscan_date: new Date().toISOString()\n\t\t};\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\toutput: JSON.stringify(mockResults, null, 2),\n\t\t\terror: undefined\n\t\t};\n\t}\n\n\tprivate async executeDockerCommand(command: string, args: any): Promise<string> {\n\t\t// Simulate Docker command execution\n\t\tconst mockCommands = {\n\t\t\t'build': `Building image: ${args.tag || 'latest'}`,\n\t\t\t'run': `Running container: ${args.image || 'ubuntu'}`,\n\t\t\t'ps': 'CONTAINER ID   IMAGE     COMMAND   STATUS',\n\t\t\t'images': 'REPOSITORY   TAG       IMAGE ID   SIZE'\n\t\t};\n\n\t\treturn mockCommands[command as keyof typeof mockCommands] || `Executed: docker ${command}`;\n\t}\n\n\tprivate async callGCPAPI(endpoint: string, params: any): Promise<any> {\n\t\t// Simulate GCP API call\n\t\treturn {\n\t\t\tendpoint,\n\t\t\tparams,\n\t\t\tresponse: 'Mock GCP response',\n\t\t\ttimestamp: new Date().toISOString()\n\t\t};\n\t}\n\n\tgetAvailableTools(): Array<{ name: string; description: string; category: string }> {\n\t\tconst tools: Array<{ name: string; description: string; category: string }> = [];\n\n\t\t// Add VS Code extension tools\n\t\tthis.availableExtensions.forEach((ext, id) => {\n\t\t\text.commands.forEach(command => {\n\t\t\t\ttools.push({\n\t\t\t\t\tname: `vscode_${id.replace(/\\./g, '_')}_${command}`,\n\t\t\t\t\tdescription: `${ext.id}: ${command}`,\n\t\t\t\t\tcategory: 'vscode'\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t// Add Kali tools if enabled\n\t\tconst config = this.modelConfig.getConfig();\n\t\tif (config.tools.kali) {\n\t\t\ttools.push(\n\t\t\t\t{\n\t\t\t\t\tname: 'kali_nmap_scan',\n\t\t\t\t\tdescription: 'Network scanning with Nmap',\n\t\t\t\t\tcategory: 'security'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'kali_vulnerability_scan',\n\t\t\t\t\tdescription: 'Vulnerability assessment',\n\t\t\t\t\tcategory: 'security'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\t// Add Docker tools if enabled\n\t\tif (config.tools.docker) {\n\t\t\ttools.push(\n\t\t\t\t{\n\t\t\t\t\tname: 'docker_build',\n\t\t\t\t\tdescription: 'Build Docker image',\n\t\t\t\t\tcategory: 'containerization'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'docker_run',\n\t\t\t\t\tdescription: 'Run Docker container',\n\t\t\t\t\tcategory: 'containerization'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn tools;\n\t}\n\n\tasync checkExtensionAvailability(extensionId: string): Promise<{\n\t\tavailable: boolean;\n\t\tinstalled: boolean;\n\t\tactive: boolean;\n\t\trecommendInstall?: boolean;\n\t}> {\n\t\tconst extension = this.availableExtensions.get(extensionId);\n\n\t\treturn {\n\t\t\tavailable: !!extension,\n\t\t\tinstalled: !!extension,\n\t\t\tactive: extension?.isActive || false,\n\t\t\trecommendInstall: !extension\n\t\t};\n\t}\n}\n","import { EventEmitter } from 'events';\nimport { spawn, ChildProcess } from 'child_process';\nimport * as path from 'path';\nimport * as fs from 'fs/promises';\nimport { ExtensionRecommender } from '../extensions/recommender';\n\nexport interface ContainerConfig {\n\tname: string;\n\timage: string;\n\tports: { host: number; container: number }[];\n\tvolumes: { host: string; container: string; readonly?: boolean }[];\n\tenvironment: Record<string, string>;\n\tresources: {\n\t\tmemory: string;\n\t\tcpuLimit: string;\n\t\tnetworkMode: string;\n\t};\n\tsecurity: {\n\t\tseccompProfile?: string;\n\t\tcapabilities: {\n\t\t\tadd: string[];\n\t\t\tdrop: string[];\n\t\t};\n\t\tuser: string;\n\t\treadonlyRootfs: boolean;\n\t};\n}\n\nexport interface ExtensionSandbox {\n\tcontainerId: string;\n\textensionId: string;\n\tstatus: 'creating' | 'running' | 'stopped' | 'error';\n\tconfig: ContainerConfig;\n\tprocess?: ChildProcess;\n\tcreatedAt: Date;\n\tlastAccessed: Date;\n\tports: number[];\n\tresources: {\n\t\tcpu: number;\n\t\tmemory: number;\n\t\tnetwork: number;\n\t};\n}\n\nexport interface SandboxMetrics {\n\ttotalContainers: number;\n\trunningContainers: number;\n\tmemoryUsage: number;\n\tcpuUsage: number;\n\tnetworkTraffic: number;\n\tsecurityEvents: number;\n\tcontainerHealth: Map<string, boolean>;\n}\n\nexport class DockerManager extends EventEmitter {\n\tprivate containers: Map<string, ExtensionSandbox> = new Map();\n\tprivate imageCache: Map<string, boolean> = new Map();\n\tprivate networkIds: Set<string> = new Set();\n\tprivate metrics: SandboxMetrics;\n\tprivate cleanupInterval?: NodeJS.Timer;\n\tprivate monitoringInterval?: NodeJS.Timer;\n\n\tconstructor(private recommender: ExtensionRecommender) {\n\t\tsuper();\n\n\t\tthis.metrics = {\n\t\t\ttotalContainers: 0,\n\t\t\trunningContainers: 0,\n\t\t\tmemoryUsage: 0,\n\t\t\tcpuUsage: 0,\n\t\t\tnetworkTraffic: 0,\n\t\t\tsecurityEvents: 0,\n\t\t\tcontainerHealth: new Map()\n\t\t};\n\n\t\tthis.initializeDocker();\n\t\tthis.startMonitoring();\n\t\tthis.setupCleanup();\n\t}\n\n\tasync createExtensionSandbox(extensionId: string, config?: Partial<ContainerConfig>): Promise<ExtensionSandbox> {\n\t\tconst sandboxConfig = await this.buildContainerConfig(extensionId, config);\n\t\tconst containerId = this.generateContainerId(extensionId);\n\n\t\t// Check if extension requires special permissions\n\t\tconst extensionInfo = await this.recommender.getExtensionInfo(extensionId);\n\t\tif (extensionInfo?.security?.requiresIsolation) {\n\t\t\tsandboxConfig.security.capabilities.drop.push('NET_RAW', 'SYS_ADMIN');\n\t\t}\n\n\t\tconst sandbox: ExtensionSandbox = {\n\t\t\tcontainerId,\n\t\t\textensionId,\n\t\t\tstatus: 'creating',\n\t\t\tconfig: sandboxConfig,\n\t\t\tcreatedAt: new Date(),\n\t\t\tlastAccessed: new Date(),\n\t\t\tports: sandboxConfig.ports.map(p => p.host),\n\t\t\tresources: {\n\t\t\t\tcpu: 0,\n\t\t\t\tmemory: 0,\n\t\t\t\tnetwork: 0\n\t\t\t}\n\t\t};\n\n\t\tthis.containers.set(containerId, sandbox);\n\t\tthis.emit('sandboxCreating', { containerId, extensionId });\n\n\t\ttry {\n\t\t\t// Build container if image doesn't exist\n\t\t\tawait this.ensureImage(sandboxConfig.image);\n\n\t\t\t// Create and start container\n\t\t\tconst process = await this.startContainer(sandbox);\n\t\t\tsandbox.process = process;\n\t\t\tsandbox.status = 'running';\n\n\t\t\tthis.metrics.totalContainers++;\n\t\t\tthis.metrics.runningContainers++;\n\n\t\t\tthis.emit('sandboxCreated', { containerId, extensionId });\n\t\t\treturn sandbox;\n\n\t\t} catch (error) {\n\t\t\tsandbox.status = 'error';\n\t\t\tthis.emit('sandboxError', {\n\t\t\t\tcontainerId,\n\t\t\t\textensionId,\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t});\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync stopSandbox(containerId: string): Promise<void> {\n\t\tconst sandbox = this.containers.get(containerId);\n\t\tif (!sandbox) {\n\t\t\tthrow new Error(`Sandbox ${containerId} not found`);\n\t\t}\n\n\t\tthis.emit('sandboxStopping', { containerId, extensionId: sandbox.extensionId });\n\n\t\ttry {\n\t\t\t// Stop container gracefully\n\t\t\tawait this.executeDockerCommand(['stop', '-t', '10', containerId]);\n\n\t\t\t// Remove container\n\t\t\tawait this.executeDockerCommand(['rm', containerId]);\n\n\t\t\tsandbox.status = 'stopped';\n\t\t\tif (sandbox.status === 'running') {\n\t\t\t\tthis.metrics.runningContainers--;\n\t\t\t}\n\n\t\t\tthis.emit('sandboxStopped', { containerId, extensionId: sandbox.extensionId });\n\n\t\t} catch (error) {\n\t\t\tthis.emit('sandboxError', {\n\t\t\t\tcontainerId,\n\t\t\t\textensionId: sandbox.extensionId,\n\t\t\t\terror: error instanceof Error ? error.message : 'Failed to stop container'\n\t\t\t});\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync restartSandbox(containerId: string): Promise<void> {\n\t\tconst sandbox = this.containers.get(containerId);\n\t\tif (!sandbox) {\n\t\t\tthrow new Error(`Sandbox ${containerId} not found`);\n\t\t}\n\n\t\tawait this.stopSandbox(containerId);\n\n\t\t// Wait a moment for cleanup\n\t\tawait new Promise(resolve => setTimeout(resolve, 1000));\n\n\t\tconst newSandbox = await this.createExtensionSandbox(sandbox.extensionId, sandbox.config);\n\n\t\t// Update container ID mapping\n\t\tthis.containers.delete(containerId);\n\t\tthis.containers.set(newSandbox.containerId, newSandbox);\n\t}\n\n\tasync executeSandboxCommand(containerId: string, command: string[]): Promise<string> {\n\t\tconst sandbox = this.containers.get(containerId);\n\t\tif (!sandbox || sandbox.status !== 'running') {\n\t\t\tthrow new Error(`Sandbox ${containerId} is not running`);\n\t\t}\n\n\t\tsandbox.lastAccessed = new Date();\n\n\t\ttry {\n\t\t\tconst result = await this.executeDockerCommand(['exec', containerId, ...command]);\n\t\t\tthis.emit('commandExecuted', { containerId, command, success: true });\n\t\t\treturn result;\n\t\t} catch (error) {\n\t\t\tthis.emit('commandExecuted', {\n\t\t\t\tcontainerId,\n\t\t\t\tcommand,\n\t\t\t\tsuccess: false,\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t});\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync copyToSandbox(containerId: string, hostPath: string, containerPath: string): Promise<void> {\n\t\tconst sandbox = this.containers.get(containerId);\n\t\tif (!sandbox || sandbox.status !== 'running') {\n\t\t\tthrow new Error(`Sandbox ${containerId} is not running`);\n\t\t}\n\n\t\ttry {\n\t\t\tawait this.executeDockerCommand(['cp', hostPath, `${containerId}:${containerPath}`]);\n\t\t\tthis.emit('fileCopied', { containerId, hostPath, containerPath, direction: 'to' });\n\t\t} catch (error) {\n\t\t\tthis.emit('copyError', {\n\t\t\t\tcontainerId,\n\t\t\t\thostPath,\n\t\t\t\tcontainerPath,\n\t\t\t\tdirection: 'to',\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t});\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync copyFromSandbox(containerId: string, containerPath: string, hostPath: string): Promise<void> {\n\t\tconst sandbox = this.containers.get(containerId);\n\t\tif (!sandbox || sandbox.status !== 'running') {\n\t\t\tthrow new Error(`Sandbox ${containerId} is not running`);\n\t\t}\n\n\t\ttry {\n\t\t\tawait this.executeDockerCommand(['cp', `${containerId}:${containerPath}`, hostPath]);\n\t\t\tthis.emit('fileCopied', { containerId, containerPath, hostPath, direction: 'from' });\n\t\t} catch (error) {\n\t\t\tthis.emit('copyError', {\n\t\t\t\tcontainerId,\n\t\t\t\tcontainerPath,\n\t\t\t\thostPath,\n\t\t\t\tdirection: 'from',\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t});\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync getSandboxLogs(containerId: string, tail = 100): Promise<string> {\n\t\tconst sandbox = this.containers.get(containerId);\n\t\tif (!sandbox) {\n\t\t\tthrow new Error(`Sandbox ${containerId} not found`);\n\t\t}\n\n\t\ttry {\n\t\t\treturn await this.executeDockerCommand(['logs', '--tail', tail.toString(), containerId]);\n\t\t} catch (error) {\n\t\t\tthrow new Error(`Failed to get logs: ${error instanceof Error ? error.message : 'Unknown error'}`);\n\t\t}\n\t}\n\n\tgetSandboxStatus(containerId: string): ExtensionSandbox | undefined {\n\t\treturn this.containers.get(containerId);\n\t}\n\n\tlistSandboxes(): ExtensionSandbox[] {\n\t\treturn Array.from(this.containers.values());\n\t}\n\n\tgetSandboxesByExtension(extensionId: string): ExtensionSandbox[] {\n\t\treturn Array.from(this.containers.values()).filter(s => s.extensionId === extensionId);\n\t}\n\n\tgetMetrics(): SandboxMetrics {\n\t\treturn { ...this.metrics };\n\t}\n\n\tprivate async buildContainerConfig(\n\t\textensionId: string,\n\t\tcustomConfig?: Partial<ContainerConfig>\n\t): Promise<ContainerConfig> {\n\t\tconst baseConfig: ContainerConfig = {\n\t\t\tname: `vsembed-ext-${extensionId.replace(/[^a-zA-Z0-9]/g, '-')}`,\n\t\t\timage: 'vsembed/extension-runtime:latest',\n\t\t\tports: [\n\t\t\t\t{ host: await this.getAvailablePort(), container: 8080 }\n\t\t\t],\n\t\t\tvolumes: [\n\t\t\t\t{ host: '/tmp/vsembed/workspace', container: '/workspace', readonly: false },\n\t\t\t\t{ host: '/tmp/vsembed/extensions', container: '/extensions', readonly: true }\n\t\t\t],\n\t\t\tenvironment: {\n\t\t\t\t'EXTENSION_ID': extensionId,\n\t\t\t\t'NODE_ENV': 'production',\n\t\t\t\t'VSCODE_EXTENSION_API_VERSION': '1.74.0'\n\t\t\t},\n\t\t\tresources: {\n\t\t\t\tmemory: '512m',\n\t\t\t\tcpuLimit: '0.5',\n\t\t\t\tnetworkMode: 'vsembed-network'\n\t\t\t},\n\t\t\tsecurity: {\n\t\t\t\tcapabilities: {\n\t\t\t\t\tadd: [],\n\t\t\t\t\tdrop: ['ALL']\n\t\t\t\t},\n\t\t\t\tuser: '1000:1000',\n\t\t\t\treadonlyRootfs: true\n\t\t\t}\n\t\t};\n\n\t\t// Apply extension-specific configurations\n\t\tconst extensionInfo = await this.recommender.getExtensionInfo(extensionId);\n\t\tif (extensionInfo) {\n\t\t\tif (extensionInfo.resources?.memory) {\n\t\t\t\tbaseConfig.resources.memory = extensionInfo.resources.memory;\n\t\t\t}\n\t\t\tif (extensionInfo.resources?.cpu) {\n\t\t\t\tbaseConfig.resources.cpuLimit = extensionInfo.resources.cpu;\n\t\t\t}\n\t\t\tif (extensionInfo.security?.requiredCapabilities) {\n\t\t\t\tbaseConfig.security.capabilities.add.push(...extensionInfo.security.requiredCapabilities);\n\t\t\t}\n\t\t}\n\n\t\t// Merge with custom configuration\n\t\treturn this.mergeConfigs(baseConfig, customConfig || {});\n\t}\n\n\tprivate mergeConfigs(base: ContainerConfig, custom: Partial<ContainerConfig>): ContainerConfig {\n\t\treturn {\n\t\t\t...base,\n\t\t\t...custom,\n\t\t\tports: custom.ports || base.ports,\n\t\t\tvolumes: custom.volumes || base.volumes,\n\t\t\tenvironment: { ...base.environment, ...(custom.environment || {}) },\n\t\t\tresources: { ...base.resources, ...(custom.resources || {}) },\n\t\t\tsecurity: {\n\t\t\t\t...base.security,\n\t\t\t\t...(custom.security || {}),\n\t\t\t\tcapabilities: {\n\t\t\t\t\tadd: [...(base.security.capabilities.add || []), ...(custom.security?.capabilities?.add || [])],\n\t\t\t\t\tdrop: [...(base.security.capabilities.drop || []), ...(custom.security?.capabilities?.drop || [])]\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate async ensureImage(imageName: string): Promise<void> {\n\t\tif (this.imageCache.has(imageName)) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\t// Check if image exists locally\n\t\t\tawait this.executeDockerCommand(['inspect', imageName]);\n\t\t\tthis.imageCache.set(imageName, true);\n\t\t} catch (error) {\n\t\t\t// Image doesn't exist, build it\n\t\t\tawait this.buildExtensionImage(imageName);\n\t\t\tthis.imageCache.set(imageName, true);\n\t\t}\n\t}\n\n\tprivate async buildExtensionImage(imageName: string): Promise<void> {\n\t\tthis.emit('imageBuildStarted', { imageName });\n\n\t\t// Create Dockerfile for extension runtime\n\t\tconst dockerfile = this.generateDockerfile();\n\t\tconst buildContext = '/tmp/vsembed/build';\n\n\t\tawait fs.mkdir(buildContext, { recursive: true });\n\t\tawait fs.writeFile(path.join(buildContext, 'Dockerfile'), dockerfile);\n\n\t\ttry {\n\t\t\tawait this.executeDockerCommand(['build', '-t', imageName, buildContext]);\n\t\t\tthis.emit('imageBuildCompleted', { imageName });\n\t\t} catch (error) {\n\t\t\tthis.emit('imageBuildFailed', {\n\t\t\t\timageName,\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t});\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tprivate generateDockerfile(): string {\n\t\treturn `\nFROM node:18-alpine\n\n# Install VS Code dependencies\nRUN apk add --no-cache \\\n    git \\\n    bash \\\n    curl \\\n    python3 \\\n    make \\\n    g++ \\\n    libx11 \\\n    libxkbfile \\\n    libsecret\n\n# Create non-root user\nRUN addgroup -g 1000 vscode && \\\n    adduser -u 1000 -G vscode -s /bin/bash -D vscode\n\n# Install VS Code Server\nRUN curl -fsSL https://code-server.dev/install.sh | sh\n\n# Create workspace directory\nRUN mkdir -p /workspace /extensions /tmp/vscode-extensions\nRUN chown -R vscode:vscode /workspace /extensions /tmp/vscode-extensions\n\n# Copy extension runner script\nCOPY <<EOF /usr/local/bin/run-extension.sh\n#!/bin/bash\nset -e\n\n# Initialize VS Code environment\nexport VSCODE_AGENT_FOLDER=/tmp/vscode-extensions\nexport VSCODE_EXTENSIONS_PATH=/extensions\n\n# Start code-server with extension support\nexec code-server \\\\\n  --bind-addr 0.0.0.0:8080 \\\\\n  --auth none \\\\\n  --disable-telemetry \\\\\n  --extensions-dir /extensions \\\\\n  --user-data-dir /tmp/vscode-user \\\\\n  /workspace\nEOF\n\nRUN chmod +x /usr/local/bin/run-extension.sh\n\n# Switch to non-root user\nUSER vscode\n\n# Set working directory\nWORKDIR /workspace\n\n# Expose port\nEXPOSE 8080\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\\\n  CMD curl -f http://localhost:8080/healthz || exit 1\n\n# Start extension runtime\nCMD [\"/usr/local/bin/run-extension.sh\"]\n`;\n\t}\n\n\tprivate async startContainer(sandbox: ExtensionSandbox): Promise<ChildProcess> {\n\t\tconst { config } = sandbox;\n\n\t\tconst dockerArgs = [\n\t\t\t'run',\n\t\t\t'-d',\n\t\t\t'--name', sandbox.containerId,\n\t\t\t'--memory', config.resources.memory,\n\t\t\t'--cpus', config.resources.cpuLimit,\n\t\t\t'--network', config.resources.networkMode,\n\t\t\t'--user', config.security.user,\n\t\t\t'--security-opt', 'no-new-privileges:true'\n\t\t];\n\n\t\t// Add readonly root filesystem if specified\n\t\tif (config.security.readonlyRootfs) {\n\t\t\tdockerArgs.push('--read-only');\n\t\t\tdockerArgs.push('--tmpfs', '/tmp:exec,size=100m');\n\t\t\tdockerArgs.push('--tmpfs', '/var/tmp:exec,size=100m');\n\t\t}\n\n\t\t// Add capabilities\n\t\tconfig.security.capabilities.drop.forEach(cap => {\n\t\t\tdockerArgs.push('--cap-drop', cap);\n\t\t});\n\t\tconfig.security.capabilities.add.forEach(cap => {\n\t\t\tdockerArgs.push('--cap-add', cap);\n\t\t});\n\n\t\t// Add seccomp profile if specified\n\t\tif (config.security.seccompProfile) {\n\t\t\tdockerArgs.push('--security-opt', `seccomp=${config.security.seccompProfile}`);\n\t\t}\n\n\t\t// Add port mappings\n\t\tconfig.ports.forEach(port => {\n\t\t\tdockerArgs.push('-p', `${port.host}:${port.container}`);\n\t\t});\n\n\t\t// Add volume mounts\n\t\tconfig.volumes.forEach(volume => {\n\t\t\tconst mount = volume.readonly ? `${volume.host}:${volume.container}:ro` : `${volume.host}:${volume.container}`;\n\t\t\tdockerArgs.push('-v', mount);\n\t\t});\n\n\t\t// Add environment variables\n\t\tObject.entries(config.environment).forEach(([key, value]) => {\n\t\t\tdockerArgs.push('-e', `${key}=${value}`);\n\t\t});\n\n\t\t// Add image\n\t\tdockerArgs.push(config.image);\n\n\t\tconst process = spawn('docker', dockerArgs, {\n\t\t\tstdio: ['pipe', 'pipe', 'pipe'],\n\t\t\tdetached: false\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet output = '';\n\t\t\tlet errorOutput = '';\n\n\t\t\tprocess.stdout?.on('data', (data) => {\n\t\t\t\toutput += data.toString();\n\t\t\t});\n\n\t\t\tprocess.stderr?.on('data', (data) => {\n\t\t\t\terrorOutput += data.toString();\n\t\t\t});\n\n\t\t\tprocess.on('close', (code) => {\n\t\t\t\tif (code === 0) {\n\t\t\t\t\tresolve(process);\n\t\t\t\t} else {\n\t\t\t\t\treject(new Error(`Docker container failed to start: ${errorOutput}`));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tprocess.on('error', (error) => {\n\t\t\t\treject(error);\n\t\t\t});\n\n\t\t\t// Timeout after 30 seconds\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!process.killed) {\n\t\t\t\t\tprocess.kill();\n\t\t\t\t\treject(new Error('Container startup timeout'));\n\t\t\t\t}\n\t\t\t}, 30000);\n\t\t});\n\t}\n\n\tprivate async executeDockerCommand(args: string[]): Promise<string> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst process = spawn('docker', args, {\n\t\t\t\tstdio: ['pipe', 'pipe', 'pipe']\n\t\t\t});\n\n\t\t\tlet output = '';\n\t\t\tlet errorOutput = '';\n\n\t\t\tprocess.stdout?.on('data', (data) => {\n\t\t\t\toutput += data.toString();\n\t\t\t});\n\n\t\t\tprocess.stderr?.on('data', (data) => {\n\t\t\t\terrorOutput += data.toString();\n\t\t\t});\n\n\t\t\tprocess.on('close', (code) => {\n\t\t\t\tif (code === 0) {\n\t\t\t\t\tresolve(output.trim());\n\t\t\t\t} else {\n\t\t\t\t\treject(new Error(`Docker command failed: ${errorOutput}`));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tprocess.on('error', (error) => {\n\t\t\t\treject(error);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate async getAvailablePort(): Promise<number> {\n\t\t// Simple port allocation - in production, use proper port management\n\t\treturn 8080 + Math.floor(Math.random() * 1000);\n\t}\n\n\tprivate generateContainerId(extensionId: string): string {\n\t\tconst timestamp = Date.now().toString(36);\n\t\tconst random = Math.random().toString(36).substr(2, 5);\n\t\tconst sanitized = extensionId.replace(/[^a-zA-Z0-9]/g, '-');\n\t\treturn `vsembed-${sanitized}-${timestamp}-${random}`;\n\t}\n\n\tprivate async initializeDocker(): Promise<void> {\n\t\ttry {\n\t\t\t// Check if Docker is available\n\t\t\tawait this.executeDockerCommand(['version']);\n\n\t\t\t// Create custom network for VSEmbed\n\t\t\ttry {\n\t\t\t\tawait this.executeDockerCommand([\n\t\t\t\t\t'network', 'create',\n\t\t\t\t\t'--driver', 'bridge',\n\t\t\t\t\t'--subnet', '172.20.0.0/16',\n\t\t\t\t\t'--opt', 'com.docker.network.bridge.enable_icc=false',\n\t\t\t\t\t'vsembed-network'\n\t\t\t\t]);\n\t\t\t\tthis.networkIds.add('vsembed-network');\n\t\t\t} catch (error) {\n\t\t\t\t// Network might already exist\n\t\t\t\tconsole.log('VSEmbed network already exists or failed to create');\n\t\t\t}\n\n\t\t\tthis.emit('dockerInitialized');\n\t\t} catch (error) {\n\t\t\tthis.emit('dockerError', { error: 'Docker not available' });\n\t\t\tthrow new Error('Docker is not available or not running');\n\t\t}\n\t}\n\n\tprivate startMonitoring(): void {\n\t\tthis.monitoringInterval = setInterval(async () => {\n\t\t\tawait this.updateMetrics();\n\t\t}, 10000); // Every 10 seconds\n\t}\n\n\tprivate async updateMetrics(): Promise<void> {\n\t\ttry {\n\t\t\t// Update container health status\n\t\t\tfor (const [containerId, sandbox] of this.containers) {\n\t\t\t\tif (sandbox.status === 'running') {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst healthOutput = await this.executeDockerCommand(['inspect', '--format={{.State.Health.Status}}', containerId]);\n\t\t\t\t\t\tconst isHealthy = healthOutput.trim() === 'healthy';\n\t\t\t\t\t\tthis.metrics.containerHealth.set(containerId, isHealthy);\n\n\t\t\t\t\t\tif (!isHealthy) {\n\t\t\t\t\t\t\tthis.emit('containerUnhealthy', { containerId, extensionId: sandbox.extensionId });\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tthis.metrics.containerHealth.set(containerId, false);\n\t\t\t\t\t\tthis.emit('containerUnhealthy', { containerId, extensionId: sandbox.extensionId });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update overall metrics\n\t\t\tthis.metrics.runningContainers = Array.from(this.containers.values())\n\t\t\t\t.filter(s => s.status === 'running').length;\n\n\t\t\tthis.emit('metricsUpdated', this.metrics);\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to update Docker metrics:', error);\n\t\t}\n\t}\n\n\tprivate setupCleanup(): void {\n\t\tthis.cleanupInterval = setInterval(async () => {\n\t\t\tawait this.cleanupIdleContainers();\n\t\t}, 60000); // Every minute\n\t}\n\n\tprivate async cleanupIdleContainers(): Promise<void> {\n\t\tconst idleThreshold = 30 * 60 * 1000; // 30 minutes\n\t\tconst now = new Date();\n\n\t\tfor (const [containerId, sandbox] of this.containers) {\n\t\t\tconst idleTime = now.getTime() - sandbox.lastAccessed.getTime();\n\n\t\t\tif (idleTime > idleThreshold && sandbox.status === 'running') {\n\t\t\t\ttry {\n\t\t\t\t\tawait this.stopSandbox(containerId);\n\t\t\t\t\tthis.emit('containerCleaned', { containerId, extensionId: sandbox.extensionId, idleTime });\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error(`Failed to cleanup container ${containerId}:`, error);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async shutdown(): Promise<void> {\n\t\tif (this.cleanupInterval) {\n\t\t\tclearInterval(this.cleanupInterval);\n\t\t}\n\n\t\tif (this.monitoringInterval) {\n\t\t\tclearInterval(this.monitoringInterval);\n\t\t}\n\n\t\t// Stop all running containers\n\t\tconst stopPromises = Array.from(this.containers.keys()).map(containerId =>\n\t\t\tthis.stopSandbox(containerId).catch(console.error)\n\t\t);\n\n\t\tawait Promise.all(stopPromises);\n\n\t\t// Clean up networks\n\t\tfor (const networkId of this.networkIds) {\n\t\t\ttry {\n\t\t\t\tawait this.executeDockerCommand(['network', 'rm', networkId]);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(`Failed to remove network ${networkId}:`, error);\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('shutdown');\n\t}\n}\n","import { ModelConfig, ExtensionRecommendation } from './config';\n\ninterface ExtensionTool {\n\textension: string;\n\tname: string;\n\ttitle: string;\n\tcategory: string;\n\tdescription?: string;\n\tdangerous?: boolean;\n}\n\ninterface WorkspaceContext {\n\tfiles: Array<{ path: string; language?: string }>;\n\tinstalledExtensions: string[];\n\tactiveExtensions: string[];\n\taiTask?: string;\n\tdependencies: Record<string, string>;\n\tgitRepo?: {\n\t\turl: string;\n\t\tbranch: string;\n\t};\n}\n\nexport class ExtensionRecommender {\n\tprivate readonly contextRules: Record<string, string[]> = {\n\t\t// Language-based recommendations\n\t\t'package.json': [\n\t\t\t'esbenp.prettier-vscode',\n\t\t\t'dbaeumer.vscode-eslint',\n\t\t\t'bradlc.vscode-tailwindcss',\n\t\t\t'ms-vscode.vscode-typescript-next'\n\t\t],\n\t\t'*.py': [\n\t\t\t'ms-python.python',\n\t\t\t'ms-python.pylint',\n\t\t\t'ms-python.black-formatter',\n\t\t\t'ms-toolsai.jupyter'\n\t\t],\n\t\t'*.go': ['golang.go'],\n\t\t'*.rs': ['rust-lang.rust-analyzer'],\n\t\t'*.java': ['redhat.java', 'vscjava.vscode-java-pack'],\n\t\t'*.cs': ['ms-dotnettools.csharp'],\n\t\t'*.php': ['bmewburn.vscode-intelephense-client'],\n\t\t'*.rb': ['rebornix.ruby'],\n\n\t\t// Framework-based recommendations\n\t\t'Dockerfile': [\n\t\t\t'ms-azuretools.vscode-docker',\n\t\t\t'ms-kubernetes-tools.vscode-kubernetes-tools'\n\t\t],\n\t\t'docker-compose.yml': ['ms-azuretools.vscode-docker'],\n\t\t'.terraform': ['hashicorp.terraform'],\n\t\t'requirements.txt': ['ms-python.python'],\n\t\t'Cargo.toml': ['rust-lang.rust-analyzer'],\n\t\t'go.mod': ['golang.go'],\n\t\t'pom.xml': ['redhat.java'],\n\t\t'build.gradle': ['redhat.java'],\n\n\t\t// Security and DevOps\n\t\t'.github/workflows': ['github.vscode-github-actions'],\n\t\t'.gitlab-ci.yml': ['gitlab.gitlab-workflow'],\n\t\t'ansible.cfg': ['redhat.ansible'],\n\n\t\t// Database\n\t\t'*.sql': ['ms-mssql.mssql'],\n\t\t'schema.prisma': ['prisma.prisma'],\n\n\t\t// Configuration\n\t\t'.env': ['mikestead.dotenv'],\n\t\t'*.toml': ['tamasfe.even-better-toml'],\n\t\t'*.yaml': ['redhat.vscode-yaml'],\n\t\t'*.yml': ['redhat.vscode-yaml']\n\t};\n\n\tprivate readonly taskBasedRules: Record<string, string[]> = {\n\t\t'docker': ['ms-azuretools.vscode-docker'],\n\t\t'kubernetes': ['ms-kubernetes-tools.vscode-kubernetes-tools'],\n\t\t'security': ['kali-linux.security-tools'],\n\t\t'testing': ['ms-vscode.test-adapter-converter'],\n\t\t'debugging': ['ms-vscode.vscode-js-debug'],\n\t\t'git': ['eamodio.gitlens'],\n\t\t'database': ['ms-mssql.mssql', 'mtxr.sqltools'],\n\t\t'api': ['humao.rest-client', 'ms-vscode.vscode-thunder-client'],\n\t\t'documentation': ['yzhang.markdown-all-in-one', 'shd101wyy.markdown-preview-enhanced']\n\t};\n\n\trecommendExtensions(context: WorkspaceContext): ExtensionRecommendation[] {\n\t\tconst recommendations: ExtensionRecommendation[] = [];\n\n\t\t// File-based recommendations\n\t\tcontext.files.forEach(file => {\n\t\t\tconst matched = Object.entries(this.contextRules)\n\t\t\t\t.filter(([pattern]) => this.matchesPattern(pattern, file.path));\n\n\t\t\tmatched.forEach(([pattern, extIds]) => {\n\t\t\t\textIds.forEach(extId => {\n\t\t\t\t\tif (!context.installedExtensions.includes(extId)) {\n\t\t\t\t\t\trecommendations.push({\n\t\t\t\t\t\t\textensionId: extId,\n\t\t\t\t\t\t\treason: `Recommended for ${this.getFileType(pattern)} files`,\n\t\t\t\t\t\t\turgency: this.getUrgency(extId, pattern),\n\t\t\t\t\t\t\tcategory: this.getCategory(extId),\n\t\t\t\t\t\t\trequiredForTask: file.path\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t// Task-based recommendations\n\t\tif (context.aiTask) {\n\t\t\tconst taskKeywords = context.aiTask.toLowerCase();\n\t\t\tObject.entries(this.taskBasedRules).forEach(([task, extIds]) => {\n\t\t\t\tif (taskKeywords.includes(task)) {\n\t\t\t\t\textIds.forEach(extId => {\n\t\t\t\t\t\tif (!context.installedExtensions.includes(extId)) {\n\t\t\t\t\t\t\trecommendations.push({\n\t\t\t\t\t\t\t\textensionId: extId,\n\t\t\t\t\t\t\t\treason: `Required for ${task} operations`,\n\t\t\t\t\t\t\t\turgency: 'high',\n\t\t\t\t\t\t\t\tcategory: 'task-specific',\n\t\t\t\t\t\t\t\trequiredForTask: context.aiTask\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Dependency-based recommendations\n\t\tObject.entries(context.dependencies).forEach(([dep, version]) => {\n\t\t\tconst extId = this.getDependencyExtension(dep);\n\t\t\tif (extId && !context.installedExtensions.includes(extId)) {\n\t\t\t\trecommendations.push({\n\t\t\t\t\textensionId: extId,\n\t\t\t\t\treason: `Enhances support for ${dep}`,\n\t\t\t\t\turgency: 'medium',\n\t\t\t\t\tcategory: 'dependency',\n\t\t\t\t\trequiredForTask: `${dep}@${version}`\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn this.dedupeAndPrioritize(recommendations);\n\t}\n\n\tprivate matchesPattern(pattern: string, filePath: string): boolean {\n\t\tif (pattern.includes('*')) {\n\t\t\tconst regex = new RegExp(pattern.replace('*', '.*'));\n\t\t\treturn regex.test(filePath);\n\t\t}\n\t\treturn filePath.includes(pattern);\n\t}\n\n\tprivate getFileType(pattern: string): string {\n\t\tif (pattern.includes('.')) {\n\t\t\treturn pattern.split('.').pop() || 'file';\n\t\t}\n\t\treturn pattern;\n\t}\n\n\tprivate getUrgency(extensionId: string, pattern: string): 'low' | 'medium' | 'high' {\n\t\t// Essential language servers are high priority\n\t\tconst essential = [\n\t\t\t'ms-python.python',\n\t\t\t'ms-vscode.vscode-typescript-next',\n\t\t\t'golang.go',\n\t\t\t'rust-lang.rust-analyzer'\n\t\t];\n\n\t\tif (essential.includes(extensionId)) return 'high';\n\n\t\t// Formatters and linters are medium priority\n\t\tif (extensionId.includes('prettier') || extensionId.includes('eslint')) {\n\t\t\treturn 'medium';\n\t\t}\n\n\t\treturn 'low';\n\t}\n\n\tprivate getCategory(extensionId: string): string {\n\t\tif (extensionId.includes('python')) return 'language';\n\t\tif (extensionId.includes('docker')) return 'containerization';\n\t\tif (extensionId.includes('prettier') || extensionId.includes('eslint')) return 'formatting';\n\t\tif (extensionId.includes('git')) return 'version-control';\n\t\treturn 'utility';\n\t}\n\n\tprivate getDependencyExtension(dependency: string): string | null {\n\t\tconst depMap: Record<string, string> = {\n\t\t\t'react': 'ms-vscode.vscode-typescript-next',\n\t\t\t'vue': 'vue.volar',\n\t\t\t'angular': 'angular.ng-template',\n\t\t\t'svelte': 'svelte.svelte-vscode',\n\t\t\t'prisma': 'prisma.prisma',\n\t\t\t'graphql': 'graphql.vscode-graphql',\n\t\t\t'jest': 'orta.vscode-jest',\n\t\t\t'cypress': 'cypress-io.vscode-cypress',\n\t\t\t'tailwindcss': 'bradlc.vscode-tailwindcss'\n\t\t};\n\n\t\treturn depMap[dependency] || null;\n\t}\n\n\tprivate dedupeAndPrioritize(recommendations: ExtensionRecommendation[]): ExtensionRecommendation[] {\n\t\tconst seen = new Set<string>();\n\t\tconst deduped = recommendations.filter(rec => {\n\t\t\tif (seen.has(rec.extensionId)) return false;\n\t\t\tseen.add(rec.extensionId);\n\t\t\treturn true;\n\t\t});\n\n\t\t// Sort by urgency and category\n\t\treturn deduped.sort((a, b) => {\n\t\t\tconst urgencyOrder = { high: 3, medium: 2, low: 1 };\n\t\t\tconst urgencyDiff = urgencyOrder[b.urgency] - urgencyOrder[a.urgency];\n\n\t\t\tif (urgencyDiff !== 0) return urgencyDiff;\n\n\t\t\t// Secondary sort by category importance\n\t\t\tconst categoryOrder = { language: 4, formatting: 3, 'task-specific': 2, utility: 1 };\n\t\t\treturn (categoryOrder[b.category as keyof typeof categoryOrder] || 0) -\n\t\t\t\t(categoryOrder[a.category as keyof typeof categoryOrder] || 0);\n\t\t});\n\t}\n\n\tgetInstallationScript(recommendations: ExtensionRecommendation[]): string[] {\n\t\treturn recommendations.map(rec =>\n\t\t\t`code --install-extension ${rec.extensionId}`\n\t\t);\n\t}\n\n\tgenerateInstallCommand(extensionIds: string[]): string {\n\t\treturn extensionIds\n\t\t\t.map(id => `--install-extension ${id}`)\n\t\t\t.join(' ');\n\t}\n}\n","import { app, BrowserWindow, ipcMain, Menu, dialog } from 'electron';\nimport * as path from 'path';\nimport { AIOrchestratorService } from './services/AIOrchestratorService';\nimport { WorkspaceManager } from './services/WorkspaceManager';\nimport { SecretsManager } from './services/SecretsManager';\nimport { RunnerManager } from './services/RunnerManager';\nimport { SecurityManager } from './services/SecurityManager';\nimport { VSCodeBridge } from '../electron/vscode';\nimport { PermissionMiddleware } from '../permissions/middleware';\nimport { AIStream } from '../ai/streaming';\nimport { PerformanceOptimizer, defaultOptimizationConfig } from '../performance/optimizer';\nimport { DockerManager } from '../docker/sandbox';\nimport { ExtensionRecommender } from '../extensions/recommender';\n\nclass VSEmbedApplication {\n\tprivate mainWindow: BrowserWindow | null = null;\n\tprivate orchestrator: AIOrchestratorService;\n\tprivate workspaceManager: WorkspaceManager;\n\tprivate secretsManager: SecretsManager;\n\tprivate runnerManager: RunnerManager;\n\tprivate securityManager: SecurityManager;\n\tprivate vscodeBridge: VSCodeBridge;\n\tprivate permissionMiddleware: PermissionMiddleware;\n\tprivate aiStream: AIStream;\n\tprivate performanceOptimizer: PerformanceOptimizer;\n\tprivate dockerManager: DockerManager;\n\tprivate extensionRecommender: ExtensionRecommender;\n\n\tconstructor() {\n\t\tthis.orchestrator = new AIOrchestratorService();\n\t\tthis.workspaceManager = new WorkspaceManager();\n\t\tthis.secretsManager = new SecretsManager();\n\t\tthis.runnerManager = new RunnerManager();\n\t\tthis.securityManager = new SecurityManager();\n\n\t\t// Initialize new components - ALL PROPERLY WIRED\n\t\tthis.extensionRecommender = new ExtensionRecommender();\n\t\tthis.vscodeBridge = new VSCodeBridge();\n\t\tthis.permissionMiddleware = new PermissionMiddleware();\n\t\tthis.aiStream = new AIStream(8081);\n\t\tthis.performanceOptimizer = new PerformanceOptimizer(defaultOptimizationConfig);\n\t\tthis.dockerManager = new DockerManager(this.extensionRecommender);\n\n\t\tthis.setupAppHandlers();\n\t\tthis.setupIpcHandlers();\n\t\tthis.setupNewComponentHandlers();\n\t\tthis.setupShutdownHandlers();\n\t}\n\n\tprivate setupAppHandlers(): void {\n\t\tapp.whenReady().then(() => {\n\t\t\tthis.createMainWindow();\n\t\t\tthis.createMenu();\n\t\t});\n\n\t\tapp.on('window-all-closed', () => {\n\t\t\tif (process.platform !== 'darwin') {\n\t\t\t\tapp.quit();\n\t\t\t}\n\t\t});\n\n\t\tapp.on('activate', () => {\n\t\t\tif (BrowserWindow.getAllWindows().length === 0) {\n\t\t\t\tthis.createMainWindow();\n\t\t\t}\n\t\t});\n\n\t\tapp.on('web-contents-created', (event, contents) => {\n\t\t\tcontents.on('new-window', (event, navigationUrl) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tif (!navigationUrl.startsWith('http://localhost:')) {\n\t\t\t\t\tconsole.warn('Blocked navigation to:', navigationUrl);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate createMainWindow(): void {\n\t\tthis.mainWindow = new BrowserWindow({\n\t\t\twidth: 1400,\n\t\t\theight: 900,\n\t\t\tminWidth: 800,\n\t\t\tminHeight: 600,\n\t\t\twebPreferences: {\n\t\t\t\tnodeIntegration: false,\n\t\t\t\tcontextIsolation: true,\n\t\t\t\tenableRemoteModule: false,\n\t\t\t\tpreload: path.join(__dirname, 'preload.js'),\n\t\t\t\twebSecurity: true,\n\t\t\t\tallowRunningInsecureContent: false,\n\t\t\t},\n\t\t\ttitleBarStyle: 'default',\n\t\t\tshow: false,\n\t\t});\n\n\t\tif (process.env.NODE_ENV === 'development') {\n\t\t\tthis.mainWindow.loadURL('http://localhost:3000');\n\t\t\tthis.mainWindow.webContents.openDevTools();\n\t\t} else {\n\t\t\tthis.mainWindow.loadFile(path.join(__dirname, '../renderer/index.html'));\n\t\t}\n\n\t\tthis.mainWindow.once('ready-to-show', () => {\n\t\t\tthis.mainWindow?.show();\n\t\t});\n\n\t\tthis.mainWindow.on('closed', () => {\n\t\t\tthis.mainWindow = null;\n\t\t});\n\t}\n\n\tprivate createMenu(): void {\n\t\tconst template: any[] = [\n\t\t\t{\n\t\t\t\tlabel: 'File',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{ label: 'New Workspace', accelerator: 'CmdOrCtrl+N', click: () => this.handleNewWorkspace() },\n\t\t\t\t\t{ label: 'Open Workspace', accelerator: 'CmdOrCtrl+O', click: () => this.handleOpenWorkspace() },\n\t\t\t\t\t{ label: 'Export Workspace', accelerator: 'CmdOrCtrl+E', click: () => this.handleExportWorkspace() },\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{ label: 'Settings', accelerator: 'CmdOrCtrl+,', click: () => this.handleSettings() },\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{ label: 'Quit', accelerator: process.platform === 'darwin' ? 'Cmd+Q' : 'Ctrl+Q', click: () => app.quit() }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'AI',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{ label: 'Clear Conversation', click: () => this.handleClearConversation() },\n\t\t\t\t\t{ label: 'Change Model', click: () => this.handleChangeModel() },\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{ label: 'AI Settings', click: () => this.handleAISettings() }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'Developer',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{ label: 'Performance Report', click: () => this.handlePerformanceReport() },\n\t\t\t\t\t{ label: 'Docker Status', click: () => this.handleDockerStatus() },\n\t\t\t\t\t{ label: 'Permission Audit', click: () => this.handlePermissionAudit() }\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\tconst menu = Menu.buildFromTemplate(template);\n\t\tMenu.setApplicationMenu(menu);\n\t}\n\n\tprivate setupAppHandlers(): void {\n\t\tapp.whenReady().then(() => {\n\t\t\tthis.createMainWindow();\n\t\t\tthis.createMenu();\n\t\t});\n\n\t\tapp.on('window-all-closed', () => {\n\t\t\tif (process.platform !== 'darwin') {\n\t\t\t\tapp.quit();\n\t\t\t}\n\t\t});\n\n\t\tapp.on('activate', () => {\n\t\t\tif (BrowserWindow.getAllWindows().length === 0) {\n\t\t\t\tthis.createMainWindow();\n\t\t\t}\n\t\t});\n\n\t\t// Security: Prevent new window creation\n\t\tapp.on('web-contents-created', (event, contents) => {\n\t\t\tcontents.on('new-window', (event, navigationUrl) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\t// Only allow navigation to localhost for preview\n\t\t\t\tif (!navigationUrl.startsWith('http://localhost:')) {\n\t\t\t\t\tconsole.warn('Blocked navigation to:', navigationUrl);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate createMainWindow(): void {\n\t\tthis.mainWindow = new BrowserWindow({\n\t\t\twidth: 1400,\n\t\t\theight: 900,\n\t\t\tminWidth: 800,\n\t\t\tminHeight: 600,\n\t\t\twebPreferences: {\n\t\t\t\tnodeIntegration: false,\n\t\t\t\tcontextIsolation: true,\n\t\t\t\tenableRemoteModule: false,\n\t\t\t\tpreload: path.join(__dirname, 'preload.js'),\n\t\t\t\twebSecurity: true,\n\t\t\t\tallowRunningInsecureContent: false,\n\t\t\t},\n\t\t\ttitleBarStyle: 'default',\n\t\t\tshow: false,\n\t\t});\n\n\t\t// Load the React application\n\t\tif (process.env.NODE_ENV === 'development') {\n\t\t\tthis.mainWindow.loadURL('http://localhost:3000');\n\t\t\tthis.mainWindow.webContents.openDevTools();\n\t\t} else {\n\t\t\tthis.mainWindow.loadFile(path.join(__dirname, '../renderer/index.html'));\n\t\t}\n\n\t\tthis.mainWindow.once('ready-to-show', () => {\n\t\t\tthis.mainWindow?.show();\n\t\t});\n\n\t\tthis.mainWindow.on('closed', () => {\n\t\t\tthis.mainWindow = null;\n\t\t});\n\t}\n\n\tprivate createMenu(): void {\n\t\tconst template: any[] = [\n\t\t\t{\n\t\t\t\tlabel: 'File',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'New Workspace',\n\t\t\t\t\t\taccelerator: 'CmdOrCtrl+N',\n\t\t\t\t\t\tclick: () => this.handleNewWorkspace(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Open Workspace',\n\t\t\t\t\t\taccelerator: 'CmdOrCtrl+O',\n\t\t\t\t\t\tclick: () => this.handleOpenWorkspace(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Export Workspace',\n\t\t\t\t\t\taccelerator: 'CmdOrCtrl+E',\n\t\t\t\t\t\tclick: () => this.handleExportWorkspace(),\n\t\t\t\t\t},\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Settings',\n\t\t\t\t\t\taccelerator: 'CmdOrCtrl+,',\n\t\t\t\t\t\tclick: () => this.handleSettings(),\n\t\t\t\t\t},\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Quit',\n\t\t\t\t\t\taccelerator: process.platform === 'darwin' ? 'Cmd+Q' : 'Ctrl+Q',\n\t\t\t\t\t\tclick: () => app.quit(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'Edit',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{ role: 'undo' },\n\t\t\t\t\t{ role: 'redo' },\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{ role: 'cut' },\n\t\t\t\t\t{ role: 'copy' },\n\t\t\t\t\t{ role: 'paste' },\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'AI',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Clear Conversation',\n\t\t\t\t\t\tclick: () => this.handleClearConversation(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Change Model',\n\t\t\t\t\t\tclick: () => this.handleChangeModel(),\n\t\t\t\t\t},\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'AI Settings',\n\t\t\t\t\t\tclick: () => this.handleAISettings(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'Runner',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Start',\n\t\t\t\t\t\taccelerator: 'F5',\n\t\t\t\t\t\tclick: () => this.handleStartRunner(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Stop',\n\t\t\t\t\t\taccelerator: 'Shift+F5',\n\t\t\t\t\t\tclick: () => this.handleStopRunner(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Restart',\n\t\t\t\t\t\taccelerator: 'Ctrl+F5',\n\t\t\t\t\t\tclick: () => this.handleRestartRunner(),\n\t\t\t\t\t},\n\t\t\t\t\t{ type: 'separator' },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'View Logs',\n\t\t\t\t\t\tclick: () => this.handleViewLogs(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'Security',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Manage Secrets',\n\t\t\t\t\t\tclick: () => this.handleManageSecrets(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'View Audit Log',\n\t\t\t\t\t\tclick: () => this.handleViewAuditLog(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Security Settings',\n\t\t\t\t\t\tclick: () => this.handleSecuritySettings(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'Help',\n\t\t\t\tsubmenu: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'About',\n\t\t\t\t\t\tclick: () => this.handleAbout(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Documentation',\n\t\t\t\t\t\tclick: () => this.handleDocumentation(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\tconst menu = Menu.buildFromTemplate(template);\n\t\tMenu.setApplicationMenu(menu);\n\t}\n\n\tprivate setupIpcHandlers(): void {\n\t\t// Workspace operations\n\t\tipcMain.handle('workspace:create', async (event, name: string, template?: string) => {\n\t\t\treturn await this.workspaceManager.createWorkspace(name, template);\n\t\t});\n\n\t\tipcMain.handle('workspace:open', async (event, path: string) => {\n\t\t\treturn await this.workspaceManager.openWorkspace(path);\n\t\t});\n\n\t\tipcMain.handle('workspace:export', async (event, targetPath: string) => {\n\t\t\treturn await this.workspaceManager.exportWorkspace(targetPath);\n\t\t});\n\n\t\tipcMain.handle('workspace:import', async (event, archivePath: string) => {\n\t\t\treturn await this.workspaceManager.importWorkspace(archivePath);\n\t\t});\n\n\t\t// AI Orchestrator operations\n\t\tipcMain.handle('ai:process-request', async (event, userInput: string, context?: any) => {\n\t\t\treturn await this.orchestrator.processRequest(userInput, context);\n\t\t});\n\n\t\tipcMain.handle('ai:execute-plan', async (event, planId: string) => {\n\t\t\treturn await this.orchestrator.executeActionPlan(planId);\n\t\t});\n\n\t\tipcMain.handle('ai:get-models', async () => {\n\t\t\treturn await this.orchestrator.getAvailableModels();\n\t\t});\n\n\t\tipcMain.handle('ai:set-model', async (event, modelName: string) => {\n\t\t\treturn await this.orchestrator.setModel(modelName);\n\t\t});\n\n\t\t// Runner operations\n\t\tipcMain.handle('runner:start', async (event, config?: any) => {\n\t\t\treturn await this.runnerManager.start(config);\n\t\t});\n\n\t\tipcMain.handle('runner:stop', async () => {\n\t\t\treturn await this.runnerManager.stop();\n\t\t});\n\n\t\tipcMain.handle('runner:status', async () => {\n\t\t\treturn await this.runnerManager.status();\n\t\t});\n\n\t\tipcMain.handle('runner:build', async (event, config?: any) => {\n\t\t\treturn await this.runnerManager.build(config);\n\t\t});\n\n\t\t// Secrets operations\n\t\tipcMain.handle('secrets:set', async (event, key: string, value: string) => {\n\t\t\treturn await this.secretsManager.setSecret(key, value);\n\t\t});\n\n\t\tipcMain.handle('secrets:get', async (event, key: string, requester: 'user' | 'ai') => {\n\t\t\treturn await this.secretsManager.getSecret(key, requester);\n\t\t});\n\n\t\tipcMain.handle('secrets:list', async () => {\n\t\t\treturn await this.secretsManager.listSecrets();\n\t\t});\n\n\t\t// Security operations\n\t\tipcMain.handle('security:request-approval', async (event, summary: string, riskLevel: string, details?: any) => {\n\t\t\treturn await this.securityManager.requestApproval(summary, riskLevel, details);\n\t\t});\n\n\t\tipcMain.handle('security:log-action', async (event, actionType: string, metadata: any, riskLevel?: string) => {\n\t\t\treturn await this.securityManager.logAction(actionType, metadata, riskLevel);\n\t\t});\n\t}\n\n\tprivate setupNewComponentHandlers(): void {\n\t\t// VS Code Bridge operations\n\t\tipcMain.handle('vscode:execute-command', async (event, command: string, args?: any[]) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'vscode.commands', { command, args });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn await this.vscodeBridge.executeCommand(command, args);\n\t\t});\n\n\t\tipcMain.handle('vscode:get-file-content', async (event, filePath: string) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'vscode.files.read', { filePath });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn await this.vscodeBridge.getFileContent(filePath);\n\t\t});\n\n\t\tipcMain.handle('vscode:write-file', async (event, filePath: string, content: string) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'vscode.files.write', { filePath, content });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn await this.vscodeBridge.writeFile(filePath, content);\n\t\t});\n\n\t\tipcMain.handle('vscode:get-hover-info', async (event, filePath: string, position: any) => {\n\t\t\treturn await this.vscodeBridge.getHoverInfo(filePath, position);\n\t\t});\n\n\t\tipcMain.handle('vscode:get-completions', async (event, filePath: string, position: any) => {\n\t\t\treturn await this.vscodeBridge.getCompletions(filePath, position);\n\t\t});\n\n\t\tipcMain.handle('vscode:get-definitions', async (event, filePath: string, position: any) => {\n\t\t\treturn await this.vscodeBridge.getDefinitions(filePath, position);\n\t\t});\n\n\t\tipcMain.handle('vscode:get-references', async (event, filePath: string, position: any) => {\n\t\t\treturn await this.vscodeBridge.getReferences(filePath, position);\n\t\t});\n\n\t\t// Extension operations\n\t\tipcMain.handle('extensions:recommend', async (event, context: any) => {\n\t\t\treturn await this.extensionRecommender.recommendExtensions(context);\n\t\t});\n\n\t\tipcMain.handle('extensions:install', async (event, extensionId: string) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'extensions.install', { extensionId });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn await this.extensionRecommender.installExtension(extensionId);\n\t\t});\n\n\t\tipcMain.handle('extensions:get-info', async (event, extensionId: string) => {\n\t\t\treturn await this.extensionRecommender.getExtensionInfo(extensionId);\n\t\t});\n\n\t\t// Docker sandbox operations\n\t\tipcMain.handle('docker:create-sandbox', async (event, extensionId: string, config?: any) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'docker.create', { extensionId, config });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn await this.dockerManager.createExtensionSandbox(extensionId, config);\n\t\t});\n\n\t\tipcMain.handle('docker:stop-sandbox', async (event, containerId: string) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'docker.stop', { containerId });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn await this.dockerManager.stopSandbox(containerId);\n\t\t});\n\n\t\tipcMain.handle('docker:execute-command', async (event, containerId: string, command: string[]) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'docker.execute', { containerId, command });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn await this.dockerManager.executeSandboxCommand(containerId, command);\n\t\t});\n\n\t\tipcMain.handle('docker:get-logs', async (event, containerId: string, tail?: number) => {\n\t\t\treturn await this.dockerManager.getSandboxLogs(containerId, tail);\n\t\t});\n\n\t\tipcMain.handle('docker:list-sandboxes', async () => {\n\t\t\treturn this.dockerManager.listSandboxes();\n\t\t});\n\n\t\tipcMain.handle('docker:get-metrics', async () => {\n\t\t\treturn this.dockerManager.getMetrics();\n\t\t});\n\n\t\t// Performance operations\n\t\tipcMain.handle('performance:get-metrics', async () => {\n\t\t\treturn this.performanceOptimizer.getMetrics();\n\t\t});\n\n\t\tipcMain.handle('performance:generate-report', async () => {\n\t\t\treturn this.performanceOptimizer.generateReport();\n\t\t});\n\n\t\tipcMain.handle('performance:get-recommendations', async () => {\n\t\t\treturn this.performanceOptimizer.getOptimizationRecommendations();\n\t\t});\n\n\t\tipcMain.handle('performance:force-gc', async () => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'performance.gc');\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn this.performanceOptimizer.forceGarbageCollection();\n\t\t});\n\n\t\t// Permission middleware operations\n\t\tipcMain.handle('permissions:check', async (event, actor: string, resource: string, context?: any) => {\n\t\t\treturn await this.permissionMiddleware.checkPermission(actor, resource, context);\n\t\t});\n\n\t\tipcMain.handle('permissions:get-policies', async () => {\n\t\t\treturn this.permissionMiddleware.getPolicies();\n\t\t});\n\n\t\tipcMain.handle('permissions:update-policy', async (event, policyId: string, updates: any) => {\n\t\t\tconst permission = await this.permissionMiddleware.checkPermission('user', 'permissions.policy.update', { policyId, updates });\n\t\t\tif (!permission.allowed) {\n\t\t\t\tthrow new Error(`Permission denied: ${permission.reason}`);\n\t\t\t}\n\t\t\treturn this.permissionMiddleware.updatePolicy(policyId, updates);\n\t\t});\n\n\t\tipcMain.handle('permissions:get-audit-log', async (event, filters?: any) => {\n\t\t\treturn this.permissionMiddleware.getAuditLog(filters);\n\t\t});\n\n\t\t// AI Streaming operations\n\t\tipcMain.handle('ai-stream:get-connection-info', async () => {\n\t\t\treturn {\n\t\t\t\tport: 8081,\n\t\t\t\turl: 'ws://localhost:8081',\n\t\t\t\tconnections: this.aiStream.getActiveConnections(),\n\t\t\t\tstreams: this.aiStream.getActiveStreams()\n\t\t\t};\n\t\t});\n\n\t\t// Event forwarding from components\n\t\tthis.setupEventForwarding();\n\t}\n\n\tprivate setupEventForwarding(): void {\n\t\t// Forward Docker events to renderer\n\t\tthis.dockerManager.on('sandboxCreated', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('docker:sandbox-created', data);\n\t\t});\n\n\t\tthis.dockerManager.on('sandboxStopped', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('docker:sandbox-stopped', data);\n\t\t});\n\n\t\tthis.dockerManager.on('sandboxError', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('docker:sandbox-error', data);\n\t\t});\n\n\t\t// Forward performance events to renderer\n\t\tthis.performanceOptimizer.on('memoryUpdate', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('performance:memory-update', data);\n\t\t});\n\n\t\tthis.performanceOptimizer.on('timing', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('performance:timing', data);\n\t\t});\n\n\t\t// Forward permission events to renderer\n\t\tthis.permissionMiddleware.on('permissionDenied', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('permissions:denied', data);\n\t\t});\n\n\t\tthis.permissionMiddleware.on('auditEvent', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('permissions:audit-event', data);\n\t\t});\n\n\t\t// Forward VS Code bridge events to renderer\n\t\tthis.vscodeBridge.on('extensionInstalled', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('vscode:extension-installed', data);\n\t\t});\n\n\t\tthis.vscodeBridge.on('languageServerReady', (data) => {\n\t\t\tthis.mainWindow?.webContents.send('vscode:language-server-ready', data);\n\t\t});\n\t}\n\n\t// Menu handlers\n\tprivate async handleNewWorkspace(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('menu:new-workspace');\n\t}\n\n\tprivate async handleOpenWorkspace(): Promise<void> {\n\t\tconst result = await dialog.showOpenDialog(this.mainWindow!, {\n\t\t\tproperties: ['openDirectory'],\n\t\t\ttitle: 'Select Workspace Directory',\n\t\t});\n\n\t\tif (!result.canceled && result.filePaths.length > 0) {\n\t\t\tconst workspacePath = result.filePaths[0];\n\t\t\tthis.mainWindow?.webContents.send('workspace:open', workspacePath);\n\t\t}\n\t}\n\n\tprivate async handleExportWorkspace(): Promise<void> {\n\t\tconst result = await dialog.showSaveDialog(this.mainWindow!, {\n\t\t\ttitle: 'Export Workspace',\n\t\t\tdefaultPath: 'workspace.tar.gz',\n\t\t\tfilters: [\n\t\t\t\t{ name: 'Workspace Archive', extensions: ['tar.gz', 'zip'] },\n\t\t\t],\n\t\t});\n\n\t\tif (!result.canceled && result.filePath) {\n\t\t\tthis.mainWindow?.webContents.send('workspace:export', result.filePath);\n\t\t}\n\t}\n\n\tprivate async handleSettings(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('menu:settings');\n\t}\n\n\tprivate async handleClearConversation(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('ai:clear-conversation');\n\t}\n\n\tprivate async handleChangeModel(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('ai:change-model');\n\t}\n\n\tprivate async handleAISettings(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('ai:settings');\n\t}\n\n\tprivate async handleStartRunner(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('runner:start');\n\t}\n\n\tprivate async handleStopRunner(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('runner:stop');\n\t}\n\n\tprivate async handleRestartRunner(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('runner:restart');\n\t}\n\n\tprivate async handleViewLogs(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('runner:view-logs');\n\t}\n\n\tprivate async handleManageSecrets(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('security:manage-secrets');\n\t}\n\n\tprivate async handleViewAuditLog(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('security:view-audit-log');\n\t}\n\n\tprivate async handleSecuritySettings(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('security:settings');\n\t}\n\n\tprivate async handlePerformanceReport(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('performance:report');\n\t}\n\n\tprivate async handleDockerStatus(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('docker:status');\n\t}\n\n\tprivate async handlePermissionAudit(): Promise<void> {\n\t\tthis.mainWindow?.webContents.send('permissions:audit');\n\t}\n\n\tprivate async handleAbout(): Promise<void> {\n\t\tdialog.showMessageBox(this.mainWindow!, {\n\t\t\ttype: 'info',\n\t\t\ttitle: 'About VSEmbed AI DevTool',\n\t\t\tmessage: 'VSEmbed AI DevTool',\n\t\t\tdetail: 'Portable, embeddable AI-powered development environment\\nVersion 0.1.0\\nCopyright (c) 2025 Sheewi',\n\t\t});\n\t}\n\n\tprivate async handleDocumentation(): Promise<void> {\n\t\t// Open documentation URL\n\t\trequire('electron').shell.openExternal('https://github.com/Sheewi/VsEmbed#readme');\n\t}\n}\n\n// Initialize the application\nnew VSEmbedApplication();\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = \"./src/performance sync recursive\";\nmodule.exports = webpackEmptyContext;","import { EventEmitter } from 'events';\nimport * as vscode from 'vscode';\nimport { LRUCache } from 'lru-cache';\n\nexport interface CacheEntry<T = any> {\n\tkey: string;\n\tvalue: T;\n\ttimestamp: number;\n\thits: number;\n\tsize: number;\n\tttl?: number;\n}\n\nexport interface PerformanceMetrics {\n\tcacheHits: number;\n\tcacheMisses: number;\n\tcacheHitRate: number;\n\tmemoryUsage: NodeJS.MemoryUsage;\n\tcpuUsage: NodeJS.CpuUsage;\n\tlazyLoadedModules: string[];\n\tperformanceTimings: Map<string, number>;\n\tresourceUsage: {\n\t\textensions: number;\n\t\tlanguageServers: number;\n\t\tworkers: number;\n\t\twebviews: number;\n\t};\n}\n\nexport interface OptimizationConfig {\n\tcache: {\n\t\tmaxSize: number;\n\t\tttl: number;\n\t\tenableCompression: boolean;\n\t\tpersistToDisk: boolean;\n\t};\n\tlazyLoading: {\n\t\tenabled: boolean;\n\t\tpreloadThreshold: number;\n\t\tmodulePattern: RegExp[];\n\t};\n\tmemoryManagement: {\n\t\tgcThreshold: number;\n\t\tmaxHeapSize: number;\n\t\tenableMonitoring: boolean;\n\t};\n\tresourcePooling: {\n\t\tmaxWorkers: number;\n\t\tmaxLanguageServers: number;\n\t\tworkerIdleTimeout: number;\n\t};\n}\n\nclass IntelligentCache<T = any> extends EventEmitter {\n\tprivate cache: LRUCache<string, CacheEntry<T>>;\n\tprivate accessPatterns: Map<string, number[]> = new Map();\n\tprivate compressionEnabled: boolean;\n\tprivate persistPath?: string;\n\n\tconstructor(private config: OptimizationConfig['cache']) {\n\t\tsuper();\n\n\t\tthis.cache = new LRUCache({\n\t\t\tmax: config.maxSize,\n\t\t\tttl: config.ttl,\n\t\t\tupdateAgeOnGet: true,\n\t\t\tallowStale: false,\n\t\t\tsizeCalculation: (entry: CacheEntry<T>) => entry.size\n\t\t});\n\n\t\tthis.compressionEnabled = config.enableCompression;\n\n\t\tif (config.persistToDisk) {\n\t\t\tthis.setupPersistence();\n\t\t}\n\n\t\tthis.setupMonitoring();\n\t}\n\n\tset(key: string, value: T, ttl?: number): void {\n\t\tconst entry: CacheEntry<T> = {\n\t\t\tkey,\n\t\t\tvalue,\n\t\t\ttimestamp: Date.now(),\n\t\t\thits: 0,\n\t\t\tsize: this.calculateSize(value),\n\t\t\tttl\n\t\t};\n\n\t\t// Track access patterns\n\t\tthis.recordAccess(key);\n\n\t\tthis.cache.set(key, entry);\n\t\tthis.emit('set', { key, size: entry.size });\n\t}\n\n\tget(key: string): T | undefined {\n\t\tconst entry = this.cache.get(key);\n\n\t\tif (entry) {\n\t\t\tentry.hits++;\n\t\t\tthis.recordAccess(key);\n\t\t\tthis.emit('hit', { key, hits: entry.hits });\n\t\t\treturn entry.value;\n\t\t}\n\n\t\tthis.emit('miss', { key });\n\t\treturn undefined;\n\t}\n\n\thas(key: string): boolean {\n\t\treturn this.cache.has(key);\n\t}\n\n\tdelete(key: string): boolean {\n\t\tconst deleted = this.cache.delete(key);\n\t\tif (deleted) {\n\t\t\tthis.emit('delete', { key });\n\t\t}\n\t\treturn deleted;\n\t}\n\n\tclear(): void {\n\t\tthis.cache.clear();\n\t\tthis.accessPatterns.clear();\n\t\tthis.emit('clear');\n\t}\n\n\tgetStats(): {\n\t\tsize: number;\n\t\tmaxSize: number;\n\t\thitRate: number;\n\t\tmemoryUsage: number;\n\t} {\n\t\tconst hits = Array.from(this.cache.values()).reduce((sum, entry) => sum + entry.hits, 0);\n\t\tconst totalRequests = hits + this.cache.size;\n\n\t\treturn {\n\t\t\tsize: this.cache.size,\n\t\t\tmaxSize: this.cache.max,\n\t\t\thitRate: totalRequests > 0 ? hits / totalRequests : 0,\n\t\t\tmemoryUsage: this.cache.calculatedSize || 0\n\t\t};\n\t}\n\n\t// Predictive caching based on access patterns\n\tgetPredictedKeys(): string[] {\n\t\tconst predictions: { key: string; score: number }[] = [];\n\n\t\tthis.accessPatterns.forEach((accesses, key) => {\n\t\t\tif (accesses.length >= 3) {\n\t\t\t\t// Calculate frequency and recency score\n\t\t\t\tconst now = Date.now();\n\t\t\t\tconst recentAccesses = accesses.filter(time => now - time < 300000); // 5 minutes\n\t\t\t\tconst frequency = recentAccesses.length / accesses.length;\n\t\t\t\tconst recency = Math.max(0, 1 - (now - Math.max(...accesses)) / 300000);\n\n\t\t\t\tpredictions.push({\n\t\t\t\t\tkey,\n\t\t\t\t\tscore: frequency * 0.7 + recency * 0.3\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn predictions\n\t\t\t.sort((a, b) => b.score - a.score)\n\t\t\t.slice(0, 10)\n\t\t\t.map(p => p.key);\n\t}\n\n\tprivate recordAccess(key: string): void {\n\t\tconst accesses = this.accessPatterns.get(key) || [];\n\t\taccesses.push(Date.now());\n\n\t\t// Keep only last 50 accesses\n\t\tif (accesses.length > 50) {\n\t\t\taccesses.splice(0, accesses.length - 50);\n\t\t}\n\n\t\tthis.accessPatterns.set(key, accesses);\n\t}\n\n\tprivate calculateSize(value: any): number {\n\t\treturn JSON.stringify(value).length;\n\t}\n\n\tprivate setupPersistence(): void {\n\t\t// Simplified persistence - in production, use proper serialization\n\t\tthis.persistPath = vscode.workspace.getConfiguration().get('vsembed.cache.path') as string;\n\t}\n\n\tprivate setupMonitoring(): void {\n\t\tsetInterval(() => {\n\t\t\tconst stats = this.getStats();\n\t\t\tthis.emit('stats', stats);\n\n\t\t\t// Auto-cleanup if memory usage is high\n\t\t\tif (stats.memoryUsage > this.config.maxSize * 0.9) {\n\t\t\t\tthis.performCleanup();\n\t\t\t}\n\t\t}, 30000); // Every 30 seconds\n\t}\n\n\tprivate performCleanup(): void {\n\t\t// Remove least recently used items with low hit rates\n\t\tconst entries = Array.from(this.cache.entries());\n\t\tconst candidates = entries\n\t\t\t.map(([key, entry]) => ({ key, entry }))\n\t\t\t.filter(({ entry }) => entry.hits < 2)\n\t\t\t.sort((a, b) => a.entry.timestamp - b.entry.timestamp);\n\n\t\tconst toRemove = Math.min(candidates.length, Math.floor(this.cache.size * 0.1));\n\t\tfor (let i = 0; i < toRemove; i++) {\n\t\t\tthis.cache.delete(candidates[i].key);\n\t\t}\n\n\t\tthis.emit('cleanup', { removed: toRemove });\n\t}\n}\n\nclass LazyModuleLoader extends EventEmitter {\n\tprivate loadedModules: Set<string> = new Set();\n\tprivate preloadQueue: string[] = [];\n\tprivate isLoading: Map<string, Promise<any>> = new Map();\n\n\tconstructor(private config: OptimizationConfig['lazyLoading']) {\n\t\tsuper();\n\t\tthis.setupPreloading();\n\t}\n\n\tasync loadModule(modulePath: string): Promise<any> {\n\t\tif (this.loadedModules.has(modulePath)) {\n\t\t\tthis.emit('hit', { module: modulePath });\n\t\t\treturn require(modulePath);\n\t\t}\n\n\t\t// Check if already loading\n\t\tconst existingLoad = this.isLoading.get(modulePath);\n\t\tif (existingLoad) {\n\t\t\treturn existingLoad;\n\t\t}\n\n\t\tconst loadPromise = this.performLoad(modulePath);\n\t\tthis.isLoading.set(modulePath, loadPromise);\n\n\t\ttry {\n\t\t\tconst module = await loadPromise;\n\t\t\tthis.loadedModules.add(modulePath);\n\t\t\tthis.emit('load', { module: modulePath });\n\t\t\treturn module;\n\t\t} finally {\n\t\t\tthis.isLoading.delete(modulePath);\n\t\t}\n\t}\n\n\tpreloadModule(modulePath: string): void {\n\t\tif (!this.loadedModules.has(modulePath) && !this.preloadQueue.includes(modulePath)) {\n\t\t\tthis.preloadQueue.push(modulePath);\n\t\t\tthis.processPreloadQueue();\n\t\t}\n\t}\n\n\tisModuleLoaded(modulePath: string): boolean {\n\t\treturn this.loadedModules.has(modulePath);\n\t}\n\n\tgetLoadedModules(): string[] {\n\t\treturn Array.from(this.loadedModules);\n\t}\n\n\tprivate async performLoad(modulePath: string): Promise<any> {\n\t\tconst startTime = performance.now();\n\n\t\ttry {\n\t\t\tconst module = await import(modulePath);\n\t\t\tconst loadTime = performance.now() - startTime;\n\n\t\t\tthis.emit('loadComplete', {\n\t\t\t\tmodule: modulePath,\n\t\t\t\tloadTime,\n\t\t\t\tsuccess: true\n\t\t\t});\n\n\t\t\treturn module;\n\t\t} catch (error) {\n\t\t\tconst loadTime = performance.now() - startTime;\n\n\t\t\tthis.emit('loadComplete', {\n\t\t\t\tmodule: modulePath,\n\t\t\t\tloadTime,\n\t\t\t\tsuccess: false,\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t});\n\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tprivate setupPreloading(): void {\n\t\tif (!this.config.enabled) return;\n\n\t\t// Preload based on usage patterns\n\t\tsetInterval(() => {\n\t\t\tthis.processPreloadQueue();\n\t\t}, 5000);\n\t}\n\n\tprivate async processPreloadQueue(): Promise<void> {\n\t\tif (this.preloadQueue.length === 0) return;\n\n\t\tconst module = this.preloadQueue.shift()!;\n\n\t\ttry {\n\t\t\tawait this.loadModule(module);\n\t\t} catch (error) {\n\t\t\tconsole.warn(`Failed to preload module ${module}:`, error);\n\t\t}\n\t}\n}\n\nclass ResourcePool extends EventEmitter {\n\tprivate workers: Worker[] = [];\n\tprivate availableWorkers: Worker[] = [];\n\tprivate workerTasks: Map<Worker, any> = new Map();\n\tprivate languageServers: Map<string, any> = new Map();\n\tprivate webviews: Set<vscode.WebviewPanel> = new Set();\n\n\tconstructor(private config: OptimizationConfig['resourcePooling']) {\n\t\tsuper();\n\t\tthis.initializeWorkerPool();\n\t\tthis.setupCleanup();\n\t}\n\n\tasync getWorker(): Promise<Worker> {\n\t\tif (this.availableWorkers.length > 0) {\n\t\t\tconst worker = this.availableWorkers.pop()!;\n\t\t\tthis.emit('workerAssigned', { workerId: this.getWorkerId(worker) });\n\t\t\treturn worker;\n\t\t}\n\n\t\tif (this.workers.length < this.config.maxWorkers) {\n\t\t\tconst worker = await this.createWorker();\n\t\t\tthis.workers.push(worker);\n\t\t\tthis.emit('workerCreated', { workerId: this.getWorkerId(worker) });\n\t\t\treturn worker;\n\t\t}\n\n\t\t// Wait for available worker\n\t\treturn new Promise((resolve) => {\n\t\t\tconst checkAvailable = () => {\n\t\t\t\tif (this.availableWorkers.length > 0) {\n\t\t\t\t\tconst worker = this.availableWorkers.pop()!;\n\t\t\t\t\tthis.emit('workerAssigned', { workerId: this.getWorkerId(worker) });\n\t\t\t\t\tresolve(worker);\n\t\t\t\t} else {\n\t\t\t\t\tsetTimeout(checkAvailable, 100);\n\t\t\t\t}\n\t\t\t};\n\t\t\tcheckAvailable();\n\t\t});\n\t}\n\n\treleaseWorker(worker: Worker): void {\n\t\tconst task = this.workerTasks.get(worker);\n\t\tif (task) {\n\t\t\tthis.workerTasks.delete(worker);\n\t\t}\n\n\t\tthis.availableWorkers.push(worker);\n\t\tthis.emit('workerReleased', { workerId: this.getWorkerId(worker) });\n\t}\n\n\tasync getLanguageServer(languageId: string): Promise<any> {\n\t\tif (this.languageServers.has(languageId)) {\n\t\t\tthis.emit('languageServerHit', { languageId });\n\t\t\treturn this.languageServers.get(languageId);\n\t\t}\n\n\t\tif (this.languageServers.size >= this.config.maxLanguageServers) {\n\t\t\t// Remove least recently used\n\t\t\tconst lru = Array.from(this.languageServers.keys())[0];\n\t\t\tthis.languageServers.delete(lru);\n\t\t\tthis.emit('languageServerEvicted', { languageId: lru });\n\t\t}\n\n\t\tconst server = await this.createLanguageServer(languageId);\n\t\tthis.languageServers.set(languageId, server);\n\t\tthis.emit('languageServerCreated', { languageId });\n\n\t\treturn server;\n\t}\n\n\tregisterWebview(webview: vscode.WebviewPanel): void {\n\t\tthis.webviews.add(webview);\n\n\t\twebview.onDidDispose(() => {\n\t\t\tthis.webviews.delete(webview);\n\t\t\tthis.emit('webviewDisposed', { title: webview.title });\n\t\t});\n\n\t\tthis.emit('webviewRegistered', { title: webview.title });\n\t}\n\n\tgetResourceUsage(): PerformanceMetrics['resourceUsage'] {\n\t\treturn {\n\t\t\textensions: 0, // Would track actual extension instances\n\t\t\tlanguageServers: this.languageServers.size,\n\t\t\tworkers: this.workers.length,\n\t\t\twebviews: this.webviews.size\n\t\t};\n\t}\n\n\tprivate async createWorker(): Promise<Worker> {\n\t\t// In a real implementation, this would create an actual Worker\n\t\t// For now, return a mock worker object\n\t\treturn {} as Worker;\n\t}\n\n\tprivate async createLanguageServer(languageId: string): Promise<any> {\n\t\t// In a real implementation, this would start the language server\n\t\treturn { languageId, startTime: Date.now() };\n\t}\n\n\tprivate getWorkerId(worker: Worker): string {\n\t\treturn `worker_${this.workers.indexOf(worker)}`;\n\t}\n\n\tprivate initializeWorkerPool(): void {\n\t\t// Pre-create some workers\n\t\tconst initialWorkers = Math.min(2, this.config.maxWorkers);\n\t\tfor (let i = 0; i < initialWorkers; i++) {\n\t\t\tthis.createWorker().then(worker => {\n\t\t\t\tthis.workers.push(worker);\n\t\t\t\tthis.availableWorkers.push(worker);\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate setupCleanup(): void {\n\t\tsetInterval(() => {\n\t\t\tthis.cleanupIdleResources();\n\t\t}, 60000); // Every minute\n\t}\n\n\tprivate cleanupIdleResources(): void {\n\t\tconst now = Date.now();\n\n\t\t// Cleanup idle language servers\n\t\tthis.languageServers.forEach((server, languageId) => {\n\t\t\tif (now - server.startTime > this.config.workerIdleTimeout) {\n\t\t\t\tthis.languageServers.delete(languageId);\n\t\t\t\tthis.emit('languageServerCleanup', { languageId });\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport class PerformanceOptimizer extends EventEmitter {\n\tprivate cache: IntelligentCache;\n\tprivate lazyLoader: LazyModuleLoader;\n\tprivate resourcePool: ResourcePool;\n\tprivate metrics: PerformanceMetrics;\n\tprivate performanceTimings: Map<string, number> = new Map();\n\tprivate memoryMonitor?: NodeJS.Timer;\n\n\tconstructor(private config: OptimizationConfig) {\n\t\tsuper();\n\n\t\tthis.cache = new IntelligentCache(config.cache);\n\t\tthis.lazyLoader = new LazyModuleLoader(config.lazyLoading);\n\t\tthis.resourcePool = new ResourcePool(config.resourcePooling);\n\n\t\tthis.metrics = {\n\t\t\tcacheHits: 0,\n\t\t\tcacheMisses: 0,\n\t\t\tcacheHitRate: 0,\n\t\t\tmemoryUsage: process.memoryUsage(),\n\t\t\tcpuUsage: process.cpuUsage(),\n\t\t\tlazyLoadedModules: [],\n\t\t\tperformanceTimings: new Map(),\n\t\t\tresourceUsage: {\n\t\t\t\textensions: 0,\n\t\t\t\tlanguageServers: 0,\n\t\t\t\tworkers: 0,\n\t\t\t\twebviews: 0\n\t\t\t}\n\t\t};\n\n\t\tthis.setupEventListeners();\n\t\tthis.startMonitoring();\n\t}\n\n\t// Cache operations\n\tcacheSet(key: string, value: any, ttl?: number): void {\n\t\tthis.cache.set(key, value, ttl);\n\t}\n\n\tcacheGet<T = any>(key: string): T | undefined {\n\t\treturn this.cache.get(key);\n\t}\n\n\tcacheHas(key: string): boolean {\n\t\treturn this.cache.has(key);\n\t}\n\n\tcacheDelete(key: string): boolean {\n\t\treturn this.cache.delete(key);\n\t}\n\n\tcacheClear(): void {\n\t\tthis.cache.clear();\n\t}\n\n\t// Lazy loading operations\n\tasync loadModule(modulePath: string): Promise<any> {\n\t\treturn this.lazyLoader.loadModule(modulePath);\n\t}\n\n\tpreloadModule(modulePath: string): void {\n\t\tthis.lazyLoader.preloadModule(modulePath);\n\t}\n\n\t// Resource pool operations\n\tasync getWorker(): Promise<Worker> {\n\t\treturn this.resourcePool.getWorker();\n\t}\n\n\treleaseWorker(worker: Worker): void {\n\t\tthis.resourcePool.releaseWorker(worker);\n\t}\n\n\tasync getLanguageServer(languageId: string): Promise<any> {\n\t\treturn this.resourcePool.getLanguageServer(languageId);\n\t}\n\n\tregisterWebview(webview: vscode.WebviewPanel): void {\n\t\tthis.resourcePool.registerWebview(webview);\n\t}\n\n\t// Performance measurement\n\tstartTiming(operation: string): void {\n\t\tthis.performanceTimings.set(operation, performance.now());\n\t}\n\n\tendTiming(operation: string): number {\n\t\tconst startTime = this.performanceTimings.get(operation);\n\t\tif (startTime) {\n\t\t\tconst duration = performance.now() - startTime;\n\t\t\tthis.performanceTimings.delete(operation);\n\t\t\tthis.emit('timing', { operation, duration });\n\t\t\treturn duration;\n\t\t}\n\t\treturn 0;\n\t}\n\n\t// Memory management\n\tforceGarbageCollection(): void {\n\t\tif (global.gc) {\n\t\t\tglobal.gc();\n\t\t\tthis.emit('gc', { timestamp: Date.now() });\n\t\t}\n\t}\n\n\tcheckMemoryUsage(): NodeJS.MemoryUsage {\n\t\tconst usage = process.memoryUsage();\n\n\t\tif (usage.heapUsed > this.config.memoryManagement.gcThreshold) {\n\t\t\tthis.forceGarbageCollection();\n\t\t}\n\n\t\treturn usage;\n\t}\n\n\t// Analytics and reporting\n\tgetMetrics(): PerformanceMetrics {\n\t\tconst cacheStats = this.cache.getStats();\n\n\t\tthis.metrics.cacheHits = cacheStats.hitRate * cacheStats.size;\n\t\tthis.metrics.cacheMisses = cacheStats.size - this.metrics.cacheHits;\n\t\tthis.metrics.cacheHitRate = cacheStats.hitRate;\n\t\tthis.metrics.memoryUsage = this.checkMemoryUsage();\n\t\tthis.metrics.cpuUsage = process.cpuUsage();\n\t\tthis.metrics.lazyLoadedModules = this.lazyLoader.getLoadedModules();\n\t\tthis.metrics.resourceUsage = this.resourcePool.getResourceUsage();\n\t\tthis.metrics.performanceTimings = new Map(this.performanceTimings);\n\n\t\treturn { ...this.metrics };\n\t}\n\n\tgenerateReport(): string {\n\t\tconst metrics = this.getMetrics();\n\n\t\treturn `\nVSEmbed Performance Report\n=========================\n\nCache Performance:\n- Hit Rate: ${(metrics.cacheHitRate * 100).toFixed(2)}%\n- Total Hits: ${metrics.cacheHits}\n- Total Misses: ${metrics.cacheMisses}\n\nMemory Usage:\n- Heap Used: ${(metrics.memoryUsage.heapUsed / 1024 / 1024).toFixed(2)} MB\n- Heap Total: ${(metrics.memoryUsage.heapTotal / 1024 / 1024).toFixed(2)} MB\n- External: ${(metrics.memoryUsage.external / 1024 / 1024).toFixed(2)} MB\n- RSS: ${(metrics.memoryUsage.rss / 1024 / 1024).toFixed(2)} MB\n\nResource Usage:\n- Active Workers: ${metrics.resourceUsage.workers}\n- Language Servers: ${metrics.resourceUsage.languageServers}\n- Webviews: ${metrics.resourceUsage.webviews}\n\nLazy Loaded Modules: ${metrics.lazyLoadedModules.length}\n${metrics.lazyLoadedModules.map(m => `- ${m}`).join('\\n')}\n\nPerformance Timings:\n${Array.from(metrics.performanceTimings.entries()).map(([op, time]) =>\n\t\t\t`- ${op}: ${time.toFixed(2)}ms`\n\t\t).join('\\n')}\n`;\n\t}\n\n\t// Optimization recommendations\n\tgetOptimizationRecommendations(): string[] {\n\t\tconst recommendations: string[] = [];\n\t\tconst metrics = this.getMetrics();\n\n\t\tif (metrics.cacheHitRate < 0.7) {\n\t\t\trecommendations.push('Consider increasing cache size or TTL for better hit rates');\n\t\t}\n\n\t\tif (metrics.memoryUsage.heapUsed > this.config.memoryManagement.maxHeapSize * 0.8) {\n\t\t\trecommendations.push('Memory usage is high - consider enabling more aggressive garbage collection');\n\t\t}\n\n\t\tif (metrics.resourceUsage.languageServers > 5) {\n\t\t\trecommendations.push('Many language servers active - consider reducing concurrent servers');\n\t\t}\n\n\t\tif (metrics.lazyLoadedModules.length < 10) {\n\t\t\trecommendations.push('Enable more aggressive lazy loading to improve startup performance');\n\t\t}\n\n\t\treturn recommendations;\n\t}\n\n\tprivate setupEventListeners(): void {\n\t\tthis.cache.on('hit', () => this.metrics.cacheHits++);\n\t\tthis.cache.on('miss', () => this.metrics.cacheMisses++);\n\n\t\tthis.lazyLoader.on('load', (data) => {\n\t\t\tif (!this.metrics.lazyLoadedModules.includes(data.module)) {\n\t\t\t\tthis.metrics.lazyLoadedModules.push(data.module);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate startMonitoring(): void {\n\t\tif (this.config.memoryManagement.enableMonitoring) {\n\t\t\tthis.memoryMonitor = setInterval(() => {\n\t\t\t\tconst usage = this.checkMemoryUsage();\n\t\t\t\tthis.emit('memoryUpdate', usage);\n\t\t\t}, 10000); // Every 10 seconds\n\t\t}\n\t}\n\n\tpublic shutdown(): void {\n\t\tif (this.memoryMonitor) {\n\t\t\tclearInterval(this.memoryMonitor);\n\t\t}\n\n\t\tthis.cache.clear();\n\t\tthis.emit('shutdown');\n\t}\n}\n\n// Default configuration\nexport const defaultOptimizationConfig: OptimizationConfig = {\n\tcache: {\n\t\tmaxSize: 100 * 1024 * 1024, // 100MB\n\t\tttl: 5 * 60 * 1000, // 5 minutes\n\t\tenableCompression: true,\n\t\tpersistToDisk: false\n\t},\n\tlazyLoading: {\n\t\tenabled: true,\n\t\tpreloadThreshold: 3,\n\t\tmodulePattern: [\n\t\t\t/^vscode\\//,\n\t\t\t/^@vscode\\//,\n\t\t\t/extensions\\//\n\t\t]\n\t},\n\tmemoryManagement: {\n\t\tgcThreshold: 100 * 1024 * 1024, // 100MB\n\t\tmaxHeapSize: 512 * 1024 * 1024, // 512MB\n\t\tenableMonitoring: true\n\t},\n\tresourcePooling: {\n\t\tmaxWorkers: 4,\n\t\tmaxLanguageServers: 10,\n\t\tworkerIdleTimeout: 5 * 60 * 1000 // 5 minutes\n\t}\n};\n","import { PermissionRequest } from '../ai/config';\n\nexport interface PermissionRule {\n\tpattern: string;\n\tdefaultAction: 'allow' | 'deny' | 'prompt';\n\triskLevel: 'low' | 'medium' | 'high';\n\tdescription: string;\n}\n\nexport class PermissionManager {\n\tprivate static readonly PERMISSIONS_KEY = 'extension-permissions';\n\tprivate static readonly AUDIT_KEY = 'permission-audit';\n\n\tprivate permissions: Record<string, boolean> = {};\n\tprivate auditLog: PermissionRequest[] = [];\n\n\tprivate readonly securityRules: PermissionRule[] = [\n\t\t{\n\t\t\tpattern: '*.executeCommand',\n\t\t\tdefaultAction: 'prompt',\n\t\t\triskLevel: 'medium',\n\t\t\tdescription: 'Execute VS Code commands'\n\t\t},\n\t\t{\n\t\t\tpattern: '*.workspace.fs.*',\n\t\t\tdefaultAction: 'prompt',\n\t\t\triskLevel: 'high',\n\t\t\tdescription: 'File system access'\n\t\t},\n\t\t{\n\t\t\tpattern: '*.terminal.*',\n\t\t\tdefaultAction: 'deny',\n\t\t\triskLevel: 'high',\n\t\t\tdescription: 'Terminal access'\n\t\t},\n\t\t{\n\t\t\tpattern: '*.debug.*',\n\t\t\tdefaultAction: 'prompt',\n\t\t\triskLevel: 'medium',\n\t\t\tdescription: 'Debugger access'\n\t\t},\n\t\t{\n\t\t\tpattern: 'kali-*',\n\t\t\tdefaultAction: 'deny',\n\t\t\triskLevel: 'high',\n\t\t\tdescription: 'Security tools access'\n\t\t},\n\t\t{\n\t\t\tpattern: '*.docker.*',\n\t\t\tdefaultAction: 'prompt',\n\t\t\triskLevel: 'medium',\n\t\t\tdescription: 'Docker operations'\n\t\t}\n\t];\n\n\tconstructor() {\n\t\tthis.loadSavedData();\n\t}\n\n\tprivate loadSavedData(): void {\n\t\ttry {\n\t\t\tconst savedPermissions = localStorage.getItem(PermissionManager.PERMISSIONS_KEY);\n\t\t\tif (savedPermissions) {\n\t\t\t\tthis.permissions = JSON.parse(savedPermissions);\n\t\t\t}\n\n\t\t\tconst savedAudit = localStorage.getItem(PermissionManager.AUDIT_KEY);\n\t\t\tif (savedAudit) {\n\t\t\t\tthis.auditLog = JSON.parse(savedAudit);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load permission data:', error);\n\t\t}\n\t}\n\n\tprivate saveData(): void {\n\t\ttry {\n\t\t\tlocalStorage.setItem(\n\t\t\t\tPermissionManager.PERMISSIONS_KEY,\n\t\t\t\tJSON.stringify(this.permissions)\n\t\t\t);\n\t\t\tlocalStorage.setItem(\n\t\t\t\tPermissionManager.AUDIT_KEY,\n\t\t\t\tJSON.stringify(this.auditLog)\n\t\t\t);\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to save permission data:', error);\n\t\t}\n\t}\n\n\tasync requestExtensionPermission(\n\t\textensionId: string,\n\t\tcommand: string,\n\t\tpurpose: string\n\t): Promise<boolean> {\n\t\tconst permissionKey = `${extensionId}:${command}`;\n\n\t\t// Check if permission already granted/denied\n\t\tif (this.permissions.hasOwnProperty(permissionKey)) {\n\t\t\tthis.logAuditEvent(extensionId, command, purpose, this.permissions[permissionKey]);\n\t\t\treturn this.permissions[permissionKey];\n\t\t}\n\n\t\t// Check security rules\n\t\tconst rule = this.findMatchingRule(permissionKey);\n\n\t\tif (rule?.defaultAction === 'allow') {\n\t\t\tthis.permissions[permissionKey] = true;\n\t\t\tthis.saveData();\n\t\t\tthis.logAuditEvent(extensionId, command, purpose, true, 'auto-allowed');\n\t\t\treturn true;\n\t\t}\n\n\t\tif (rule?.defaultAction === 'deny') {\n\t\t\tthis.permissions[permissionKey] = false;\n\t\t\tthis.saveData();\n\t\t\tthis.logAuditEvent(extensionId, command, purpose, false, 'auto-denied');\n\t\t\treturn false;\n\t\t}\n\n\t\t// Prompt user for permission\n\t\treturn this.promptUser(extensionId, command, purpose, rule?.riskLevel || 'medium');\n\t}\n\n\tprivate findMatchingRule(permissionKey: string): PermissionRule | null {\n\t\treturn this.securityRules.find(rule => {\n\t\t\tconst pattern = rule.pattern.replace('*', '.*');\n\t\t\tconst regex = new RegExp(pattern);\n\t\t\treturn regex.test(permissionKey);\n\t\t}) || null;\n\t}\n\n\tprivate async promptUser(\n\t\textensionId: string,\n\t\tcommand: string,\n\t\tpurpose: string,\n\t\triskLevel: 'low' | 'medium' | 'high'\n\t): Promise<boolean> {\n\t\treturn new Promise((resolve) => {\n\t\t\tconst permissionKey = `${extensionId}:${command}`;\n\n\t\t\t// Create permission request event\n\t\t\tconst request: PermissionRequest = {\n\t\t\t\tid: Date.now().toString(),\n\t\t\t\textensionId,\n\t\t\t\tcommand,\n\t\t\t\tpurpose,\n\t\t\t\triskLevel,\n\t\t\t\ttimestamp: Date.now()\n\t\t\t};\n\n\t\t\t// Dispatch custom event for UI to handle\n\t\t\twindow.dispatchEvent(new CustomEvent('permissionRequest', {\n\t\t\t\tdetail: {\n\t\t\t\t\trequest,\n\t\t\t\t\tonResponse: (granted: boolean, remember: boolean = false) => {\n\t\t\t\t\t\trequest.approved = granted;\n\n\t\t\t\t\t\tif (remember) {\n\t\t\t\t\t\t\tthis.permissions[permissionKey] = granted;\n\t\t\t\t\t\t\tthis.saveData();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.logAuditEvent(extensionId, command, purpose, granted, 'user-prompted');\n\t\t\t\t\t\tresolve(granted);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\t}\n\n\tprivate logAuditEvent(\n\t\textensionId: string,\n\t\tcommand: string,\n\t\tpurpose: string,\n\t\tgranted: boolean,\n\t\tsource: string = 'unknown'\n\t): void {\n\t\tconst auditEntry: PermissionRequest = {\n\t\t\tid: Date.now().toString(),\n\t\t\textensionId,\n\t\t\tcommand,\n\t\t\tpurpose,\n\t\t\triskLevel: this.findMatchingRule(`${extensionId}:${command}`)?.riskLevel || 'medium',\n\t\t\ttimestamp: Date.now(),\n\t\t\tapproved: granted\n\t\t};\n\n\t\tthis.auditLog.unshift(auditEntry);\n\n\t\t// Keep only last 1000 audit entries\n\t\tif (this.auditLog.length > 1000) {\n\t\t\tthis.auditLog = this.auditLog.slice(0, 1000);\n\t\t}\n\n\t\tthis.saveData();\n\n\t\tconsole.log(`Permission ${granted ? 'granted' : 'denied'} for ${extensionId}:${command} (${source})`);\n\t}\n\n\thasPermission(extensionId: string, command?: string): boolean {\n\t\tif (!command) {\n\t\t\t// Check if extension has any permissions\n\t\t\treturn Object.keys(this.permissions).some(key =>\n\t\t\t\tkey.startsWith(extensionId) && this.permissions[key]\n\t\t\t);\n\t\t}\n\n\t\tconst permissionKey = `${extensionId}:${command}`;\n\t\treturn this.permissions[permissionKey] === true;\n\t}\n\n\trevokePermission(extensionId: string, command?: string): void {\n\t\tif (!command) {\n\t\t\t// Revoke all permissions for extension\n\t\t\tObject.keys(this.permissions)\n\t\t\t\t.filter(key => key.startsWith(extensionId))\n\t\t\t\t.forEach(key => delete this.permissions[key]);\n\t\t} else {\n\t\t\tconst permissionKey = `${extensionId}:${command}`;\n\t\t\tdelete this.permissions[permissionKey];\n\t\t}\n\n\t\tthis.saveData();\n\t}\n\n\tgetPermissions(): Record<string, boolean> {\n\t\treturn { ...this.permissions };\n\t}\n\n\tgetAuditLog(): PermissionRequest[] {\n\t\treturn [...this.auditLog];\n\t}\n\n\tclearAuditLog(): void {\n\t\tthis.auditLog = [];\n\t\tthis.saveData();\n\t}\n\n\texportAuditLog(): string {\n\t\treturn JSON.stringify({\n\t\t\tpermissions: this.permissions,\n\t\t\tauditLog: this.auditLog,\n\t\t\texportedAt: new Date().toISOString()\n\t\t}, null, 2);\n\t}\n\n\tgetSecurityReport(): {\n\t\ttotalRequests: number;\n\t\tapprovedRequests: number;\n\t\tdeniedRequests: number;\n\t\triskBreakdown: Record<string, number>;\n\t\trecentActivity: PermissionRequest[];\n\t} {\n\t\tconst approved = this.auditLog.filter(entry => entry.approved).length;\n\t\tconst denied = this.auditLog.filter(entry => !entry.approved).length;\n\n\t\tconst riskBreakdown = this.auditLog.reduce((acc, entry) => {\n\t\t\tacc[entry.riskLevel] = (acc[entry.riskLevel] || 0) + 1;\n\t\t\treturn acc;\n\t\t}, {} as Record<string, number>);\n\n\t\tconst recentActivity = this.auditLog\n\t\t\t.filter(entry => Date.now() - entry.timestamp < 24 * 60 * 60 * 1000) // Last 24 hours\n\t\t\t.slice(0, 10);\n\n\t\treturn {\n\t\t\ttotalRequests: this.auditLog.length,\n\t\t\tapprovedRequests: approved,\n\t\t\tdeniedRequests: denied,\n\t\t\triskBreakdown,\n\t\t\trecentActivity\n\t\t};\n\t}\n\n\taddSecurityRule(rule: PermissionRule): void {\n\t\tthis.securityRules.push(rule);\n\t}\n\n\tremoveSecurityRule(pattern: string): void {\n\t\tconst index = this.securityRules.findIndex(rule => rule.pattern === pattern);\n\t\tif (index !== -1) {\n\t\t\tthis.securityRules.splice(index, 1);\n\t\t}\n\t}\n\n\tgetSecurityRules(): PermissionRule[] {\n\t\treturn [...this.securityRules];\n\t}\n}\n","module.exports = require(\"buffer\");","module.exports = require(\"child_process\");","module.exports = require(\"crypto\");","module.exports = require(\"electron\");","module.exports = require(\"events\");","module.exports = require(\"fs/promises\");","module.exports = require(\"http\");","module.exports = require(\"https\");","module.exports = require(\"net\");","module.exports = require(\"path\");","module.exports = require(\"stream\");","module.exports = require(\"tls\");","module.exports = require(\"url\");","module.exports = require(\"vscode\");","module.exports = require(\"zlib\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/main/main.ts\");\n",""],"names":[],"sourceRoot":""}